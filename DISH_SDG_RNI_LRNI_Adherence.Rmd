---
title: "DISH Adherence to LRNIs, ARs, and RNIs"
author: "Ricki Runions"
date: "March 30, 2024"
output:
  word_document:
    toc: yes
  html_document:
    df_print: paged
    toc: yes
    toc_float: yes
---

This notebook checks the adherence to SDGs, RNIs and LRNIs for the ongoing Dietary Intake in Scotland's Children (DISH) survey.

#Prepare R Environment
```{r message=FALSE, warning=FALSE, include=FALSE}

#clear R environment
rm(list = ls())

#load required packages
library(dplyr)
library(tidyr)
library(rio)
library(ggplot2)
library(ggthemes)
library(grafify)
library(lubridate)
library(stringr)
library(XLConnect)
library(flextable)
library(gtsummary)
library(writexl)
library(forcats)
library(gt)


```

#Import the data
```{r include=FALSE}

df.intake24_participant <- read.csv("/Users/ricki/Desktop/DISH_data_cleaning/Output_data_analysis/intake24_participant_28_08_24.csv") %>%
  select(-X)

df.intake24_item <- read.csv("/Users/ricki/Desktop/DISH_data_cleaning/Output_data_analysis/intake24_item_28_08_24.csv") %>%
  select(-X)


df.intake24_recall <- read.csv("/Users/ricki/Desktop/DISH_data_cleaning/Output_data_analysis/intake24_recall_28_08_24.csv") %>%
  select(-X)

df.survey <- read.csv( "/Users/ricki/Desktop/DISH_data_cleaning/Output/survey_clean_for_management_280824.csv") %>%
    select(-X)


```


# Adherence to Scottish Dietary Goals
```{r}
## Energy density to be max 125kcal/100g ####
df.intake24_participant <- df.intake24_participant %>%
  mutate(
    SDG_Energy = case_when(
      Avg_EnergyDensity <= 125 ~ 1, 
      Avg_EnergyDensity > 125 ~ 0,
      TRUE ~ NA)) 

## Total fat (max 35% of food energy) ####
df.intake24_participant <- df.intake24_participant %>%
  mutate(
    SDG_Fat = case_when(
      Avg_Fat_PropFoodEnergy <= 35 ~ 1,
      Avg_Fat_PropFoodEnergy > 35 ~ 0,
    TRUE ~ NA)) 

## Saturated fat (max 10% of food energy) ####
df.intake24_participant <- df.intake24_participant %>%
  mutate(
    SDG_SatFat = case_when(
      Avg_SatFat_PropFoodEnergy <= 10 ~ 1,
      Avg_SatFat_PropFoodEnergy > 10 ~ 0,
    TRUE ~ NA)) 

## Trans fat (<1% of food energy) ####
df.intake24_participant <- df.intake24_participant %>%
  mutate(
    SDG_TransFat = case_when(
      Avg_TransFat_PropFoodEnergy < 1 ~ 1,
      Avg_TransFat_PropFoodEnergy >= 1 ~ 0,
    TRUE ~ NA)) 

## Free sugars (max 5% of total energy) ####
df.intake24_participant <- df.intake24_participant %>%
  mutate(
    SDG_Sugar = case_when(
      Avg_TotalSugars_PropFoodEnergy <= 5 ~ 1,
      Avg_TotalSugars_PropFoodEnergy > 5 ~ 0,
    TRUE ~ NA)) 

## Carbohydrates (~50% of total energy; created upper/lower limits of 45-55%) ####
df.intake24_participant <- df.intake24_participant %>%
  mutate(
    SDG_Carbs = case_when(
      Avg_Carbs_PropFoodEnergy >= 45 & Avg_Carbs_PropFoodEnergy <= 55 ~ 1,
      Avg_Carbs_PropFoodEnergy < 45 | Avg_Carbs_PropFoodEnergy > 55 ~ 0,
    TRUE ~ NA)) 

## Fibre (min 15g/d for 2-4y; min 20g/d for 5-10y; min 25g/d for 11-15y) ####
# Double checked age groupings and SACN guidelines are 'children aged 2 to 5 years should approximate 15g/day, for children aged 5 to 11 years 20g/day' 
# so adjusted age ranges appropriately
df.intake24_participant <- df.intake24_participant %>%
  mutate(
    SDG_Fibre = case_when(
      CalcAge >= 2 & CalcAge < 5 & Avg_AOACFibre >= 15 ~ 1,
      CalcAge >= 2 & CalcAge < 5 & Avg_AOACFibre < 15 ~ 0,
      CalcAge >= 5 & CalcAge < 11 & Avg_AOACFibre >= 20 ~ 1,
      CalcAge >= 5 & CalcAge < 11 & Avg_AOACFibre < 20 ~ 0,
      CalcAge >= 11 & CalcAge < 16 & Avg_AOACFibre >= 25 ~ 1,
      CalcAge >= 11 & CalcAge < 16 & Avg_AOACFibre < 25 ~ 0,
      CalcAge >= 16 & Avg_AOACFibre >= 30 ~ 1,
      CalcAge >= 16 & Avg_AOACFibre < 30 ~ 0,
    TRUE ~ NA)) 

## Salt (2g/d for 1-3y; 3g/d for 4-6y; 5g/d for 7-10y; 6g/d for 11+y) ####
df.intake24_participant <- df.intake24_participant %>%
  mutate(
    SDG_Salt = case_when(
      CalcAge >= 1 & CalcAge < 4 & Avg_Salt >= 2 ~ 1,
      CalcAge >= 1 & CalcAge < 4 & Avg_Salt < 2 ~ 0,
      CalcAge >= 4 & CalcAge < 7 & Avg_Salt >= 3 ~ 1,
      CalcAge >= 4 & CalcAge < 7 & Avg_Salt < 3 ~ 0,
      CalcAge >= 7 & CalcAge < 11 & Avg_Salt >= 5 ~ 1,
      CalcAge >= 7 & CalcAge < 11 & Avg_Salt < 5 ~ 0,
      CalcAge >= 11 & Avg_Salt >= 6 ~ 1,
      CalcAge >= 11 & Avg_Salt < 6 ~ 0,
    TRUE ~ NA)) 
```

##Fruit and Vegetables - at least 5 portions per day
```{r}
## Fruits and vegetables (at least 5 portions/day)
  df.SDG_Fruitveg <- df.intake24_item %>%
    select(UserID, CalcAge, RecallNo,Fruitg,FruitJuiceg,DriedFruitg,SmoothieFruitg,Tomatoesg,TomatoPureeg,Brassicaceaeg,YellowRedGreeng,Beansg,OtherVegg) #include age variable for FV calculations
  
  # Calculate daily intakes of beans, fruit juice, dried fruit, and remaining fruit and veg 
  df.SDG_Fruitveg <- df.SDG_Fruitveg %>%
    group_by(UserID, RecallNo) %>%
    summarise(
      CalcAge = first(CalcAge),
      FV_Beans = sum(Beansg),
      FV_FruitJuice = sum(FruitJuiceg),
      FV_Smoothie = sum(SmoothieFruitg),
      FV_Dried = sum(DriedFruitg),
      FV_FreshFruit = sum(Fruitg),
      FV_Veg = sum(Tomatoesg, TomatoPureeg, Brassicaceaeg, YellowRedGreeng, OtherVegg)) %>%
    ungroup()
  
  df.SDG_Fruitveg <- df.SDG_Fruitveg %>%
    mutate(FV_FruitSmoothie = FV_FruitJuice+FV_Smoothie)
  
  # Calculate daily portions of fruit and veg
    #Cap beans at 40g and 80g and fruit juice (including smoothies) at 150g 
    #1 portion dried fruit = 15g for 2-10 yrs and 30g for 11-16yrs
    #1 portion of fresh fruit/veg = 40g for 2-10 yrs and 80g for 11-16yrs
   
    df.SDG_Fruitveg <- df.SDG_Fruitveg %>% # updated with age ranges from school lunch guidance
      mutate(
          Day_Portions_Beans = case_when(
            CalcAge >= 2 & CalcAge < 11 & FV_Beans > 40 ~ 1,
            CalcAge >= 2 & CalcAge < 11 & FV_Beans <= 40 ~ FV_Beans/40,
            CalcAge >= 11 & CalcAge <= 16 & FV_Beans > 80 ~ 1,
            CalcAge >= 11 & CalcAge <= 16 & FV_Beans <= 80 ~ FV_Beans/80,
            TRUE ~ NA),
          
          Day_Portions_FruitSmoothie = case_when(
            FV_FruitSmoothie >150 ~ 1,
            FV_FruitSmoothie <= 150 ~ FV_FruitSmoothie/150,
            TRUE ~ NA),
          
          Day_Portions_Dried = case_when(
            CalcAge >= 2 & CalcAge < 11 ~ FV_Dried/15,
            CalcAge >= 11 & CalcAge <= 16 ~ FV_Dried/30,
            TRUE ~ NA),
          
          Day_Portions_FreshFruit = case_when(
            CalcAge >= 2 & CalcAge < 11 ~ FV_FreshFruit/40,
            CalcAge >= 11 & CalcAge <= 16 ~ FV_FreshFruit/80,
            TRUE ~ NA),
          
          Day_Portions_Veg = case_when(
            CalcAge >= 2 & CalcAge < 11 ~ FV_Veg/40,
            CalcAge >= 11 & CalcAge <= 16 ~ FV_Veg/80,
            TRUE ~ NA),
          
          Day_Portions_Total = Day_Portions_Beans+Day_Portions_FruitSmoothie+Day_Portions_Dried+Day_Portions_FreshFruit+Day_Portions_Veg,
          Day_Portions_Total_NoFruitSmoothie = Day_Portions_Beans+Day_Portions_Dried+Day_Portions_FreshFruit+Day_Portions_Veg) 
   
  # Merge with recall data frame
    df.SDG_Fruitveg <- df.SDG_Fruitveg %>%
      select(UserID, RecallNo,starts_with("Day"))
    
    df.intake24_recall <- left_join(df.intake24_recall, df.SDG_Fruitveg, by = c("UserID"="UserID", "RecallNo" ="RecallNo"))
  
```

##Average portions of fruit and vegetables
```{r}
# Create avg portion variables and merge to participant dataset

df.intake24_recall <- df.intake24_recall %>%
  group_by(UserID)%>%
  mutate(
    Avg_Portions_Beans = mean(Day_Portions_Beans),
    Avg_Portions_FruitSmoothie = mean(Day_Portions_FruitSmoothie),
    Avg_Portions_Dried = mean(Day_Portions_Dried),
    Avg_Portions_FreshFruit = mean(Day_Portions_FreshFruit),
    Avg_Portions_Veg = mean(Day_Portions_Veg),
    Avg_Portions_Total = mean(Day_Portions_Total),
    Avg_Portions_Total_NoFruitSmoothie = mean(Day_Portions_Total_NoFruitSmoothie)) %>%
  ungroup()

# select variables to merge
df.Avg_portions <- df.intake24_recall %>%
  select(UserID, Avg_Portions_Beans,Avg_Portions_FruitSmoothie, Avg_Portions_Dried, Avg_Portions_FreshFruit, Avg_Portions_Veg, Avg_Portions_Total,Avg_Portions_Total_NoFruitSmoothie) %>%
  distinct(UserID, .keep_all = TRUE) #keep only one row per UserID, retaining all other columns


# merge to participant level 
df.intake24_participant <- left_join(df.intake24_participant, df.Avg_portions, by = "UserID")

```

##Create binary variable for meeting fruit/veg SDG
```{r}
# Create variable for meeting fruit and veg SDG 
    df.intake24_participant <- df.intake24_participant %>%
    mutate(
      SDG_FV = case_when(
        Avg_Portions_Total >= 5 ~ 1,
        Avg_Portions_Total < 5 ~ 0,
      TRUE ~ NA),
      
      SDG_FV_NoFruitSmoothie = case_when(
        Avg_Portions_Total_NoFruitSmoothie >= 5 ~ 1,
        Avg_Portions_Total_NoFruitSmoothie < 5 ~ 0,
        TRUE ~ NA))
```

##Oily Fish 
This SDG is assessed using the food frequency questions from the initial survey as it is a weekly sdg target
```{r}
## Oily fish
df.survey <- df.survey %>%
  mutate(SDG_oilyfish = case_when(
    AFreqOilyFish %in% c("Never", "Not sure", "Less than once a week") ~ 0,
    TRUE ~ 1
  ))

# Merge with participant level dataset
    df.SDG_Fish <- df.survey %>%
      select(UserID, SDG_oilyfish)
    
df.intake24_participant <- left_join(df.intake24_participant, df.SDG_Fish, by = "UserID")
```

##Red and red processed meat 
This SDG will be assessed by the disaggregated intake24 data
```{r}
## Red and red processed meat 
df.intake24_participant <- df.intake24_participant %>%
  mutate(
    SDG_RRPM = case_when(
      Avg_redprocessedmeat <= 70 ~ 1, 
      Avg_redprocessedmeat > 70 ~ 0,
      TRUE ~ NA)) 

    

```

```{r}
df.intake24_participant <- df.intake24_participant %>%
  rename(age = Age)
```


#***Adherence to RNIs***
```{r include=FALSE}
df.intake24_participant <- df.intake24_participant %>%
    mutate(ProteinRNI = case_when(age >= 1 & age <= 3 & Avg_Protein >= 14.5 ~ 1,
                                      age >= 4 & age <= 6 & Avg_Protein >= 19.7 ~ 1,
                                      age >= 7 & age <= 10 & Avg_Protein >= 28.3 ~ 1,
                                      age >= 11 & age <= 14 & Avg_Protein >= 41.2 ~ 1,
                                      age >= 15 & age <= 18 & Avg_Protein >= 45.4 ~ 1,
                                  
                                      age >= 1 & age <= 3 & Avg_Protein < 14.5 ~ 0,
                                      age >= 4 & age <= 6 & Avg_Protein < 19.7 ~ 0,
                                      age >= 7 & age <= 10 & Avg_Protein < 28.3 ~ 0,
                                      age >= 11 & age <= 14 & Avg_Protein < 41.2 ~ 0,
                                      age >= 15 & age <= 18 & Avg_Protein < 45.4 ~ 0,
           TRUE ~ NA))
    
df.intake24_participant <- df.intake24_participant %>%
    mutate(CalciumRNI = case_when(Sex == "Male" & age >= 2 & age <= 3 & Avg_Calcium >= 350 ~ 1,
                                      Sex == "Male" & age >= 4 & age <= 6 & Avg_Calcium >= 450 ~ 1,
                                      Sex == "Male" & age >= 7 & age <= 10 & Avg_Calcium >= 550 ~ 1,
                                      Sex == "Male" & age >= 11 & age <= 18 & Avg_Calcium >= 1000 ~ 1,
                                  
                                      Sex == "Male" & age >= 2 & age <= 3 & Avg_Calcium < 350 ~ 0,
                                      Sex == "Male" & age >= 4 & age <= 6 & Avg_Calcium < 450 ~ 0,
                                      Sex == "Male" & age >= 7 & age <= 10 & Avg_Calcium < 550 ~ 0,
                                      Sex == "Male" & age >= 11 & age <= 18 & Avg_Calcium < 1000 ~ 0,
                                      
                                      Sex == "Female" & age >= 2 & age <= 3 & Avg_Calcium >= 350 ~ 1,
                                      Sex == "Female" & age >= 4 & age <= 6 & Avg_Calcium >= 450 ~ 1,
                                      Sex == "Female" & age >= 7 & age <= 10 & Avg_Calcium >= 550 ~ 1,
                                      Sex == "Female" & age >= 11 & age <= 18 & Avg_Calcium >= 800 ~ 1,
                                  
                                      Sex == "Female" & age >= 2 & age <= 3 & Avg_Calcium < 350 ~ 0,
                                      Sex == "Female" & age >= 4 & age <= 6 & Avg_Calcium < 450 ~ 0,
                                      Sex == "Female" & age >= 7 & age <= 10 & Avg_Calcium < 550 ~ 0,
                                      Sex == "Female" & age >= 11 & age <= 18 & Avg_Calcium < 800 ~ 0,
           TRUE ~ NA))
    
df.intake24_participant <- df.intake24_participant %>%
    mutate(IronRNI = case_when(    age >= 2 & age <= 3 & Avg_Iron >= 6.9 ~ 1,
                                   age >= 2 & age <= 3 & Avg_Iron < 6.9 ~ 0,
                                   age >= 4 & age <= 6 & Avg_Iron >= 6.1 ~ 1,
                                   age >= 4 & age <= 6 & Avg_Iron < 6.1 ~ 0,
                                   age >= 7 & age <= 10 & Avg_Iron >= 8.7 ~ 1,
                                   age >= 7 & age <= 10 & Avg_Iron < 8.7 ~ 0,
                                   
                                   Sex == "Male" & age >= 11 & Avg_Iron >= 11.3 ~ 1,
                                   Sex == "Male" & age >= 11 & Avg_Iron < 11.3 ~ 0,
                                   
                                   Sex == "Female" & age >= 11 & Avg_Iron >= 14.8 ~ 1,
                                   Sex == "Female" & age >= 11 & Avg_Iron < 14.8 ~ 0,
           TRUE ~ NA_integer_))
    
  
  df.intake24_participant <- df.intake24_participant %>%
    mutate(SeleniumRNI = case_when(age >= 2 & age <= 3 & Avg_Selenium >= 15 ~ 1,
                                   age >= 2 & age <= 3 & Avg_Selenium < 15 ~ 0,
                                   age >= 4 & age <= 6 & Avg_Selenium >=20 ~ 1,
                                   age >= 4 & age <= 6 & Avg_Selenium < 20 ~ 0,
                                   age >= 7 & age <= 10 & Avg_Selenium >= 30 ~ 1,
                                   age >= 7 & age <= 10 & Avg_Selenium < 30 ~ 0,
                                   age >= 11 & age <= 14 & Avg_Selenium >= 45 ~ 1,
                                   age >= 11 & age <= 14 & Avg_Selenium < 45 ~ 0,
                                   Sex == "Male" & age >= 15 & age <= 18 & Avg_Selenium >= 70 ~ 1,
                                   Sex == "Male" & age >= 15 & age <= 18 & Avg_Selenium < 70 ~ 0,
                                   Sex == "Female" & age >= 15 & age <= 18 & Avg_Selenium >= 60 ~ 1,
                                   Sex == "Female" & age >= 15 & age <= 18 & Avg_Selenium < 60 ~ 0,
           TRUE ~ NA_integer_))
    
  df.intake24_participant <- df.intake24_participant %>%
    mutate(ZincRNI = case_when(    age >= 2 & age <= 3 & Avg_Zinc >= 5 ~ 1,
                                   age >= 2 & age <= 3 & Avg_Zinc < 5 ~ 0,
                                   age >= 4 & age <= 6 & Avg_Zinc >= 6.5 ~ 1,
                                   age >= 4 & age <= 6 & Avg_Zinc < 6.5 ~ 0,
                                   age >= 7 & age <= 10 & Avg_Zinc >= 7 ~ 1,
                                   age >= 7 & age <= 10 & Avg_Zinc < 7 ~ 0,
                                   age >= 11 & age <= 14 & Avg_Zinc >= 9 ~ 1,
                                   age >= 11 & age <= 14 & Avg_Zinc < 9 ~ 0,
                                   Sex == "Male" & age >= 15 & age <= 18 & Avg_Zinc >= 9.5 ~ 1,
                                   Sex == "Male" & age >= 15 & age <= 18 & Avg_Zinc < 9.5 ~ 0,
                                   Sex == "Female" & age >= 15 & age <= 18 & Avg_Zinc >= 7 ~ 1,
                                   Sex == "Female" & age >= 15 & age <= 18 & Avg_Zinc < 7 ~ 0,
           TRUE ~ NA_integer_))
  
  df.intake24_participant <- df.intake24_participant %>%  
    mutate(VitaminB12RNI = case_when(age >= 1 & age <= 3 & Avg_VitaminB12 >= .5 ~ 1,
                                   age >= 1 & age <= 3 & Avg_VitaminB12 < .5 ~ 0,
                                   age >= 4 & age <= 6 & Avg_VitaminB12 >= .8 ~ 1,
                                   age >= 4 & age <= 6 & Avg_VitaminB12 < .8 ~ 0,
                                   age >= 7 & age <= 10 & Avg_VitaminB12 >= 1.0 ~ 1,
                                   age >= 7 & age <= 10 & Avg_VitaminB12 < 1.0 ~ 0,
                                   age >= 11 & age <= 14 & Avg_VitaminB12 >= 1.2 ~ 1,
                                   age >= 11 & age <= 14 & Avg_VitaminB12 < 1.2 ~ 0,
                                   age >= 15 & age <= 18 & Avg_VitaminB12 >= 1.5 ~ 1,
                                   age >= 15 & age <= 18 & Avg_VitaminB12 < 1.5 ~ 0,
           TRUE ~ NA_integer_))
```

#***Adherence to LRNIs***
```{r include=FALSE}

    #LRNIs  
df.intake24_participant <- df.intake24_participant %>%  
    mutate(CalciumLRNI = case_when(age >= 1 & age < 4 & Avg_Calcium >= 200 ~ 1,
                                   age >= 1 & age < 4 & Avg_Calcium < 200 ~ 0,
                                   age >= 4 & age < 7 & Avg_Calcium >= 275 ~ 1,
                                   age >= 4 & age < 7 & Avg_Calcium < 275 ~ 0,
                                   age >= 7 & age < 11 & Avg_Calcium >= 325 ~ 1,
                                   age >= 7 & age < 11 & Avg_Calcium < 325 ~ 0,
                                   Sex == "Male" & age >= 11 & age < 16 & Avg_Calcium >= 450 ~ 1,
                                   Sex == "Male" & age >= 11 & age < 16 & Avg_Calcium < 450 ~ 0,
                                   Sex == "Female" & age >= 11 & age < 16 & Avg_Calcium >= 480 ~ 1,
                                   Sex == "Female" & age >= 11 & age < 16 & Avg_Calcium < 480 ~ 0,
                                   TRUE ~ NA)) 
    
df.intake24_participant <- df.intake24_participant %>% 
    mutate(IronLRNI = case_when(age >= 1 & age < 4 & Avg_Iron >= 3.7 ~ 1,
                                   age >= 1 & age < 4 & Avg_Iron < 3.7 ~ 0,
                                   age >= 4 & age < 7 & Avg_Iron >= 3.3 ~ 1,
                                   age >= 4 & age < 7 & Avg_Iron < 3.3 ~ 0,
                                   age >= 7 & age < 11 & Avg_Iron >= 4.7 ~ 1,
                                   age >= 7 & age < 11 & Avg_Iron < 4.7 ~ 0,
                                   Sex == "Male" & age >= 11 & age < 19 & Avg_Iron >= 6.1 ~ 1,
                                   Sex == "Male" & age >= 11 & age < 19 & Avg_Iron < 6.1 ~ 0,
                                   Sex == "Female" & age >= 11 & age < 19 & Avg_Iron >= 8 ~ 1,
                                   Sex == "Female" & age >= 11 & age < 19 & Avg_Iron < 8 ~ 0,
                                   TRUE ~ NA)) 
    
df.intake24_participant <- df.intake24_participant %>% 
    mutate(SeleniumLRNI = case_when(age >= 1 & age < 4 & Avg_Selenium >= 7 ~ 1,
                                   age >= 1 & age < 4 & Avg_Selenium < 7 ~ 0,
                                   age >= 4 & age < 7 & Avg_Selenium >= 10 ~ 1,
                                   age >= 4 & age < 7 & Avg_Selenium < 10 ~ 0,
                                   age >= 7 & age < 11 & Avg_Selenium >= 16 ~ 1,
                                   age >= 7 & age < 11 & Avg_Selenium < 16 ~ 0,
                                   age >= 11 & age < 15 & Avg_Selenium >= 25 ~ 1,
                                   age >= 11 & age < 15 & Avg_Selenium < 25 ~ 0,
                                   age >= 15 & age < 19 & Avg_Selenium >= 40 ~ 1,
                                   age >= 15 & age < 19 & Avg_Selenium < 40 ~ 0,
                                   TRUE ~ NA))
    
df.intake24_participant <- df.intake24_participant %>% 
    mutate(ZincLRNI = case_when(age >= 1 & age < 4 & Avg_Zinc >= 3 ~ 1, 
                                   age >= 1 & age < 4 & Avg_Zinc < 3 ~ 0,
                                   age >= 4 & age < 7 & Avg_Zinc >= 4 ~ 1,
                                   age >= 4 & age < 7 & Avg_Zinc < 4 ~ 0,
                                   age >= 7 & age < 11 & Avg_Zinc >= 4 ~ 1,
                                   age >= 7 & age < 11 & Avg_Zinc < 4 ~ 0,
                                   age >= 11 & age < 15 & Avg_Zinc >= 5.3 ~ 1,
                                   age >= 11 & age < 15 & Avg_Zinc < 5.3 ~ 0,
                                   Sex == "Male" & age >= 15 & Avg_Zinc >= 5.5 ~ 1,
                                   Sex == "Male" & age >= 15 & Avg_Zinc < 5.5 ~ 0,
                                   Sex == "Female" & age >= 15 & Avg_Zinc >= 4 ~ 1,
                                   Sex == "Female" & age >= 15 & Avg_Zinc < 4 ~ 0,
                                   TRUE ~ NA))

df.intake24_participant <- df.intake24_participant %>%     
    mutate(VitaminB12LRNI = case_when(age >= 1 & age < 4 & Avg_VitaminB12 >= 0.3 ~ 1, 
                                   age >= 1 & age < 4 & Avg_VitaminB12 < 0.3 ~ 0,
                                   age >= 4 & age < 7 & Avg_VitaminB12 >= 0.5 ~ 1,
                                   age >= 4 & age < 7 & Avg_VitaminB12 < 0.5 ~ 0,
                                   age >= 7 & age < 11 & Avg_VitaminB12 >= 0.6 ~ 1,
                                   age >= 7 & age < 11 & Avg_VitaminB12 < 0.6 ~ 0,
                                   age >= 11 & age < 15 & Avg_VitaminB12 >= 0.8 ~ 1,
                                   age >= 11 & age < 15 & Avg_VitaminB12 < 0.8 ~ 0,
                                   age >= 15 & Avg_VitaminB12 >= 1 ~ 1,
                                   age >= 15 & Avg_VitaminB12 < 1 ~ 0,
                                   TRUE ~ NA))
```

#Write Files
```{r eval=FALSE, include=FALSE}
write.csv(df.intake24_participant, file = "/Users/ricki/Desktop/DISH_data_cleaning/Output_data_analysis/intake24_participant_foodgroups_SDG_RNI_LRNI_28_08_24.csv")
```

