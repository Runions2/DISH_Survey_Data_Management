---
title: "DISH Results Tables"
output:
  word_document: default
  html_notebook: default
---

This notebook outputs weighted estimates into tables.

# Prepare R Environment 
```{r warning=FALSE, include=FALSE}

  # Clear R environment
  rm(list = ls())
  
  # Load required packages
  library(dplyr)
  library(tidyr)
  library(rio)
  library(ggplot2)
  library(ggthemes)
  library(grafify)
  library(lubridate)
  library(stringr)
  library(readxl)
  #library(XLConnect)
  library(flextable)
  library(gtsummary)
  library(writexl)
  library(forcats)
  library(purrr)
  library(survey)
```

# Import the data
```{r include=FALSE}
  df.intake24_item <- read.csv( "/Users/ricki/Desktop/DISH_data_cleaning/Output_data_analysis/intake24_item_110924.csv") 
  df.intake24_participant <- read.csv("/Users/ricki/Desktop/DISH_data_cleaning/Output_data_analysis/intake24_participant_110924.csv") 
  df.intake24_recall <- read.csv("/Users/ricki/Desktop/DISH_data_cleaning/Output_data_analysis/intake24_recall_110924.csv")
  df.survey <- read.csv( "/Users/ricki/Desktop/DISH_data_cleaning/Output_data_analysis/survey_110924.csv") 
  df.weights_full <- read.csv("/Users/ricki/Desktop/DISH_data_cleaning/Data/sample_survey_weights_050924.csv") 
 
  df.intake24_recall_ndns_fg <- read.csv(file = "/Users/ricki/Desktop/DISH_data_cleaning/Output_data_analysis/intake24_ndns_food_groups_110924.csv")

  df.intake24_participant_ndns_fg_wide <- read.csv(file = "/Users/ricki/Desktop/DISH_data_cleaning/Output_data_analysis/intake24_ndns_food_groups_WIDE_110924.csv")

df.intake24_recall_discretionary_fg <- read.csv( file = "/Users/ricki/Desktop/DISH_data_cleaning/Output_data_analysis/intake24_discretionary_food_groups_110924.csv")

df.intake24_participant_discretionary_fg_wide <- read.csv( file = "/Users/ricki/Desktop/DISH_data_cleaning/Output_data_analysis/intake24_discretionary_food_groups_WIDE_110924.csv") 

df.char <- read.csv( "/Users/ricki/Desktop/DISH_data_cleaning/Output/participant_characteristics_110924.csv") 

  #df.intake24_item <- read.csv( "/Users/ricki/Desktop/DISH_data_cleaning/Output_data_analysis/intake24_item_28_08_24.csv") 
  #df.intake24_participant <- read.csv("/Users/ricki/Desktop/DISH_data_cleaning/Output_data_analysis/intake24_participant_28_08_24.csv") 
  #df.intake24_recall <- read.csv("/Users/ricki/Desktop/DISH_data_cleaning/Output_data_analysis/intake24_recall_28_08_24.csv")
  #df.survey <- read.csv( "/Users/ricki/Desktop/DISH_data_cleaning/Output/survey_clean_for_management_280824.csv") 
  #df.weights_full <- read.csv("/Users/ricki/Desktop/DISH_data_cleaning/Data/sample_survey_weights_140824.csv") 
  
  
  
  
 # df.intake24_item <- read.csv( "C:/Users/ljaacks/OneDrive - University of Edinburgh/Scottish Diets/_National Monitoring of Diet Scotland/3_DISH/Analysis/Data/intake24_item_280824.csv")
  #df.intake24_participant <- read.csv("C:/Users/ljaacks/OneDrive - University of Edinburgh/Scottish Diets/_National Monitoring of Diet Scotland/3_DISH/Analysis/Data/intake24_participant_280824.csv") 
  #df.intake24_recall <- read.csv("C:/Users/ljaacks/OneDrive - University of Edinburgh/Scottish Diets/_National Monitoring of Diet Scotland/3_DISH/Analysis/Data/intake24_recall_280824.csv") 
  #df.survey <- read.csv( "C:/Users/ljaacks/OneDrive - University of Edinburgh/Scottish Diets/_National Monitoring of Diet Scotland/3_DISH/Analysis/Data/survey_clean_280824.csv") 
  #df.weights_full <- read.csv("C:/Users/ljaacks/OneDrive - University of Edinburgh/Scottish Diets/_National Monitoring of Diet Scotland/3_DISH/Analysis/Data/survey_weights_140824.csv") 
```

# Sample weights
```{r include=FALSE}
df.weights <- df.weights_full %>%
  filter(!is.na(sampweight)) %>%
  mutate(sampleweight = sampweight) %>%
  select(UserID, sampleweight)

df.survey <- left_join(df.survey, df.weights, by = "UserID")
df.survey <- df.survey %>%
  relocate(sampleweight, .after=UserID)

df.intake24_participant <- left_join(df.intake24_participant, df.weights, by = "UserID")
df.intake24_participant <- df.intake24_participant %>%
  relocate(sampleweight, .after=UserID)

df.intake24_participant_ndns_fg_wide <- left_join(df.intake24_participant_ndns_fg_wide, df.weights, by = "UserID") %>%
  relocate(sampleweight, .after=UserID)


df.intake24_participant_ndns_fg_wide <- left_join(df.intake24_participant_ndns_fg_wide, df.char, by = "UserID") %>%
  relocate(c("HouseholdID", "Age", "age_cat", "Sex", "age_sex_cat", "age_cat_drv", "Ethnicity", "simd_quintile", "Education", "adults_cat", "children_cat", "FoodParcels"), .after=UserID)

df.intake24_participant_discretionary_fg_wide <- left_join(df.intake24_participant_discretionary_fg_wide, df.weights, by = "UserID") %>%
  relocate(sampleweight, .after=UserID)

df.intake24_participant_disc_fg_wide <- left_join(df.intake24_participant_discretionary_fg_wide, df.char, by = "UserID") %>%
  relocate(c("HouseholdID", "Age", "age_cat", "Sex", "age_sex_cat", "age_cat_drv", "Ethnicity", "simd_quintile", "Education", "adults_cat", "children_cat", "FoodParcels"), .after=UserID)

#rm(df.weights, df.weights_full)


# **TO UPDATE** replace NA weights with 1
df.survey <- df.survey %>%
  mutate(sampleweight = case_when(
            is.na(sampleweight) ~ 1,
          TRUE ~ sampleweight))

df.intake24_participant <- df.intake24_participant %>%
  mutate(sampleweight = case_when(
            is.na(sampleweight) ~ 1,
            TRUE ~ sampleweight))

df.intake24_participant_ndns_fg_wide <- df.intake24_participant_ndns_fg_wide %>%
  mutate(sampleweight = case_when(
            is.na(sampleweight) ~ 1,
            TRUE ~ sampleweight))

# replace 'Prefer not to say" sex to NA
df.intake24_participant <- df.intake24_participant %>%
  mutate(Sex = case_when(Sex == "Prefer not to say" ~ NA,
                         TRUE ~ Sex))

#set factor levels
df.intake24_participant$age_cat <- factor(df.intake24_participant$age_cat, levels = c("2-4y", "5-10y", "11-15y"))

df.intake24_participant$age_sex_cat <- factor(df.intake24_participant$age_sex_cat, levels = c("Female, 2-4y", "Female, 5-10y", "Female, 11-15y", "Male, 2-4y", "Male, 5-10y", "Male, 11-15y"))


#set factor levels
df.intake24_participant_ndns_fg_wide$age_sex_cat <- factor(df.intake24_participant_ndns_fg_wide$age_sex_cat, levels = c("Female, 2-4y", "Female, 5-10y", "Female, 11-15y", "Male, 2-4y", "Male, 5-10y", "Male, 11-15y"))

df.intake24_participant_disc_fg_wide$age_sex_cat <- factor(df.intake24_participant_disc_fg_wide$age_sex_cat, levels = c("Female, 2-4y", "Female, 5-10y", "Female, 11-15y", "Male, 2-4y", "Male, 5-10y", "Male, 11-15y"))


#set as numeric - doesn't work to fix the issue of categorical outputs in table
df.intake24_participant_disc_fg_wide <- df.intake24_participant_disc_fg_wide %>%
  mutate(across(Avg_Prop_Energykcal_discr_1:Avg_Prop_SatFatg_discr_11, as.numeric))


```


```{r include=FALSE}

# set survey weights and psu
svy.df.survey <- svydesign(id = ~psu, weights = ~sampleweight, data = df.survey)
svy.df.intake24_participant <- svydesign(id = ~psu, weights = ~sampleweight, data = df.intake24_participant)
svy.df.intake24_part_ndns_fg <- svydesign(id = ~psu, weights = ~sampleweight, data =df.intake24_participant_ndns_fg_wide)
svy.df.intake24_part_disc_fg <- svydesign(id = ~psu, weights = ~sampleweight, data =df.intake24_participant_disc_fg_wide)


```

# Sample characteristics
```{r echo=FALSE, message=FALSE, warning=FALSE}
#svyciprop(~I(Sex=="Female"), svy, method="mean")
#svyciprop(~I(Sex=="Male"), svy, method="mean")

table.demo <- tbl_svysummary(
  svy.df.survey,
  by = Sex,
  label = c(simd_quintile ~ "SIMD",
            age_cat ~ "Age group",
            Education ~ "Stage of education",
            adults_cat ~ "Number of adults in household",
            children_cat ~ "Number of children in household",
            FoodParcels ~ "Receipt of food parcels or vouchers in school holidays"),
  statistic = list(all_continuous() ~ "{median} ({p25}, {p75})", all_categorical() ~ "{p}% ({n_unweighted})"),
  missing = "ifany",
  include = c(Age, age_cat, Ethnicity, simd_quintile, Education, adults_cat, children_cat, FoodParcels)) %>%
  bold_labels() %>% 
  add_overall()%>%
  as_flex_table()

#save_as_docx(table.demo, path = paste0("C:/Users/ljaacks/OneDrive - University of Edinburgh/Scottish Diets/_National Monitoring of Diet Scotland/3_DISH/Analysis/Output/","Table_Demographics_",format(Sys.time(),"%d%m%Y"),".docx"))

table.demo

```

# Scottish Dietary Goals (mean)
## Overall
```{r echo=FALSE}
df.intake24_participant %>% 
  select(Avg_EnergyDensity, Avg_FV_Portions_Total, Avg_RRPMg, Avg_Fat_PropFoodEnergy, Avg_SatFat_PropFoodEnergy, Avg_TransFat_PropFoodEnergy, Avg_FreeSugars_PropFoodEnergy, Avg_Carbs_PropFoodEnergy, Avg_AOACFibreg) %>% # select variables for table
  tbl_summary(missing = "no", # set to 'always' or 'ifany' to show unknowns in table
              digits = list(all_categorical() ~ c(1,0)), # set categorical variables to one decimal place
              type = list(all_continuous() ~ "continuous2"), 
              statistic = list(all_continuous() ~ c("{mean} ({sd})", "{median} ({p25}, {p75})")),
              label = c(        # rename variables for table               
                Avg_EnergyDensity ~ "Energy density",
                Avg_FV_Portions_Total ~ "Fruit and vegetables - portions/day",
                Avg_RRPMg ~ "Red and red processed meat - g/day",
                Avg_Fat_PropFoodEnergy ~ "Total fat - % food energy",
                Avg_SatFat_PropFoodEnergy ~ "Saturated fat - % food energy",
                Avg_TransFat_PropFoodEnergy ~ "Trans fat - % food energy",
                Avg_FreeSugars_PropFoodEnergy ~ "Free sugars - % food energy",
                Avg_Carbs_PropFoodEnergy ~ "Total carbs - % food energy",
                Avg_AOACFibreg ~ "Fibre - g/day"
                )
  ) %>%
  add_ci() %>% #add confidence interval
  modify_header(label ~ "**Mean Daily Intakes**") %>% #change header 
  bold_labels() %>%
  as_flex_table()
```

Reformat overall results 
```{r echo=FALSE}
# set up stats
stats <- c("N" = "{length}", 
           "Mean (SD)" = "{mean} ({sd})", 
           "Median (IQR)" = "{median} ({p25}, {p75})")


df.intakes <- df.intake24_participant %>% 
  select(Avg_EnergyDensity, Avg_FV_Portions_Total, Avg_FV_Portions_Total_NoJuiceSmoothie, Avg_RRPMg, Avg_Fat_PropFoodEnergy, Avg_SatFat_PropFoodEnergy, Avg_TransFat_PropFoodEnergy, Avg_FreeSugars_PropFoodEnergy, Avg_Carbs_PropFoodEnergy, Avg_AOACFibreg) # select variables for table

#useimap from purr package to combine summary tables and reformat with stats in header row
intakes_reformat <- imap( 
    stats,
    ~ df.intakes %>%
  tbl_summary(missing = "no", # set to 'always' or 'ifany' to show unknowns in table
              statistic = ~.x,
              label = c(        # rename variables for table               
                Avg_EnergyDensity ~ "Energy density",
                Avg_FV_Portions_Total ~ "Fruit and vegetables - portions/day",
                Avg_FV_Portions_Total_NoJuiceSmoothie ~ "Fruit and vegetables - portions/day (no fruit smoothie)",
                Avg_RRPMg ~ "Red and red processed meat - g/day",
                Avg_Fat_PropFoodEnergy ~ "Total fat - % food energy",
                Avg_SatFat_PropFoodEnergy ~ "Saturated fat - % food energy",
                Avg_TransFat_PropFoodEnergy ~ "Trans fat - % food energy",
                Avg_FreeSugars_PropFoodEnergy ~ "Free sugars - % food energy",
                Avg_Carbs_PropFoodEnergy ~ "Total carbs - % food energy",
                Avg_AOACFibreg ~ "Fibre - g/day"
                )) %>%

    modify_header(all_stat_cols() ~ stringr::str_glue("**{.y}**"))
  ) %>%
  # Merge the individual summary tables into one table
  tbl_merge(tab_spanner = FALSE) %>%
  modify_header(label ~ "**Mean Daily Intakes**") %>% #change header 
  bold_labels() %>%
  as_flex_table()
  
intakes_reformat

```

Create full-demo subset
```{r include=FALSE}
# create a subset that removes any participant without full demographic information (age/sex variables)
df.intake24_full_demo <- df.intake24_participant %>% 
  filter(Sex != "Prefer not to say")

n_distinct(df.intake24_full_demo$UserID)

# set factor level
df.intake24_full_demo$Sex <- factor(df.intake24_full_demo$Sex, levels = c("Female", "Male"))
```


## by Age
*11 participants removed that refused demographic information
```{r echo=FALSE}

df.intake24_full_demo %>% 
  select(age_cat, Avg_EnergyDensity, Avg_FV_Portions_Total, Avg_FV_Portions_Total_NoJuiceSmoothie, Avg_RRPMg, Avg_Fat_PropFoodEnergy, Avg_SatFat_PropFoodEnergy, Avg_TransFat_PropFoodEnergy, Avg_FreeSugars_PropFoodEnergy, Avg_Carbs_PropFoodEnergy, Avg_AOACFibreg) %>%
  tbl_summary(missing = "no",
              digits = list(all_categorical() ~ c(1,0)),
              type = list(all_continuous() ~ "continuous2"),
              statistic = list(all_continuous() ~ c("{mean} ({sd})",
                                                    "{median} ({p25}, {p75})")),
              by = age_cat, 
              label = c(
                Avg_EnergyDensity ~ "Energy density",
                Avg_FV_Portions_Total ~ "Fruit and vegetables - portions/day",
                Avg_FV_Portions_Total_NoJuiceSmoothie ~ "Fruit and vegetables - portions/day (no fruit smoothie)",
                Avg_RRPMg ~ "Red and red processed meat - g/day",
                Avg_Fat_PropFoodEnergy ~ "Total fat - % food energy",
                Avg_SatFat_PropFoodEnergy ~ "Saturated fat - % food energy",
                Avg_TransFat_PropFoodEnergy ~ "Trans fat - % food energy",
                Avg_FreeSugars_PropFoodEnergy ~ "Free sugars - % food energy",
                Avg_Carbs_PropFoodEnergy ~ "Total carbs - % food energy",
                Avg_AOACFibreg ~ "Fibre - g/day"
                )
  ) %>%
  add_p() %>%
  add_significance_stars() %>%
  modify_header(label ~ "**Daily Intakes**") %>%
  bold_labels() %>%  
  as_flex_table() 




table.sdgs.age <- tbl_svysummary(
  svy.df.intake24_participant,
  by = age_cat,
  label = c(SDG_Energy ~ "Energy density",
            SDG_Fat ~ "Fat",
            SDG_SatFat ~ "Saturated fat",
            SDG_TransFat ~ "Trans fat",
            SDG_FreeSugar ~ "Free sugars",
            SDG_Carbs ~ "Carbohydrates",
            SDG_Fibre ~ "Fibre",
            SDG_Salt ~ "Salt",
            SDG_FV ~ "Vegetables and fruit",
            SDG_FV_NoJuiceSmoothie ~ "Vegetables and fruit - no juice / smoothie",
            SDG_RRPM ~ "Red and red processed meat",
            SDG_oilyfish ~ "Oily fish"),
  statistic = list(all_continuous() ~ "{median} ({p25}, {p75}),
                                       {mean} ({SD})
                                       {min} - {max}", all_categorical() ~ "{p}% ({n_unweighted})"),
  missing = "ifany",
  digits = list(all_categorical() ~ c(1,0)),
  include = c(SDG_Energy, SDG_Fat, SDG_SatFat, SDG_TransFat, SDG_FreeSugar, SDG_Carbs, SDG_Fibre, SDG_Salt, SDG_FV, SDG_FV_NoJuiceSmoothie, SDG_RRPM, SDG_oilyfish)) %>%
  add_overall() %>%
  modify_header(label ~ "**Weighted Daily Intakes**") %>%
  bold_labels() %>% 
  as_flex_table()


table.sdgs.age


```

## by Sex
*11 participants removed that refused demographic information
```{r echo=FALSE}

df.intake24_full_demo %>% 
  select(Sex, Avg_EnergyDensity, Avg_FV_Portions_Total, Avg_FV_Portions_Total_NoJuiceSmoothie, Avg_RRPMg, Avg_Fat_PropFoodEnergy, Avg_SatFat_PropFoodEnergy, Avg_TransFat_PropFoodEnergy, Avg_FreeSugars_PropFoodEnergy, Avg_Carbs_PropFoodEnergy, Avg_AOACFibreg) %>%
  tbl_summary(missing = "no",
              digits = list(all_categorical() ~ c(1,0)),
              type = list(all_continuous() ~ "continuous2"),
              statistic = list(all_continuous() ~ c("{mean} ({sd})",
                                                    "{median} ({p25}, {p75})")),
              by = Sex, 
              label = c(
                Avg_EnergyDensity ~ "Energy density",
                Avg_FV_Portions_Total ~ "Fruit and vegetables - portions/day",
                Avg_FV_Portions_Total_NoJuiceSmoothie ~ "Fruit and vegetables - portions/day (no fruit smoothie)",
                Avg_RRPMg ~ "Red and red processed meat - g/day",
                Avg_Fat_PropFoodEnergy ~ "Total fat - % food energy",
                Avg_SatFat_PropFoodEnergy ~ "Saturated fat - % food energy",
                Avg_TransFat_PropFoodEnergy ~ "Trans fat - % food energy",
                Avg_FreeSugars_PropFoodEnergy ~ "Free sugars - % food energy",
                Avg_Carbs_PropFoodEnergy ~ "Total carbs - % food energy",
                Avg_AOACFibreg ~ "Fibre - g/day"
                )
  ) %>%
  add_p() %>%
  add_significance_stars() %>%
  modify_header(label ~ "**Daily Intakes**") %>%
  bold_labels() %>%  
  as_flex_table() 




table.sdgs.sex <- tbl_svysummary(
  svy.df.intake24_participant,
  by = Sex,
  label = c(SDG_Energy ~ "Energy density",
            SDG_Fat ~ "Fat",
            SDG_SatFat ~ "Saturated fat",
            SDG_TransFat ~ "Trans fat",
            SDG_FreeSugar ~ "Free sugars",
            SDG_Carbs ~ "Carbohydrates",
            SDG_Fibre ~ "Fibre",
            SDG_Salt ~ "Salt",
            SDG_FV ~ "Vegetables and fruit",
            SDG_FV_NoJuiceSmoothie ~ "Vegetables and fruit - no juice / smoothie",
            SDG_RRPM ~ "Red and red processed meat",
            SDG_oilyfish ~ "Oily fish"),
  statistic = list(all_continuous() ~ "{median} ({p25}, {p75}),
                                       {mean} ({SD})
                                       {min} - {max}", all_categorical() ~ "{p}% ({n_unweighted})"),
  missing = "ifany",
  digits = list(all_categorical() ~ c(1,0)),
  include = c(SDG_Energy, SDG_Fat, SDG_SatFat, SDG_TransFat, SDG_FreeSugar, SDG_Carbs, SDG_Fibre, SDG_Salt, SDG_FV, SDG_FV_NoJuiceSmoothie, SDG_RRPM, SDG_oilyfish)) %>%
  add_overall() %>%
  modify_header(label ~ "**Weighted Daily Intakes**") %>%
  bold_labels() %>% 
  as_flex_table()


table.sdgs.sex
```

## **TO CHECK** by SIMD
```{r echo=FALSE}

df.intake24_full_demo %>% 
  select(simd_quintile, Avg_EnergyDensity, Avg_FV_Portions_Total, Avg_FV_Portions_Total_NoJuiceSmoothie, Avg_RRPMg, Avg_Fat_PropFoodEnergy, Avg_SatFat_PropFoodEnergy, Avg_TransFat_PropFoodEnergy, Avg_FreeSugars_PropFoodEnergy, Avg_Carbs_PropFoodEnergy, Avg_AOACFibreg) %>%
  tbl_summary(missing = "no",
              digits = list(all_categorical() ~ c(1,0)),
              type = list(all_continuous() ~ "continuous2"),
              statistic = list(all_continuous() ~ c("{mean} ({sd})",
                                                    "{median} ({p25}, {p75})")),
              by = simd_quintile, 
              label = c(
                Avg_EnergyDensity ~ "Energy density",
                Avg_FV_Portions_Total ~ "Fruit and vegetables - portions/day",
                Avg_FV_Portions_Total_NoJuiceSmoothie ~ "Fruit and vegetables - portions/day (no fruit smoothie)",
                Avg_RRPMg ~ "Red and red processed meat - g/day",
                Avg_Fat_PropFoodEnergy ~ "Total fat - % food energy",
                Avg_SatFat_PropFoodEnergy ~ "Saturated fat - % food energy",
                Avg_TransFat_PropFoodEnergy ~ "Trans fat - % food energy",
                Avg_FreeSugars_PropFoodEnergy ~ "Free sugars - % food energy",
                Avg_Carbs_PropFoodEnergy ~ "Total carbs - % food energy",
                Avg_AOACFibreg ~ "Fibre - g/day"
                )
  ) %>%
  add_p() %>%
  add_significance_stars() %>%
  modify_header(label ~ "**Daily Intakes**") %>%
  bold_labels() %>%  
  as_flex_table() 

table.sdgs.simd <- tbl_svysummary(
  svy.df.intake24_participant,
  by = simd_quintile,
  label = c(SDG_Energy ~ "Energy density",
            SDG_Fat ~ "Fat",
            SDG_SatFat ~ "Saturated fat",
            SDG_TransFat ~ "Trans fat",
            SDG_FreeSugar ~ "Free sugars",
            SDG_Carbs ~ "Carbohydrates",
            SDG_Fibre ~ "Fibre",
            SDG_Salt ~ "Salt",
            SDG_FV ~ "Vegetables and fruit",
            SDG_FV_NoJuiceSmoothie ~ "Vegetables and fruit - no juice / smoothie",
            SDG_RRPM ~ "Red and red processed meat",
            SDG_oilyfish ~ "Oily fish"),
  statistic = list(all_continuous() ~ "{median} ({p25}, {p75}),
                                       {mean} ({SD})
                                       {min} - {max}", all_categorical() ~ "{p}% ({n_unweighted})"),
  missing = "ifany",
  digits = list(all_categorical() ~ c(1,0)),
  include = c(SDG_Energy, SDG_Fat, SDG_SatFat, SDG_TransFat, SDG_FreeSugar, SDG_Carbs, SDG_Fibre, SDG_Salt, SDG_FV, SDG_FV_NoJuiceSmoothie, SDG_RRPM, SDG_oilyfish)) %>%
  add_overall() %>%
  modify_header(label ~ "**Weighted Daily Intakes**") %>%
  bold_labels() %>% 
  as_flex_table()


table.sdgs.simd
```

## Oily Fish FFQ
```{r echo=FALSE}
df.survey$age_cat <- factor(df.survey$age_cat, levels = c("2-4y", "5-10y", "11-15y"))
    df.survey$age_cat <- fct_explicit_na(df.survey$age_cat)    
    
    
df.survey$AFreqRRPM <- factor(df.survey$AFreqRRPM, levels = c("Every day", "4-6 times a week", "2-3 times a week", "Once a week", "Less than once a week", "Never", "Not sure" ))
df.survey$AFreqRRPM <- fct_explicit_na(df.survey$AFreqRRPM)

df.survey$AFreqOilyFish <- factor(df.survey$AFreqOilyFish, levels = c("Every day", "4-6 times a week", "2-3 times a week", "Once a week", "Less than once a week", "Never", "Not sure" ))
df.survey$AFreqOilyFish <- fct_explicit_na(df.survey$AFreqOilyFish)

df.survey %>% 
  select(age_cat, AFreqOilyFish) %>%
  tbl_summary(missing = "no",
              digits = list(all_categorical() ~ c(1,0)),
              type = list(all_continuous() ~ "continuous2"),
              statistic = list(all_continuous() ~ c("{mean} ({sd})",
                                                    "{min}, {max}")),
              by = age_cat,
              label = AFreqOilyFish ~ "Oily Fish"
  ) %>%
  add_overall() %>%
  modify_header(label ~ "**SDG **") %>%
  bold_labels() %>%  
  as_flex_table()
```

# Food Groups - NDNS
Create high level food groups and output those as well
- create in dish cleaning and run through as full analysis

##Energy
```{r}
# Mean portions
table.energy.fg <- tbl_svysummary(
  svy.df.intake24_part_ndns_fg,
  by = age_sex_cat,
  label = c(Avg_Prop_Energykcal_fg_1 ~ "Pasta, rice and other miscellaneous cereals",
        Avg_Prop_Energykcal_fg_2 ~ "White bread",
        Avg_Prop_Energykcal_fg_3 ~ "Wholemeal bread",
        Avg_Prop_Energykcal_fg_4 ~ "Other breads",
        Avg_Prop_Energykcal_fg_5 ~ "High fibre breakfast cereals",
        Avg_Prop_Energykcal_fg_6 ~ "Other breakfast cereals",
        Avg_Prop_Energykcal_fg_7 ~ "Biscuits",
        Avg_Prop_Energykcal_fg_8 ~ "Buns, cakes, pastries and fruit pies",
        Avg_Prop_Energykcal_fg_9 ~ "Puddings",
        Avg_Prop_Energykcal_fg_10 ~ "Whole milk",
        Avg_Prop_Energykcal_fg_11 ~ "Semi-skimmed milk",
        Avg_Prop_Energykcal_fg_12 ~ "Skimmed milk",
        Avg_Prop_Energykcal_fg_13 ~ "Other milk and cream",
        Avg_Prop_Energykcal_fg_14 ~ "Cheese",
        Avg_Prop_Energykcal_fg_15 ~ "Yogurt, fromage frais and other dairy desserts",
        Avg_Prop_Energykcal_fg_16 ~ "Eggs and egg dishes",
        Avg_Prop_Energykcal_fg_17 ~ "Butter",
        Avg_Prop_Energykcal_fg_18 ~ "Polyunsaturated margarine and oils",
        Avg_Prop_Energykcal_fg_19 ~ "Low fat spread",
        Avg_Prop_Energykcal_fg_20 ~ "Margarine and other cooking fats and oils NOT polyunsaturated",
        Avg_Prop_Energykcal_fg_21 ~ "Reduced fat spread",
        Avg_Prop_Energykcal_fg_22 ~ "Bacon and ham",
        Avg_Prop_Energykcal_fg_23 ~ "Beef, veal and dishes",
        Avg_Prop_Energykcal_fg_24 ~ "Lamb and dishes",
        Avg_Prop_Energykcal_fg_25 ~ "Pork and dishes",
        Avg_Prop_Energykcal_fg_26 ~ "Coated chicken and turkey manufactured",
        Avg_Prop_Energykcal_fg_27 ~ "Chicken and turkey dishes",
        Avg_Prop_Energykcal_fg_28 ~ "Liver, products and dishes",
        Avg_Prop_Energykcal_fg_29 ~ "Burgers and kebabs",
        Avg_Prop_Energykcal_fg_30 ~ "Sausages",
        Avg_Prop_Energykcal_fg_31 ~ "Meat pies and pastries",
        Avg_Prop_Energykcal_fg_32 ~ "Other meat and meat products",
        Avg_Prop_Energykcal_fg_33 ~ "White fish coated or fried",
        Avg_Prop_Energykcal_fg_34 ~ "Other white fish, shellfish and fish dishes",
        Avg_Prop_Energykcal_fg_35 ~ "Oily fish",
        Avg_Prop_Energykcal_fg_36 ~ "Salad and other raw vegetables",
        Avg_Prop_Energykcal_fg_37 ~ "Vegetables (not raw)",
        Avg_Prop_Energykcal_fg_38 ~ "Chips, fried and roast potatoes and potato products",
        Avg_Prop_Energykcal_fg_39 ~ "Other potatoes, potato salads and dishes",
        Avg_Prop_Energykcal_fg_40 ~ "Fruit",
        Avg_Prop_Energykcal_fg_41 ~ "Sugars, preserves and sweet spreads",
        Avg_Prop_Energykcal_fg_42 ~ "Crisps and savoury snacks",
        Avg_Prop_Energykcal_fg_43 ~ "Sugar confectionery",
        Avg_Prop_Energykcal_fg_44 ~ "Chocolate confectionery",
        Avg_Prop_Energykcal_fg_45 ~ "Fruit juice",
        Avg_Prop_Energykcal_fg_47 ~ "Spirits and liqueurs",
        Avg_Prop_Energykcal_fg_48 ~ "Wine",
        Avg_Prop_Energykcal_fg_49 ~ "Beer lager cider and perry",
        Avg_Prop_Energykcal_fg_50 ~ "Miscellaneous",
        Avg_Prop_Energykcal_fg_51 ~ "Tea, coffee and water",
        Avg_Prop_Energykcal_fg_52 ~ "Commercial toddlers foods and drinks",
        Avg_Prop_Energykcal_fg_53 ~ "Ice cream",
        Avg_Prop_Energykcal_fg_54 ~ "Dietary supplements",
        Avg_Prop_Energykcal_fg_55 ~ "Artificial sweeteners",
        Avg_Prop_Energykcal_fg_56 ~ "Nuts and seeds",
        Avg_Prop_Energykcal_fg_57 ~ "Soft drinks, not diet",
        Avg_Prop_Energykcal_fg_58 ~ "Soft drinks, diet",
        Avg_Prop_Energykcal_fg_59 ~ "Brown, granary and wheatgerm bread",
        Avg_Prop_Energykcal_fg_60 ~ "1% Milk",
        Avg_Prop_Energykcal_fg_62 ~ "Sandwiches",
        Avg_Prop_Energykcal_fg_63 ~ "Other milk and cream DF",                         
        Avg_Prop_Energykcal_fg_64 ~ "Cheese DF",
        Avg_Prop_Energykcal_fg_65 ~ "Yogurt, fromage frais and other dairy desserts DF",
        Avg_Prop_Energykcal_fg_66 ~ "Ice cream DF"),
  statistic = list(all_continuous() ~ 
                                       "{mean}"),
  missing = "no",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_Prop_Energykcal_fg_1:Avg_Prop_Energykcal_fg_66)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.energy.fg

```

##Carbs
```{r}
# Mean portions
table.carbs.fg <- tbl_svysummary(
  svy.df.intake24_part_ndns_fg,
  by = age_sex_cat,
  label = c(Avg_Prop_Carbohydrateg_fg_1 ~ "Pasta, rice and other miscellaneous cereals",
        Avg_Prop_Carbohydrateg_fg_2 ~ "White bread",
        Avg_Prop_Carbohydrateg_fg_3 ~ "Wholemeal bread",
        Avg_Prop_Carbohydrateg_fg_4 ~ "Other breads",
        Avg_Prop_Carbohydrateg_fg_5 ~ "High fibre breakfast cereals",
        Avg_Prop_Carbohydrateg_fg_6 ~ "Other breakfast cereals",
        Avg_Prop_Carbohydrateg_fg_7 ~ "Biscuits",
        Avg_Prop_Carbohydrateg_fg_8 ~ "Buns, cakes, pastries and fruit pies",
        Avg_Prop_Carbohydrateg_fg_9 ~ "Puddings",
        Avg_Prop_Carbohydrateg_fg_10 ~ "Whole milk",
        Avg_Prop_Carbohydrateg_fg_11 ~ "Semi-skimmed milk",
        Avg_Prop_Carbohydrateg_fg_12 ~ "Skimmed milk",
        Avg_Prop_Carbohydrateg_fg_13 ~ "Other milk and cream",
        Avg_Prop_Carbohydrateg_fg_14 ~ "Cheese",
        Avg_Prop_Carbohydrateg_fg_15 ~ "Yogurt, fromage frais and other dairy desserts",
        Avg_Prop_Carbohydrateg_fg_16 ~ "Eggs and egg dishes",
        Avg_Prop_Carbohydrateg_fg_17 ~ "Butter",
        Avg_Prop_Carbohydrateg_fg_18 ~ "Polyunsaturated margarine and oils",
        Avg_Prop_Carbohydrateg_fg_19 ~ "Low fat spread",
        Avg_Prop_Carbohydrateg_fg_20 ~ "Margarine and other cooking fats and oils NOT polyunsaturated",
        Avg_Prop_Carbohydrateg_fg_21 ~ "Reduced fat spread",
        Avg_Prop_Carbohydrateg_fg_22 ~ "Bacon and ham",
        Avg_Prop_Carbohydrateg_fg_23 ~ "Beef, veal and dishes",
        Avg_Prop_Carbohydrateg_fg_24 ~ "Lamb and dishes",
        Avg_Prop_Carbohydrateg_fg_25 ~ "Pork and dishes",
        Avg_Prop_Carbohydrateg_fg_26 ~ "Coated chicken and turkey manufactured",
        Avg_Prop_Carbohydrateg_fg_27 ~ "Chicken and turkey dishes",
        Avg_Prop_Carbohydrateg_fg_28 ~ "Liver, products and dishes",
        Avg_Prop_Carbohydrateg_fg_29 ~ "Burgers and kebabs",
        Avg_Prop_Carbohydrateg_fg_30 ~ "Sausages",
        Avg_Prop_Carbohydrateg_fg_31 ~ "Meat pies and pastries",
        Avg_Prop_Carbohydrateg_fg_32 ~ "Other meat and meat products",
        Avg_Prop_Carbohydrateg_fg_33 ~ "White fish coated or fried",
        Avg_Prop_Carbohydrateg_fg_34 ~ "Other white fish, shellfish and fish dishes",
        Avg_Prop_Carbohydrateg_fg_35 ~ "Oily fish",
        Avg_Prop_Carbohydrateg_fg_36 ~ "Salad and other raw vegetables",
        Avg_Prop_Carbohydrateg_fg_37 ~ "Vegetables (not raw)",
        Avg_Prop_Carbohydrateg_fg_38 ~ "Chips, fried and roast potatoes and potato products",
        Avg_Prop_Carbohydrateg_fg_39 ~ "Other potatoes, potato salads and dishes",
        Avg_Prop_Carbohydrateg_fg_40 ~ "Fruit",
        Avg_Prop_Carbohydrateg_fg_41 ~ "Sugars, preserves and sweet spreads",
        Avg_Prop_Carbohydrateg_fg_42 ~ "Crisps and savoury snacks",
        Avg_Prop_Carbohydrateg_fg_43 ~ "Sugar confectionery",
        Avg_Prop_Carbohydrateg_fg_44 ~ "Chocolate confectionery",
        Avg_Prop_Carbohydrateg_fg_45 ~ "Fruit juice",
        Avg_Prop_Carbohydrateg_fg_47 ~ "Spirits and liqueurs",
        Avg_Prop_Carbohydrateg_fg_48 ~ "Wine",
        Avg_Prop_Carbohydrateg_fg_49 ~ "Beer lager cider and perry",
        Avg_Prop_Carbohydrateg_fg_50 ~ "Miscellaneous",
        Avg_Prop_Carbohydrateg_fg_51 ~ "Tea, coffee and water",
        Avg_Prop_Carbohydrateg_fg_52 ~ "Commercial toddlers foods and drinks",
        Avg_Prop_Carbohydrateg_fg_53 ~ "Ice cream",
        Avg_Prop_Carbohydrateg_fg_54 ~ "Dietary supplements",
        Avg_Prop_Carbohydrateg_fg_55 ~ "Artificial sweeteners",
        Avg_Prop_Carbohydrateg_fg_56 ~ "Nuts and seeds",
        Avg_Prop_Carbohydrateg_fg_57 ~ "Soft drinks, not diet",
        Avg_Prop_Carbohydrateg_fg_58 ~ "Soft drinks, diet",
        Avg_Prop_Carbohydrateg_fg_59 ~ "Brown, granary and wheatgerm bread",
        Avg_Prop_Carbohydrateg_fg_60 ~ "1% Milk",
        Avg_Prop_Carbohydrateg_fg_62 ~ "Sandwiches",
        Avg_Prop_Carbohydrateg_fg_63 ~ "Other milk and cream DF",                         
        Avg_Prop_Carbohydrateg_fg_64 ~ "Cheese DF",
        Avg_Prop_Carbohydrateg_fg_65 ~ "Yogurt, fromage frais and other dairy desserts DF",
        Avg_Prop_Carbohydrateg_fg_66 ~ "Ice cream DF"),
  statistic = list(all_continuous() ~ 
                                       "{mean}"),
  missing = "no",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_Prop_Carbohydrateg_fg_1:Avg_Prop_Carbohydrateg_fg_66)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.carbs.fg

```


##Free Sugars
```{r}
# Mean portions
table.FreeSugars.fg <- tbl_svysummary(
  svy.df.intake24_part_ndns_fg,
  by = age_sex_cat,
  label = c(Avg_Prop_FreeSugarsg_fg_1 ~ "Pasta, rice and other miscellaneous cereals",
        Avg_Prop_FreeSugarsg_fg_2 ~ "White bread",
        Avg_Prop_FreeSugarsg_fg_3 ~ "Wholemeal bread",
        Avg_Prop_FreeSugarsg_fg_4 ~ "Other breads",
        Avg_Prop_FreeSugarsg_fg_5 ~ "High fibre breakfast cereals",
        Avg_Prop_FreeSugarsg_fg_6 ~ "Other breakfast cereals",
        Avg_Prop_FreeSugarsg_fg_7 ~ "Biscuits",
        Avg_Prop_FreeSugarsg_fg_8 ~ "Buns, cakes, pastries and fruit pies",
        Avg_Prop_FreeSugarsg_fg_9 ~ "Puddings",
        Avg_Prop_FreeSugarsg_fg_10 ~ "Whole milk",
        Avg_Prop_FreeSugarsg_fg_11 ~ "Semi-skimmed milk",
        Avg_Prop_FreeSugarsg_fg_12 ~ "Skimmed milk",
        Avg_Prop_FreeSugarsg_fg_13 ~ "Other milk and cream",
        Avg_Prop_FreeSugarsg_fg_14 ~ "Cheese",
        Avg_Prop_FreeSugarsg_fg_15 ~ "Yogurt, fromage frais and other dairy desserts",
        Avg_Prop_FreeSugarsg_fg_16 ~ "Eggs and egg dishes",
        Avg_Prop_FreeSugarsg_fg_17 ~ "Butter",
        Avg_Prop_FreeSugarsg_fg_18 ~ "Polyunsaturated margarine and oils",
        Avg_Prop_FreeSugarsg_fg_19 ~ "Low fat spread",
        Avg_Prop_FreeSugarsg_fg_20 ~ "Margarine and other cooking fats and oils NOT polyunsaturated",
        Avg_Prop_FreeSugarsg_fg_21 ~ "Reduced fat spread",
        Avg_Prop_FreeSugarsg_fg_22 ~ "Bacon and ham",
        Avg_Prop_FreeSugarsg_fg_23 ~ "Beef, veal and dishes",
        Avg_Prop_FreeSugarsg_fg_24 ~ "Lamb and dishes",
        Avg_Prop_FreeSugarsg_fg_25 ~ "Pork and dishes",
        Avg_Prop_FreeSugarsg_fg_26 ~ "Coated chicken and turkey manufactured",
        Avg_Prop_FreeSugarsg_fg_27 ~ "Chicken and turkey dishes",
        Avg_Prop_FreeSugarsg_fg_28 ~ "Liver, products and dishes",
        Avg_Prop_FreeSugarsg_fg_29 ~ "Burgers and kebabs",
        Avg_Prop_FreeSugarsg_fg_30 ~ "Sausages",
        Avg_Prop_FreeSugarsg_fg_31 ~ "Meat pies and pastries",
        Avg_Prop_FreeSugarsg_fg_32 ~ "Other meat and meat products",
        Avg_Prop_FreeSugarsg_fg_33 ~ "White fish coated or fried",
        Avg_Prop_FreeSugarsg_fg_34 ~ "Other white fish, shellfish and fish dishes",
        Avg_Prop_FreeSugarsg_fg_35 ~ "Oily fish",
        Avg_Prop_FreeSugarsg_fg_36 ~ "Salad and other raw vegetables",
        Avg_Prop_FreeSugarsg_fg_37 ~ "Vegetables (not raw)",
        Avg_Prop_FreeSugarsg_fg_38 ~ "Chips, fried and roast potatoes and potato products",
        Avg_Prop_FreeSugarsg_fg_39 ~ "Other potatoes, potato salads and dishes",
        Avg_Prop_FreeSugarsg_fg_40 ~ "Fruit",
        Avg_Prop_FreeSugarsg_fg_41 ~ "Sugars, preserves and sweet spreads",
        Avg_Prop_FreeSugarsg_fg_42 ~ "Crisps and savoury snacks",
        Avg_Prop_FreeSugarsg_fg_43 ~ "Sugar confectionery",
        Avg_Prop_FreeSugarsg_fg_44 ~ "Chocolate confectionery",
        Avg_Prop_FreeSugarsg_fg_45 ~ "Fruit juice",
        Avg_Prop_FreeSugarsg_fg_47 ~ "Spirits and liqueurs",
        Avg_Prop_FreeSugarsg_fg_48 ~ "Wine",
        Avg_Prop_FreeSugarsg_fg_49 ~ "Beer lager cider and perry",
        Avg_Prop_FreeSugarsg_fg_50 ~ "Miscellaneous",
        Avg_Prop_FreeSugarsg_fg_51 ~ "Tea, coffee and water",
        Avg_Prop_FreeSugarsg_fg_52 ~ "Commercial toddlers foods and drinks",
        Avg_Prop_FreeSugarsg_fg_53 ~ "Ice cream",
        Avg_Prop_FreeSugarsg_fg_54 ~ "Dietary supplements",
        Avg_Prop_FreeSugarsg_fg_55 ~ "Artificial sweeteners",
        Avg_Prop_FreeSugarsg_fg_56 ~ "Nuts and seeds",
        Avg_Prop_FreeSugarsg_fg_57 ~ "Soft drinks, not diet",
        Avg_Prop_FreeSugarsg_fg_58 ~ "Soft drinks, diet",
        Avg_Prop_FreeSugarsg_fg_59 ~ "Brown, granary and wheatgerm bread",
        Avg_Prop_FreeSugarsg_fg_60 ~ "1% Milk",
        Avg_Prop_FreeSugarsg_fg_62 ~ "Sandwiches",
        Avg_Prop_FreeSugarsg_fg_63 ~ "Other milk and cream DF",                         
        Avg_Prop_FreeSugarsg_fg_64 ~ "Cheese DF",
        Avg_Prop_FreeSugarsg_fg_65 ~ "Yogurt, fromage frais and other dairy desserts DF",
        Avg_Prop_FreeSugarsg_fg_66 ~ "Ice cream DF"),
  statistic = list(all_continuous() ~ 
                                       "{mean}"),
  missing = "no",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_Prop_FreeSugarsg_fg_1:Avg_Prop_FreeSugarsg_fg_66)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.FreeSugars.fg

```


##Fat
```{r}
# Mean portions
table.fat.fg <- tbl_svysummary(
  svy.df.intake24_part_ndns_fg,
  by = age_sex_cat,
  label = c(Avg_Prop_Fatg_fg_1 ~ "Pasta, rice and other miscellaneous cereals",
        Avg_Prop_Fatg_fg_2 ~ "White bread",
        Avg_Prop_Fatg_fg_3 ~ "Wholemeal bread",
        Avg_Prop_Fatg_fg_4 ~ "Other breads",
        Avg_Prop_Fatg_fg_5 ~ "High fibre breakfast cereals",
        Avg_Prop_Fatg_fg_6 ~ "Other breakfast cereals",
        Avg_Prop_Fatg_fg_7 ~ "Biscuits",
        Avg_Prop_Fatg_fg_8 ~ "Buns, cakes, pastries and fruit pies",
        Avg_Prop_Fatg_fg_9 ~ "Puddings",
        Avg_Prop_Fatg_fg_10 ~ "Whole milk",
        Avg_Prop_Fatg_fg_11 ~ "Semi-skimmed milk",
        Avg_Prop_Fatg_fg_12 ~ "Skimmed milk",
        Avg_Prop_Fatg_fg_13 ~ "Other milk and cream",
        Avg_Prop_Fatg_fg_14 ~ "Cheese",
        Avg_Prop_Fatg_fg_15 ~ "Yogurt, fromage frais and other dairy desserts",
        Avg_Prop_Fatg_fg_16 ~ "Eggs and egg dishes",
        Avg_Prop_Fatg_fg_17 ~ "Butter",
        Avg_Prop_Fatg_fg_18 ~ "Polyunsaturated margarine and oils",
        Avg_Prop_Fatg_fg_19 ~ "Low fat spread",
        Avg_Prop_Fatg_fg_20 ~ "Margarine and other cooking fats and oils NOT polyunsaturated",
        Avg_Prop_Fatg_fg_21 ~ "Reduced fat spread",
        Avg_Prop_Fatg_fg_22 ~ "Bacon and ham",
        Avg_Prop_Fatg_fg_23 ~ "Beef, veal and dishes",
        Avg_Prop_Fatg_fg_24 ~ "Lamb and dishes",
        Avg_Prop_Fatg_fg_25 ~ "Pork and dishes",
        Avg_Prop_Fatg_fg_26 ~ "Coated chicken and turkey manufactured",
        Avg_Prop_Fatg_fg_27 ~ "Chicken and turkey dishes",
        Avg_Prop_Fatg_fg_28 ~ "Liver, products and dishes",
        Avg_Prop_Fatg_fg_29 ~ "Burgers and kebabs",
        Avg_Prop_Fatg_fg_30 ~ "Sausages",
        Avg_Prop_Fatg_fg_31 ~ "Meat pies and pastries",
        Avg_Prop_Fatg_fg_32 ~ "Other meat and meat products",
        Avg_Prop_Fatg_fg_33 ~ "White fish coated or fried",
        Avg_Prop_Fatg_fg_34 ~ "Other white fish, shellfish and fish dishes",
        Avg_Prop_Fatg_fg_35 ~ "Oily fish",
        Avg_Prop_Fatg_fg_36 ~ "Salad and other raw vegetables",
        Avg_Prop_Fatg_fg_37 ~ "Vegetables (not raw)",
        Avg_Prop_Fatg_fg_38 ~ "Chips, fried and roast potatoes and potato products",
        Avg_Prop_Fatg_fg_39 ~ "Other potatoes, potato salads and dishes",
        Avg_Prop_Fatg_fg_40 ~ "Fruit",
        Avg_Prop_Fatg_fg_41 ~ "Sugars, preserves and sweet spreads",
        Avg_Prop_Fatg_fg_42 ~ "Crisps and savoury snacks",
        Avg_Prop_Fatg_fg_43 ~ "Sugar confectionery",
        Avg_Prop_Fatg_fg_44 ~ "Chocolate confectionery",
        Avg_Prop_Fatg_fg_45 ~ "Fruit juice",
        Avg_Prop_Fatg_fg_47 ~ "Spirits and liqueurs",
        Avg_Prop_Fatg_fg_48 ~ "Wine",
        Avg_Prop_Fatg_fg_49 ~ "Beer lager cider and perry",
        Avg_Prop_Fatg_fg_50 ~ "Miscellaneous",
        Avg_Prop_Fatg_fg_51 ~ "Tea, coffee and water",
        Avg_Prop_Fatg_fg_52 ~ "Commercial toddlers foods and drinks",
        Avg_Prop_Fatg_fg_53 ~ "Ice cream",
        Avg_Prop_Fatg_fg_54 ~ "Dietary supplements",
        Avg_Prop_Fatg_fg_55 ~ "Artificial sweeteners",
        Avg_Prop_Fatg_fg_56 ~ "Nuts and seeds",
        Avg_Prop_Fatg_fg_57 ~ "Soft drinks, not diet",
        Avg_Prop_Fatg_fg_58 ~ "Soft drinks, diet",
        Avg_Prop_Fatg_fg_59 ~ "Brown, granary and wheatgerm bread",
        Avg_Prop_Fatg_fg_60 ~ "1% Milk",
        Avg_Prop_Fatg_fg_62 ~ "Sandwiches",
        Avg_Prop_Fatg_fg_63 ~ "Other milk and cream DF",                         
        Avg_Prop_Fatg_fg_64 ~ "Cheese DF",
        Avg_Prop_Fatg_fg_65 ~ "Yogurt, fromage frais and other dairy desserts DF",
        Avg_Prop_Fatg_fg_66 ~ "Ice cream DF"),
  statistic = list(all_continuous() ~ 
                                       "{mean}"),
  missing = "no",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_Prop_Fatg_fg_1:Avg_Prop_Fatg_fg_66)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.fat.fg

```

##Sat Fat
```{r}
# Mean portions
table.SatFat.fg <- tbl_svysummary(
  svy.df.intake24_part_ndns_fg,
  by = age_sex_cat,
  label = c(Avg_Prop_SatFatg_fg_1 ~ "Pasta, rice and other miscellaneous cereals",
        Avg_Prop_SatFatg_fg_2 ~ "White bread",
        Avg_Prop_SatFatg_fg_3 ~ "Wholemeal bread",
        Avg_Prop_SatFatg_fg_4 ~ "Other breads",
        Avg_Prop_SatFatg_fg_5 ~ "High fibre breakfast cereals",
        Avg_Prop_SatFatg_fg_6 ~ "Other breakfast cereals",
        Avg_Prop_SatFatg_fg_7 ~ "Biscuits",
        Avg_Prop_SatFatg_fg_8 ~ "Buns, cakes, pastries and fruit pies",
        Avg_Prop_SatFatg_fg_9 ~ "Puddings",
        Avg_Prop_SatFatg_fg_10 ~ "Whole milk",
        Avg_Prop_SatFatg_fg_11 ~ "Semi-skimmed milk",
        Avg_Prop_SatFatg_fg_12 ~ "Skimmed milk",
        Avg_Prop_SatFatg_fg_13 ~ "Other milk and cream",
        Avg_Prop_SatFatg_fg_14 ~ "Cheese",
        Avg_Prop_SatFatg_fg_15 ~ "Yogurt, fromage frais and other dairy desserts",
        Avg_Prop_SatFatg_fg_16 ~ "Eggs and egg dishes",
        Avg_Prop_SatFatg_fg_17 ~ "Butter",
        Avg_Prop_SatFatg_fg_18 ~ "Polyunsaturated margarine and oils",
        Avg_Prop_SatFatg_fg_19 ~ "Low fat spread",
        Avg_Prop_SatFatg_fg_20 ~ "Margarine and other cooking fats and oils NOT polyunsaturated",
        Avg_Prop_SatFatg_fg_21 ~ "Reduced fat spread",
        Avg_Prop_SatFatg_fg_22 ~ "Bacon and ham",
        Avg_Prop_SatFatg_fg_23 ~ "Beef, veal and dishes",
        Avg_Prop_SatFatg_fg_24 ~ "Lamb and dishes",
        Avg_Prop_SatFatg_fg_25 ~ "Pork and dishes",
        Avg_Prop_SatFatg_fg_26 ~ "Coated chicken and turkey manufactured",
        Avg_Prop_SatFatg_fg_27 ~ "Chicken and turkey dishes",
        Avg_Prop_SatFatg_fg_28 ~ "Liver, products and dishes",
        Avg_Prop_SatFatg_fg_29 ~ "Burgers and kebabs",
        Avg_Prop_SatFatg_fg_30 ~ "Sausages",
        Avg_Prop_SatFatg_fg_31 ~ "Meat pies and pastries",
        Avg_Prop_SatFatg_fg_32 ~ "Other meat and meat products",
        Avg_Prop_SatFatg_fg_33 ~ "White fish coated or fried",
        Avg_Prop_SatFatg_fg_34 ~ "Other white fish, shellfish and fish dishes",
        Avg_Prop_SatFatg_fg_35 ~ "Oily fish",
        Avg_Prop_SatFatg_fg_36 ~ "Salad and other raw vegetables",
        Avg_Prop_SatFatg_fg_37 ~ "Vegetables (not raw)",
        Avg_Prop_SatFatg_fg_38 ~ "Chips, fried and roast potatoes and potato products",
        Avg_Prop_SatFatg_fg_39 ~ "Other potatoes, potato salads and dishes",
        Avg_Prop_SatFatg_fg_40 ~ "Fruit",
        Avg_Prop_SatFatg_fg_41 ~ "Sugars, preserves and sweet spreads",
        Avg_Prop_SatFatg_fg_42 ~ "Crisps and savoury snacks",
        Avg_Prop_SatFatg_fg_43 ~ "Sugar confectionery",
        Avg_Prop_SatFatg_fg_44 ~ "Chocolate confectionery",
        Avg_Prop_SatFatg_fg_45 ~ "Fruit juice",
        Avg_Prop_SatFatg_fg_47 ~ "Spirits and liqueurs",
        Avg_Prop_SatFatg_fg_48 ~ "Wine",
        Avg_Prop_SatFatg_fg_49 ~ "Beer lager cider and perry",
        Avg_Prop_SatFatg_fg_50 ~ "Miscellaneous",
        Avg_Prop_SatFatg_fg_51 ~ "Tea, coffee and water",
        Avg_Prop_SatFatg_fg_52 ~ "Commercial toddlers foods and drinks",
        Avg_Prop_SatFatg_fg_53 ~ "Ice cream",
        Avg_Prop_SatFatg_fg_54 ~ "Dietary supplements",
        Avg_Prop_SatFatg_fg_55 ~ "Artificial sweeteners",
        Avg_Prop_SatFatg_fg_56 ~ "Nuts and seeds",
        Avg_Prop_SatFatg_fg_57 ~ "Soft drinks, not diet",
        Avg_Prop_SatFatg_fg_58 ~ "Soft drinks, diet",
        Avg_Prop_SatFatg_fg_59 ~ "Brown, granary and wheatgerm bread",
        Avg_Prop_SatFatg_fg_60 ~ "1% Milk",
        Avg_Prop_SatFatg_fg_62 ~ "Sandwiches",
        Avg_Prop_SatFatg_fg_63 ~ "Other milk and cream DF",                         
        Avg_Prop_SatFatg_fg_64 ~ "Cheese DF",
        Avg_Prop_SatFatg_fg_65 ~ "Yogurt, fromage frais and other dairy desserts DF",
        Avg_Prop_SatFatg_fg_66 ~ "Ice cream DF"),
  statistic = list(all_continuous() ~ 
                                       "{mean}"),
  missing = "no",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_Prop_SatFatg_fg_1:Avg_Prop_SatFatg_fg_66)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.SatFat.fg

```

##Trans Fat
```{r}
# Mean portions
table.TransFat.fg <- tbl_svysummary(
  svy.df.intake24_part_ndns_fg,
  by = age_sex_cat,
  label = c(Avg_Prop_TransFatg_fg_1 ~ "Pasta, rice and other miscellaneous cereals",
        Avg_Prop_TransFatg_fg_2 ~ "White bread",
        Avg_Prop_TransFatg_fg_3 ~ "Wholemeal bread",
        Avg_Prop_TransFatg_fg_4 ~ "Other breads",
        Avg_Prop_TransFatg_fg_5 ~ "High fibre breakfast cereals",
        Avg_Prop_TransFatg_fg_6 ~ "Other breakfast cereals",
        Avg_Prop_TransFatg_fg_7 ~ "Biscuits",
        Avg_Prop_TransFatg_fg_8 ~ "Buns, cakes, pastries and fruit pies",
        Avg_Prop_TransFatg_fg_9 ~ "Puddings",
        Avg_Prop_TransFatg_fg_10 ~ "Whole milk",
        Avg_Prop_TransFatg_fg_11 ~ "Semi-skimmed milk",
        Avg_Prop_TransFatg_fg_12 ~ "Skimmed milk",
        Avg_Prop_TransFatg_fg_13 ~ "Other milk and cream",
        Avg_Prop_TransFatg_fg_14 ~ "Cheese",
        Avg_Prop_TransFatg_fg_15 ~ "Yogurt, fromage frais and other dairy desserts",
        Avg_Prop_TransFatg_fg_16 ~ "Eggs and egg dishes",
        Avg_Prop_TransFatg_fg_17 ~ "Butter",
        Avg_Prop_TransFatg_fg_18 ~ "Polyunsaturated margarine and oils",
        Avg_Prop_TransFatg_fg_19 ~ "Low fat spread",
        Avg_Prop_TransFatg_fg_20 ~ "Margarine and other cooking fats and oils NOT polyunsaturated",
        Avg_Prop_TransFatg_fg_21 ~ "Reduced fat spread",
        Avg_Prop_TransFatg_fg_22 ~ "Bacon and ham",
        Avg_Prop_TransFatg_fg_23 ~ "Beef, veal and dishes",
        Avg_Prop_TransFatg_fg_24 ~ "Lamb and dishes",
        Avg_Prop_TransFatg_fg_25 ~ "Pork and dishes",
        Avg_Prop_TransFatg_fg_26 ~ "Coated chicken and turkey manufactured",
        Avg_Prop_TransFatg_fg_27 ~ "Chicken and turkey dishes",
        Avg_Prop_TransFatg_fg_28 ~ "Liver, products and dishes",
        Avg_Prop_TransFatg_fg_29 ~ "Burgers and kebabs",
        Avg_Prop_TransFatg_fg_30 ~ "Sausages",
        Avg_Prop_TransFatg_fg_31 ~ "Meat pies and pastries",
        Avg_Prop_TransFatg_fg_32 ~ "Other meat and meat products",
        Avg_Prop_TransFatg_fg_33 ~ "White fish coated or fried",
        Avg_Prop_TransFatg_fg_34 ~ "Other white fish, shellfish and fish dishes",
        Avg_Prop_TransFatg_fg_35 ~ "Oily fish",
        Avg_Prop_TransFatg_fg_36 ~ "Salad and other raw vegetables",
        Avg_Prop_TransFatg_fg_37 ~ "Vegetables (not raw)",
        Avg_Prop_TransFatg_fg_38 ~ "Chips, fried and roast potatoes and potato products",
        Avg_Prop_TransFatg_fg_39 ~ "Other potatoes, potato salads and dishes",
        Avg_Prop_TransFatg_fg_40 ~ "Fruit",
        Avg_Prop_TransFatg_fg_41 ~ "Sugars, preserves and sweet spreads",
        Avg_Prop_TransFatg_fg_42 ~ "Crisps and savoury snacks",
        Avg_Prop_TransFatg_fg_43 ~ "Sugar confectionery",
        Avg_Prop_TransFatg_fg_44 ~ "Chocolate confectionery",
        Avg_Prop_TransFatg_fg_45 ~ "Fruit juice",
        Avg_Prop_TransFatg_fg_47 ~ "Spirits and liqueurs",
        Avg_Prop_TransFatg_fg_48 ~ "Wine",
        Avg_Prop_TransFatg_fg_49 ~ "Beer lager cider and perry",
        Avg_Prop_TransFatg_fg_50 ~ "Miscellaneous",
        Avg_Prop_TransFatg_fg_51 ~ "Tea, coffee and water",
        Avg_Prop_TransFatg_fg_52 ~ "Commercial toddlers foods and drinks",
        Avg_Prop_TransFatg_fg_53 ~ "Ice cream",
        Avg_Prop_TransFatg_fg_54 ~ "Dietary supplements",
        Avg_Prop_TransFatg_fg_55 ~ "Artificial sweeteners",
        Avg_Prop_TransFatg_fg_56 ~ "Nuts and seeds",
        Avg_Prop_TransFatg_fg_57 ~ "Soft drinks, not diet",
        Avg_Prop_TransFatg_fg_58 ~ "Soft drinks, diet",
        Avg_Prop_TransFatg_fg_59 ~ "Brown, granary and wheatgerm bread",
        Avg_Prop_TransFatg_fg_60 ~ "1% Milk",
        Avg_Prop_TransFatg_fg_62 ~ "Sandwiches",
        Avg_Prop_TransFatg_fg_63 ~ "Other milk and cream DF",                         
        Avg_Prop_TransFatg_fg_64 ~ "Cheese DF",
        Avg_Prop_TransFatg_fg_65 ~ "Yogurt, fromage frais and other dairy desserts DF",
        Avg_Prop_TransFatg_fg_66 ~ "Ice cream DF"),
  statistic = list(all_continuous() ~ 
                                       "{mean}"),
  missing = "no",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_Prop_TransFatg_fg_1:Avg_Prop_TransFatg_fg_66)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.TransFat.fg

```

##Protein
```{r}
# Mean portions
table.protein.fg <- tbl_svysummary(
  svy.df.intake24_part_ndns_fg,
  by = age_sex_cat,
  label = c(Avg_Prop_Proteing_fg_1 ~ "Pasta, rice and other miscellaneous cereals",
        Avg_Prop_Proteing_fg_2 ~ "White bread",
        Avg_Prop_Proteing_fg_3 ~ "Wholemeal bread",
        Avg_Prop_Proteing_fg_4 ~ "Other breads",
        Avg_Prop_Proteing_fg_5 ~ "High fibre breakfast cereals",
        Avg_Prop_Proteing_fg_6 ~ "Other breakfast cereals",
        Avg_Prop_Proteing_fg_7 ~ "Biscuits",
        Avg_Prop_Proteing_fg_8 ~ "Buns, cakes, pastries and fruit pies",
        Avg_Prop_Proteing_fg_9 ~ "Puddings",
        Avg_Prop_Proteing_fg_10 ~ "Whole milk",
        Avg_Prop_Proteing_fg_11 ~ "Semi-skimmed milk",
        Avg_Prop_Proteing_fg_12 ~ "Skimmed milk",
        Avg_Prop_Proteing_fg_13 ~ "Other milk and cream",
        Avg_Prop_Proteing_fg_14 ~ "Cheese",
        Avg_Prop_Proteing_fg_15 ~ "Yogurt, fromage frais and other dairy desserts",
        Avg_Prop_Proteing_fg_16 ~ "Eggs and egg dishes",
        Avg_Prop_Proteing_fg_17 ~ "Butter",
        Avg_Prop_Proteing_fg_18 ~ "Polyunsaturated margarine and oils",
        Avg_Prop_Proteing_fg_19 ~ "Low fat spread",
        Avg_Prop_Proteing_fg_20 ~ "Margarine and other cooking fats and oils NOT polyunsaturated",
        Avg_Prop_Proteing_fg_21 ~ "Reduced fat spread",
        Avg_Prop_Proteing_fg_22 ~ "Bacon and ham",
        Avg_Prop_Proteing_fg_23 ~ "Beef, veal and dishes",
        Avg_Prop_Proteing_fg_24 ~ "Lamb and dishes",
        Avg_Prop_Proteing_fg_25 ~ "Pork and dishes",
        Avg_Prop_Proteing_fg_26 ~ "Coated chicken and turkey manufactured",
        Avg_Prop_Proteing_fg_27 ~ "Chicken and turkey dishes",
        Avg_Prop_Proteing_fg_28 ~ "Liver, products and dishes",
        Avg_Prop_Proteing_fg_29 ~ "Burgers and kebabs",
        Avg_Prop_Proteing_fg_30 ~ "Sausages",
        Avg_Prop_Proteing_fg_31 ~ "Meat pies and pastries",
        Avg_Prop_Proteing_fg_32 ~ "Other meat and meat products",
        Avg_Prop_Proteing_fg_33 ~ "White fish coated or fried",
        Avg_Prop_Proteing_fg_34 ~ "Other white fish, shellfish and fish dishes",
        Avg_Prop_Proteing_fg_35 ~ "Oily fish",
        Avg_Prop_Proteing_fg_36 ~ "Salad and other raw vegetables",
        Avg_Prop_Proteing_fg_37 ~ "Vegetables (not raw)",
        Avg_Prop_Proteing_fg_38 ~ "Chips, fried and roast potatoes and potato products",
        Avg_Prop_Proteing_fg_39 ~ "Other potatoes, potato salads and dishes",
        Avg_Prop_Proteing_fg_40 ~ "Fruit",
        Avg_Prop_Proteing_fg_41 ~ "Sugars, preserves and sweet spreads",
        Avg_Prop_Proteing_fg_42 ~ "Crisps and savoury snacks",
        Avg_Prop_Proteing_fg_43 ~ "Sugar confectionery",
        Avg_Prop_Proteing_fg_44 ~ "Chocolate confectionery",
        Avg_Prop_Proteing_fg_45 ~ "Fruit juice",
        Avg_Prop_Proteing_fg_47 ~ "Spirits and liqueurs",
        Avg_Prop_Proteing_fg_48 ~ "Wine",
        Avg_Prop_Proteing_fg_49 ~ "Beer lager cider and perry",
        Avg_Prop_Proteing_fg_50 ~ "Miscellaneous",
        Avg_Prop_Proteing_fg_51 ~ "Tea, coffee and water",
        Avg_Prop_Proteing_fg_52 ~ "Commercial toddlers foods and drinks",
        Avg_Prop_Proteing_fg_53 ~ "Ice cream",
        Avg_Prop_Proteing_fg_54 ~ "Dietary supplements",
        Avg_Prop_Proteing_fg_55 ~ "Artificial sweeteners",
        Avg_Prop_Proteing_fg_56 ~ "Nuts and seeds",
        Avg_Prop_Proteing_fg_57 ~ "Soft drinks, not diet",
        Avg_Prop_Proteing_fg_58 ~ "Soft drinks, diet",
        Avg_Prop_Proteing_fg_59 ~ "Brown, granary and wheatgerm bread",
        Avg_Prop_Proteing_fg_60 ~ "1% Milk",
        Avg_Prop_Proteing_fg_62 ~ "Sandwiches",
        Avg_Prop_Proteing_fg_63 ~ "Other milk and cream DF",                         
        Avg_Prop_Proteing_fg_64 ~ "Cheese DF",
        Avg_Prop_Proteing_fg_65 ~ "Yogurt, fromage frais and other dairy desserts DF",
        Avg_Prop_Proteing_fg_66 ~ "Ice cream DF"),
  statistic = list(all_continuous() ~ 
                                       "{mean}"),
  missing = "no",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_Prop_Proteing_fg_1:Avg_Prop_Proteing_fg_66)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.protein.fg

```

##Fibre
```{r}
# Mean portions
table.fibre.fg <- tbl_svysummary(
  svy.df.intake24_part_ndns_fg,
  by = age_sex_cat,
  label = c(Avg_Prop_AOACFibreg_fg_1 ~ "Pasta, rice and other miscellaneous cereals",
        Avg_Prop_AOACFibreg_fg_2 ~ "White bread",
        Avg_Prop_AOACFibreg_fg_3 ~ "Wholemeal bread",
        Avg_Prop_AOACFibreg_fg_4 ~ "Other breads",
        Avg_Prop_AOACFibreg_fg_5 ~ "High fibre breakfast cereals",
        Avg_Prop_AOACFibreg_fg_6 ~ "Other breakfast cereals",
        Avg_Prop_AOACFibreg_fg_7 ~ "Biscuits",
        Avg_Prop_AOACFibreg_fg_8 ~ "Buns, cakes, pastries and fruit pies",
        Avg_Prop_AOACFibreg_fg_9 ~ "Puddings",
        Avg_Prop_AOACFibreg_fg_10 ~ "Whole milk",
        Avg_Prop_AOACFibreg_fg_11 ~ "Semi-skimmed milk",
        Avg_Prop_AOACFibreg_fg_12 ~ "Skimmed milk",
        Avg_Prop_AOACFibreg_fg_13 ~ "Other milk and cream",
        Avg_Prop_AOACFibreg_fg_14 ~ "Cheese",
        Avg_Prop_AOACFibreg_fg_15 ~ "Yogurt, fromage frais and other dairy desserts",
        Avg_Prop_AOACFibreg_fg_16 ~ "Eggs and egg dishes",
        Avg_Prop_AOACFibreg_fg_17 ~ "Butter",
        Avg_Prop_AOACFibreg_fg_18 ~ "Polyunsaturated margarine and oils",
        Avg_Prop_AOACFibreg_fg_19 ~ "Low fat spread",
        Avg_Prop_AOACFibreg_fg_20 ~ "Margarine and other cooking fats and oils NOT polyunsaturated",
        Avg_Prop_AOACFibreg_fg_21 ~ "Reduced fat spread",
        Avg_Prop_AOACFibreg_fg_22 ~ "Bacon and ham",
        Avg_Prop_AOACFibreg_fg_23 ~ "Beef, veal and dishes",
        Avg_Prop_AOACFibreg_fg_24 ~ "Lamb and dishes",
        Avg_Prop_AOACFibreg_fg_25 ~ "Pork and dishes",
        Avg_Prop_AOACFibreg_fg_26 ~ "Coated chicken and turkey manufactured",
        Avg_Prop_AOACFibreg_fg_27 ~ "Chicken and turkey dishes",
        Avg_Prop_AOACFibreg_fg_28 ~ "Liver, products and dishes",
        Avg_Prop_AOACFibreg_fg_29 ~ "Burgers and kebabs",
        Avg_Prop_AOACFibreg_fg_30 ~ "Sausages",
        Avg_Prop_AOACFibreg_fg_31 ~ "Meat pies and pastries",
        Avg_Prop_AOACFibreg_fg_32 ~ "Other meat and meat products",
        Avg_Prop_AOACFibreg_fg_33 ~ "White fish coated or fried",
        Avg_Prop_AOACFibreg_fg_34 ~ "Other white fish, shellfish and fish dishes",
        Avg_Prop_AOACFibreg_fg_35 ~ "Oily fish",
        Avg_Prop_AOACFibreg_fg_36 ~ "Salad and other raw vegetables",
        Avg_Prop_AOACFibreg_fg_37 ~ "Vegetables (not raw)",
        Avg_Prop_AOACFibreg_fg_38 ~ "Chips, fried and roast potatoes and potato products",
        Avg_Prop_AOACFibreg_fg_39 ~ "Other potatoes, potato salads and dishes",
        Avg_Prop_AOACFibreg_fg_40 ~ "Fruit",
        Avg_Prop_AOACFibreg_fg_41 ~ "Sugars, preserves and sweet spreads",
        Avg_Prop_AOACFibreg_fg_42 ~ "Crisps and savoury snacks",
        Avg_Prop_AOACFibreg_fg_43 ~ "Sugar confectionery",
        Avg_Prop_AOACFibreg_fg_44 ~ "Chocolate confectionery",
        Avg_Prop_AOACFibreg_fg_45 ~ "Fruit juice",
        Avg_Prop_AOACFibreg_fg_47 ~ "Spirits and liqueurs",
        Avg_Prop_AOACFibreg_fg_48 ~ "Wine",
        Avg_Prop_AOACFibreg_fg_49 ~ "Beer lager cider and perry",
        Avg_Prop_AOACFibreg_fg_50 ~ "Miscellaneous",
        Avg_Prop_AOACFibreg_fg_51 ~ "Tea, coffee and water",
        Avg_Prop_AOACFibreg_fg_52 ~ "Commercial toddlers foods and drinks",
        Avg_Prop_AOACFibreg_fg_53 ~ "Ice cream",
        Avg_Prop_AOACFibreg_fg_54 ~ "Dietary supplements",
        Avg_Prop_AOACFibreg_fg_55 ~ "Artificial sweeteners",
        Avg_Prop_AOACFibreg_fg_56 ~ "Nuts and seeds",
        Avg_Prop_AOACFibreg_fg_57 ~ "Soft drinks, not diet",
        Avg_Prop_AOACFibreg_fg_58 ~ "Soft drinks, diet",
        Avg_Prop_AOACFibreg_fg_59 ~ "Brown, granary and wheatgerm bread",
        Avg_Prop_AOACFibreg_fg_60 ~ "1% Milk",
        Avg_Prop_AOACFibreg_fg_62 ~ "Sandwiches",
        Avg_Prop_AOACFibreg_fg_63 ~ "Other milk and cream DF",                         
        Avg_Prop_AOACFibreg_fg_64 ~ "Cheese DF",
        Avg_Prop_AOACFibreg_fg_65 ~ "Yogurt, fromage frais and other dairy desserts DF",
        Avg_Prop_AOACFibreg_fg_66 ~ "Ice cream DF"),
  statistic = list(all_continuous() ~ 
                                       "{mean}"),
  missing = "no",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_Prop_AOACFibreg_fg_1:Avg_Prop_AOACFibreg_fg_66)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.fibre.fg

```

##Vitamin A
```{r}
# Mean portions
table.VitA.fg <- tbl_svysummary(
  svy.df.intake24_part_ndns_fg,
  by = age_sex_cat,
  label = c(Avg_Prop_VitaminAug_fg_1 ~ "Pasta, rice and other miscellaneous cereals",
        Avg_Prop_VitaminAug_fg_2 ~ "White bread",
        Avg_Prop_VitaminAug_fg_3 ~ "Wholemeal bread",
        Avg_Prop_VitaminAug_fg_4 ~ "Other breads",
        Avg_Prop_VitaminAug_fg_5 ~ "High fibre breakfast cereals",
        Avg_Prop_VitaminAug_fg_6 ~ "Other breakfast cereals",
        Avg_Prop_VitaminAug_fg_7 ~ "Biscuits",
        Avg_Prop_VitaminAug_fg_8 ~ "Buns, cakes, pastries and fruit pies",
        Avg_Prop_VitaminAug_fg_9 ~ "Puddings",
        Avg_Prop_VitaminAug_fg_10 ~ "Whole milk",
        Avg_Prop_VitaminAug_fg_11 ~ "Semi-skimmed milk",
        Avg_Prop_VitaminAug_fg_12 ~ "Skimmed milk",
        Avg_Prop_VitaminAug_fg_13 ~ "Other milk and cream",
        Avg_Prop_VitaminAug_fg_14 ~ "Cheese",
        Avg_Prop_VitaminAug_fg_15 ~ "Yogurt, fromage frais and other dairy desserts",
        Avg_Prop_VitaminAug_fg_16 ~ "Eggs and egg dishes",
        Avg_Prop_VitaminAug_fg_17 ~ "Butter",
        Avg_Prop_VitaminAug_fg_18 ~ "Polyunsaturated margarine and oils",
        Avg_Prop_VitaminAug_fg_19 ~ "Low fat spread",
        Avg_Prop_VitaminAug_fg_20 ~ "Margarine and other cooking fats and oils NOT polyunsaturated",
        Avg_Prop_VitaminAug_fg_21 ~ "Reduced fat spread",
        Avg_Prop_VitaminAug_fg_22 ~ "Bacon and ham",
        Avg_Prop_VitaminAug_fg_23 ~ "Beef, veal and dishes",
        Avg_Prop_VitaminAug_fg_24 ~ "Lamb and dishes",
        Avg_Prop_VitaminAug_fg_25 ~ "Pork and dishes",
        Avg_Prop_VitaminAug_fg_26 ~ "Coated chicken and turkey manufactured",
        Avg_Prop_VitaminAug_fg_27 ~ "Chicken and turkey dishes",
        Avg_Prop_VitaminAug_fg_28 ~ "Liver, products and dishes",
        Avg_Prop_VitaminAug_fg_29 ~ "Burgers and kebabs",
        Avg_Prop_VitaminAug_fg_30 ~ "Sausages",
        Avg_Prop_VitaminAug_fg_31 ~ "Meat pies and pastries",
        Avg_Prop_VitaminAug_fg_32 ~ "Other meat and meat products",
        Avg_Prop_VitaminAug_fg_33 ~ "White fish coated or fried",
        Avg_Prop_VitaminAug_fg_34 ~ "Other white fish, shellfish and fish dishes",
        Avg_Prop_VitaminAug_fg_35 ~ "Oily fish",
        Avg_Prop_VitaminAug_fg_36 ~ "Salad and other raw vegetables",
        Avg_Prop_VitaminAug_fg_37 ~ "Vegetables (not raw)",
        Avg_Prop_VitaminAug_fg_38 ~ "Chips, fried and roast potatoes and potato products",
        Avg_Prop_VitaminAug_fg_39 ~ "Other potatoes, potato salads and dishes",
        Avg_Prop_VitaminAug_fg_40 ~ "Fruit",
        Avg_Prop_VitaminAug_fg_41 ~ "Sugars, preserves and sweet spreads",
        Avg_Prop_VitaminAug_fg_42 ~ "Crisps and savoury snacks",
        Avg_Prop_VitaminAug_fg_43 ~ "Sugar confectionery",
        Avg_Prop_VitaminAug_fg_44 ~ "Chocolate confectionery",
        Avg_Prop_VitaminAug_fg_45 ~ "Fruit juice",
        Avg_Prop_VitaminAug_fg_47 ~ "Spirits and liqueurs",
        Avg_Prop_VitaminAug_fg_48 ~ "Wine",
        Avg_Prop_VitaminAug_fg_49 ~ "Beer lager cider and perry",
        Avg_Prop_VitaminAug_fg_50 ~ "Miscellaneous",
        Avg_Prop_VitaminAug_fg_51 ~ "Tea, coffee and water",
        Avg_Prop_VitaminAug_fg_52 ~ "Commercial toddlers foods and drinks",
        Avg_Prop_VitaminAug_fg_53 ~ "Ice cream",
        Avg_Prop_VitaminAug_fg_54 ~ "Dietary supplements",
        Avg_Prop_VitaminAug_fg_55 ~ "Artificial sweeteners",
        Avg_Prop_VitaminAug_fg_56 ~ "Nuts and seeds",
        Avg_Prop_VitaminAug_fg_57 ~ "Soft drinks, not diet",
        Avg_Prop_VitaminAug_fg_58 ~ "Soft drinks, diet",
        Avg_Prop_VitaminAug_fg_59 ~ "Brown, granary and wheatgerm bread",
        Avg_Prop_VitaminAug_fg_60 ~ "1% Milk",
        Avg_Prop_VitaminAug_fg_62 ~ "Sandwiches",
        Avg_Prop_VitaminAug_fg_63 ~ "Other milk and cream DF",                         
        Avg_Prop_VitaminAug_fg_64 ~ "Cheese DF",
        Avg_Prop_VitaminAug_fg_65 ~ "Yogurt, fromage frais and other dairy desserts DF",
        Avg_Prop_VitaminAug_fg_66 ~ "Ice cream DF"),
  statistic = list(all_continuous() ~ 
                                       "{mean}"),
  missing = "no",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_Prop_VitaminAug_fg_1:Avg_Prop_VitaminAug_fg_66)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.VitA.fg

```

##Riboflavin
```{r}
# Mean portions
table.riboflavin.fg <- tbl_svysummary(
  svy.df.intake24_part_ndns_fg,
  by = age_sex_cat,
  label = c(Avg_Prop_Riboflavinmg_fg_1 ~ "Pasta, rice and other miscellaneous cereals",
        Avg_Prop_Riboflavinmg_fg_2 ~ "White bread",
        Avg_Prop_Riboflavinmg_fg_3 ~ "Wholemeal bread",
        Avg_Prop_Riboflavinmg_fg_4 ~ "Other breads",
        Avg_Prop_Riboflavinmg_fg_5 ~ "High fibre breakfast cereals",
        Avg_Prop_Riboflavinmg_fg_6 ~ "Other breakfast cereals",
        Avg_Prop_Riboflavinmg_fg_7 ~ "Biscuits",
        Avg_Prop_Riboflavinmg_fg_8 ~ "Buns, cakes, pastries and fruit pies",
        Avg_Prop_Riboflavinmg_fg_9 ~ "Puddings",
        Avg_Prop_Riboflavinmg_fg_10 ~ "Whole milk",
        Avg_Prop_Riboflavinmg_fg_11 ~ "Semi-skimmed milk",
        Avg_Prop_Riboflavinmg_fg_12 ~ "Skimmed milk",
        Avg_Prop_Riboflavinmg_fg_13 ~ "Other milk and cream",
        Avg_Prop_Riboflavinmg_fg_14 ~ "Cheese",
        Avg_Prop_Riboflavinmg_fg_15 ~ "Yogurt, fromage frais and other dairy desserts",
        Avg_Prop_Riboflavinmg_fg_16 ~ "Eggs and egg dishes",
        Avg_Prop_Riboflavinmg_fg_17 ~ "Butter",
        Avg_Prop_Riboflavinmg_fg_18 ~ "Polyunsaturated margarine and oils",
        Avg_Prop_Riboflavinmg_fg_19 ~ "Low fat spread",
        Avg_Prop_Riboflavinmg_fg_20 ~ "Margarine and other cooking fats and oils NOT polyunsaturated",
        Avg_Prop_Riboflavinmg_fg_21 ~ "Reduced fat spread",
        Avg_Prop_Riboflavinmg_fg_22 ~ "Bacon and ham",
        Avg_Prop_Riboflavinmg_fg_23 ~ "Beef, veal and dishes",
        Avg_Prop_Riboflavinmg_fg_24 ~ "Lamb and dishes",
        Avg_Prop_Riboflavinmg_fg_25 ~ "Pork and dishes",
        Avg_Prop_Riboflavinmg_fg_26 ~ "Coated chicken and turkey manufactured",
        Avg_Prop_Riboflavinmg_fg_27 ~ "Chicken and turkey dishes",
        Avg_Prop_Riboflavinmg_fg_28 ~ "Liver, products and dishes",
        Avg_Prop_Riboflavinmg_fg_29 ~ "Burgers and kebabs",
        Avg_Prop_Riboflavinmg_fg_30 ~ "Sausages",
        Avg_Prop_Riboflavinmg_fg_31 ~ "Meat pies and pastries",
        Avg_Prop_Riboflavinmg_fg_32 ~ "Other meat and meat products",
        Avg_Prop_Riboflavinmg_fg_33 ~ "White fish coated or fried",
        Avg_Prop_Riboflavinmg_fg_34 ~ "Other white fish, shellfish and fish dishes",
        Avg_Prop_Riboflavinmg_fg_35 ~ "Oily fish",
        Avg_Prop_Riboflavinmg_fg_36 ~ "Salad and other raw vegetables",
        Avg_Prop_Riboflavinmg_fg_37 ~ "Vegetables (not raw)",
        Avg_Prop_Riboflavinmg_fg_38 ~ "Chips, fried and roast potatoes and potato products",
        Avg_Prop_Riboflavinmg_fg_39 ~ "Other potatoes, potato salads and dishes",
        Avg_Prop_Riboflavinmg_fg_40 ~ "Fruit",
        Avg_Prop_Riboflavinmg_fg_41 ~ "Sugars, preserves and sweet spreads",
        Avg_Prop_Riboflavinmg_fg_42 ~ "Crisps and savoury snacks",
        Avg_Prop_Riboflavinmg_fg_43 ~ "Sugar confectionery",
        Avg_Prop_Riboflavinmg_fg_44 ~ "Chocolate confectionery",
        Avg_Prop_Riboflavinmg_fg_45 ~ "Fruit juice",
        Avg_Prop_Riboflavinmg_fg_47 ~ "Spirits and liqueurs",
        Avg_Prop_Riboflavinmg_fg_48 ~ "Wine",
        Avg_Prop_Riboflavinmg_fg_49 ~ "Beer lager cider and perry",
        Avg_Prop_Riboflavinmg_fg_50 ~ "Miscellaneous",
        Avg_Prop_Riboflavinmg_fg_51 ~ "Tea, coffee and water",
        Avg_Prop_Riboflavinmg_fg_52 ~ "Commercial toddlers foods and drinks",
        Avg_Prop_Riboflavinmg_fg_53 ~ "Ice cream",
        Avg_Prop_Riboflavinmg_fg_54 ~ "Dietary supplements",
        Avg_Prop_Riboflavinmg_fg_55 ~ "Artificial sweeteners",
        Avg_Prop_Riboflavinmg_fg_56 ~ "Nuts and seeds",
        Avg_Prop_Riboflavinmg_fg_57 ~ "Soft drinks, not diet",
        Avg_Prop_Riboflavinmg_fg_58 ~ "Soft drinks, diet",
        Avg_Prop_Riboflavinmg_fg_59 ~ "Brown, granary and wheatgerm bread",
        Avg_Prop_Riboflavinmg_fg_60 ~ "1% Milk",
        Avg_Prop_Riboflavinmg_fg_62 ~ "Sandwiches",
        Avg_Prop_Riboflavinmg_fg_63 ~ "Other milk and cream DF",                         
        Avg_Prop_Riboflavinmg_fg_64 ~ "Cheese DF",
        Avg_Prop_Riboflavinmg_fg_65 ~ "Yogurt, fromage frais and other dairy desserts DF",
        Avg_Prop_Riboflavinmg_fg_66 ~ "Ice cream DF"),
  statistic = list(all_continuous() ~ 
                                       "{mean}"),
  missing = "no",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_Prop_Riboflavinmg_fg_1:Avg_Prop_Riboflavinmg_fg_66)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.riboflavin.fg

```


##Folate
```{r}
# Mean portions
table.folate.fg <- tbl_svysummary(
  svy.df.intake24_part_ndns_fg,
  by = age_sex_cat,
  label = c(Avg_Prop_Folateug_fg_1 ~ "Pasta, rice and other miscellaneous cereals",
        Avg_Prop_Folateug_fg_2 ~ "White bread",
        Avg_Prop_Folateug_fg_3 ~ "Wholemeal bread",
        Avg_Prop_Folateug_fg_4 ~ "Other breads",
        Avg_Prop_Folateug_fg_5 ~ "High fibre breakfast cereals",
        Avg_Prop_Folateug_fg_6 ~ "Other breakfast cereals",
        Avg_Prop_Folateug_fg_7 ~ "Biscuits",
        Avg_Prop_Folateug_fg_8 ~ "Buns, cakes, pastries and fruit pies",
        Avg_Prop_Folateug_fg_9 ~ "Puddings",
        Avg_Prop_Folateug_fg_10 ~ "Whole milk",
        Avg_Prop_Folateug_fg_11 ~ "Semi-skimmed milk",
        Avg_Prop_Folateug_fg_12 ~ "Skimmed milk",
        Avg_Prop_Folateug_fg_13 ~ "Other milk and cream",
        Avg_Prop_Folateug_fg_14 ~ "Cheese",
        Avg_Prop_Folateug_fg_15 ~ "Yogurt, fromage frais and other dairy desserts",
        Avg_Prop_Folateug_fg_16 ~ "Eggs and egg dishes",
        Avg_Prop_Folateug_fg_17 ~ "Butter",
        Avg_Prop_Folateug_fg_18 ~ "Polyunsaturated margarine and oils",
        Avg_Prop_Folateug_fg_19 ~ "Low fat spread",
        Avg_Prop_Folateug_fg_20 ~ "Margarine and other cooking fats and oils NOT polyunsaturated",
        Avg_Prop_Folateug_fg_21 ~ "Reduced fat spread",
        Avg_Prop_Folateug_fg_22 ~ "Bacon and ham",
        Avg_Prop_Folateug_fg_23 ~ "Beef, veal and dishes",
        Avg_Prop_Folateug_fg_24 ~ "Lamb and dishes",
        Avg_Prop_Folateug_fg_25 ~ "Pork and dishes",
        Avg_Prop_Folateug_fg_26 ~ "Coated chicken and turkey manufactured",
        Avg_Prop_Folateug_fg_27 ~ "Chicken and turkey dishes",
        Avg_Prop_Folateug_fg_28 ~ "Liver, products and dishes",
        Avg_Prop_Folateug_fg_29 ~ "Burgers and kebabs",
        Avg_Prop_Folateug_fg_30 ~ "Sausages",
        Avg_Prop_Folateug_fg_31 ~ "Meat pies and pastries",
        Avg_Prop_Folateug_fg_32 ~ "Other meat and meat products",
        Avg_Prop_Folateug_fg_33 ~ "White fish coated or fried",
        Avg_Prop_Folateug_fg_34 ~ "Other white fish, shellfish and fish dishes",
        Avg_Prop_Folateug_fg_35 ~ "Oily fish",
        Avg_Prop_Folateug_fg_36 ~ "Salad and other raw vegetables",
        Avg_Prop_Folateug_fg_37 ~ "Vegetables (not raw)",
        Avg_Prop_Folateug_fg_38 ~ "Chips, fried and roast potatoes and potato products",
        Avg_Prop_Folateug_fg_39 ~ "Other potatoes, potato salads and dishes",
        Avg_Prop_Folateug_fg_40 ~ "Fruit",
        Avg_Prop_Folateug_fg_41 ~ "Sugars, preserves and sweet spreads",
        Avg_Prop_Folateug_fg_42 ~ "Crisps and savoury snacks",
        Avg_Prop_Folateug_fg_43 ~ "Sugar confectionery",
        Avg_Prop_Folateug_fg_44 ~ "Chocolate confectionery",
        Avg_Prop_Folateug_fg_45 ~ "Fruit juice",
        Avg_Prop_Folateug_fg_47 ~ "Spirits and liqueurs",
        Avg_Prop_Folateug_fg_48 ~ "Wine",
        Avg_Prop_Folateug_fg_49 ~ "Beer lager cider and perry",
        Avg_Prop_Folateug_fg_50 ~ "Miscellaneous",
        Avg_Prop_Folateug_fg_51 ~ "Tea, coffee and water",
        Avg_Prop_Folateug_fg_52 ~ "Commercial toddlers foods and drinks",
        Avg_Prop_Folateug_fg_53 ~ "Ice cream",
        Avg_Prop_Folateug_fg_54 ~ "Dietary supplements",
        Avg_Prop_Folateug_fg_55 ~ "Artificial sweeteners",
        Avg_Prop_Folateug_fg_56 ~ "Nuts and seeds",
        Avg_Prop_Folateug_fg_57 ~ "Soft drinks, not diet",
        Avg_Prop_Folateug_fg_58 ~ "Soft drinks, diet",
        Avg_Prop_Folateug_fg_59 ~ "Brown, granary and wheatgerm bread",
        Avg_Prop_Folateug_fg_60 ~ "1% Milk",
        Avg_Prop_Folateug_fg_62 ~ "Sandwiches",
        Avg_Prop_Folateug_fg_63 ~ "Other milk and cream DF",                         
        Avg_Prop_Folateug_fg_64 ~ "Cheese DF",
        Avg_Prop_Folateug_fg_65 ~ "Yogurt, fromage frais and other dairy desserts DF",
        Avg_Prop_Folateug_fg_66 ~ "Ice cream DF"),
  statistic = list(all_continuous() ~ 
                                       "{mean}"),
  missing = "no",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_Prop_Folateug_fg_1:Avg_Prop_Folateug_fg_66)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.folate.fg

```

##Vitamin D
```{r}
# Mean portions
table.VitD.fg <- tbl_svysummary(
  svy.df.intake24_part_ndns_fg,
  by = age_sex_cat,
  label = c(Avg_Prop_VitaminDug_fg_1 ~ "Pasta, rice and other miscellaneous cereals",
        Avg_Prop_VitaminDug_fg_2 ~ "White bread",
        Avg_Prop_VitaminDug_fg_3 ~ "Wholemeal bread",
        Avg_Prop_VitaminDug_fg_4 ~ "Other breads",
        Avg_Prop_VitaminDug_fg_5 ~ "High fibre breakfast cereals",
        Avg_Prop_VitaminDug_fg_6 ~ "Other breakfast cereals",
        Avg_Prop_VitaminDug_fg_7 ~ "Biscuits",
        Avg_Prop_VitaminDug_fg_8 ~ "Buns, cakes, pastries and fruit pies",
        Avg_Prop_VitaminDug_fg_9 ~ "Puddings",
        Avg_Prop_VitaminDug_fg_10 ~ "Whole milk",
        Avg_Prop_VitaminDug_fg_11 ~ "Semi-skimmed milk",
        Avg_Prop_VitaminDug_fg_12 ~ "Skimmed milk",
        Avg_Prop_VitaminDug_fg_13 ~ "Other milk and cream",
        Avg_Prop_VitaminDug_fg_14 ~ "Cheese",
        Avg_Prop_VitaminDug_fg_15 ~ "Yogurt, fromage frais and other dairy desserts",
        Avg_Prop_VitaminDug_fg_16 ~ "Eggs and egg dishes",
        Avg_Prop_VitaminDug_fg_17 ~ "Butter",
        Avg_Prop_VitaminDug_fg_18 ~ "Polyunsaturated margarine and oils",
        Avg_Prop_VitaminDug_fg_19 ~ "Low fat spread",
        Avg_Prop_VitaminDug_fg_20 ~ "Margarine and other cooking fats and oils NOT polyunsaturated",
        Avg_Prop_VitaminDug_fg_21 ~ "Reduced fat spread",
        Avg_Prop_VitaminDug_fg_22 ~ "Bacon and ham",
        Avg_Prop_VitaminDug_fg_23 ~ "Beef, veal and dishes",
        Avg_Prop_VitaminDug_fg_24 ~ "Lamb and dishes",
        Avg_Prop_VitaminDug_fg_25 ~ "Pork and dishes",
        Avg_Prop_VitaminDug_fg_26 ~ "Coated chicken and turkey manufactured",
        Avg_Prop_VitaminDug_fg_27 ~ "Chicken and turkey dishes",
        Avg_Prop_VitaminDug_fg_28 ~ "Liver, products and dishes",
        Avg_Prop_VitaminDug_fg_29 ~ "Burgers and kebabs",
        Avg_Prop_VitaminDug_fg_30 ~ "Sausages",
        Avg_Prop_VitaminDug_fg_31 ~ "Meat pies and pastries",
        Avg_Prop_VitaminDug_fg_32 ~ "Other meat and meat products",
        Avg_Prop_VitaminDug_fg_33 ~ "White fish coated or fried",
        Avg_Prop_VitaminDug_fg_34 ~ "Other white fish, shellfish and fish dishes",
        Avg_Prop_VitaminDug_fg_35 ~ "Oily fish",
        Avg_Prop_VitaminDug_fg_36 ~ "Salad and other raw vegetables",
        Avg_Prop_VitaminDug_fg_37 ~ "Vegetables (not raw)",
        Avg_Prop_VitaminDug_fg_38 ~ "Chips, fried and roast potatoes and potato products",
        Avg_Prop_VitaminDug_fg_39 ~ "Other potatoes, potato salads and dishes",
        Avg_Prop_VitaminDug_fg_40 ~ "Fruit",
        Avg_Prop_VitaminDug_fg_41 ~ "Sugars, preserves and sweet spreads",
        Avg_Prop_VitaminDug_fg_42 ~ "Crisps and savoury snacks",
        Avg_Prop_VitaminDug_fg_43 ~ "Sugar confectionery",
        Avg_Prop_VitaminDug_fg_44 ~ "Chocolate confectionery",
        Avg_Prop_VitaminDug_fg_45 ~ "Fruit juice",
        Avg_Prop_VitaminDug_fg_47 ~ "Spirits and liqueurs",
        Avg_Prop_VitaminDug_fg_48 ~ "Wine",
        Avg_Prop_VitaminDug_fg_49 ~ "Beer lager cider and perry",
        Avg_Prop_VitaminDug_fg_50 ~ "Miscellaneous",
        Avg_Prop_VitaminDug_fg_51 ~ "Tea, coffee and water",
        Avg_Prop_VitaminDug_fg_52 ~ "Commercial toddlers foods and drinks",
        Avg_Prop_VitaminDug_fg_53 ~ "Ice cream",
        Avg_Prop_VitaminDug_fg_54 ~ "Dietary supplements",
        Avg_Prop_VitaminDug_fg_55 ~ "Artificial sweeteners",
        Avg_Prop_VitaminDug_fg_56 ~ "Nuts and seeds",
        Avg_Prop_VitaminDug_fg_57 ~ "Soft drinks, not diet",
        Avg_Prop_VitaminDug_fg_58 ~ "Soft drinks, diet",
        Avg_Prop_VitaminDug_fg_59 ~ "Brown, granary and wheatgerm bread",
        Avg_Prop_VitaminDug_fg_60 ~ "1% Milk",
        Avg_Prop_VitaminDug_fg_62 ~ "Sandwiches",
        Avg_Prop_VitaminDug_fg_63 ~ "Other milk and cream DF",                         
        Avg_Prop_VitaminDug_fg_64 ~ "Cheese DF",
        Avg_Prop_VitaminDug_fg_65 ~ "Yogurt, fromage frais and other dairy desserts DF",
        Avg_Prop_VitaminDug_fg_66 ~ "Ice cream DF"),
  statistic = list(all_continuous() ~ 
                                       "{mean}"),
  missing = "no",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_Prop_VitaminDug_fg_1:Avg_Prop_VitaminDug_fg_66)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.VitD.fg

```


##Vitamin B12
```{r}
# Mean portions
table.VitB12.fg <- tbl_svysummary(
  svy.df.intake24_part_ndns_fg,
  by = age_sex_cat,
  label = c(Avg_Prop_VitaminB12ug_fg_1 ~ "Pasta, rice and other miscellaneous cereals",
        Avg_Prop_VitaminB12ug_fg_2 ~ "White bread",
        Avg_Prop_VitaminB12ug_fg_3 ~ "Wholemeal bread",
        Avg_Prop_VitaminB12ug_fg_4 ~ "Other breads",
        Avg_Prop_VitaminB12ug_fg_5 ~ "High fibre breakfast cereals",
        Avg_Prop_VitaminB12ug_fg_6 ~ "Other breakfast cereals",
        Avg_Prop_VitaminB12ug_fg_7 ~ "Biscuits",
        Avg_Prop_VitaminB12ug_fg_8 ~ "Buns, cakes, pastries and fruit pies",
        Avg_Prop_VitaminB12ug_fg_9 ~ "Puddings",
        Avg_Prop_VitaminB12ug_fg_10 ~ "Whole milk",
        Avg_Prop_VitaminB12ug_fg_11 ~ "Semi-skimmed milk",
        Avg_Prop_VitaminB12ug_fg_12 ~ "Skimmed milk",
        Avg_Prop_VitaminB12ug_fg_13 ~ "Other milk and cream",
        Avg_Prop_VitaminB12ug_fg_14 ~ "Cheese",
        Avg_Prop_VitaminB12ug_fg_15 ~ "Yogurt, fromage frais and other dairy desserts",
        Avg_Prop_VitaminB12ug_fg_16 ~ "Eggs and egg dishes",
        Avg_Prop_VitaminB12ug_fg_17 ~ "Butter",
        Avg_Prop_VitaminB12ug_fg_18 ~ "Polyunsaturated margarine and oils",
        Avg_Prop_VitaminB12ug_fg_19 ~ "Low fat spread",
        Avg_Prop_VitaminB12ug_fg_20 ~ "Margarine and other cooking fats and oils NOT polyunsaturated",
        Avg_Prop_VitaminB12ug_fg_21 ~ "Reduced fat spread",
        Avg_Prop_VitaminB12ug_fg_22 ~ "Bacon and ham",
        Avg_Prop_VitaminB12ug_fg_23 ~ "Beef, veal and dishes",
        Avg_Prop_VitaminB12ug_fg_24 ~ "Lamb and dishes",
        Avg_Prop_VitaminB12ug_fg_25 ~ "Pork and dishes",
        Avg_Prop_VitaminB12ug_fg_26 ~ "Coated chicken and turkey manufactured",
        Avg_Prop_VitaminB12ug_fg_27 ~ "Chicken and turkey dishes",
        Avg_Prop_VitaminB12ug_fg_28 ~ "Liver, products and dishes",
        Avg_Prop_VitaminB12ug_fg_29 ~ "Burgers and kebabs",
        Avg_Prop_VitaminB12ug_fg_30 ~ "Sausages",
        Avg_Prop_VitaminB12ug_fg_31 ~ "Meat pies and pastries",
        Avg_Prop_VitaminB12ug_fg_32 ~ "Other meat and meat products",
        Avg_Prop_VitaminB12ug_fg_33 ~ "White fish coated or fried",
        Avg_Prop_VitaminB12ug_fg_34 ~ "Other white fish, shellfish and fish dishes",
        Avg_Prop_VitaminB12ug_fg_35 ~ "Oily fish",
        Avg_Prop_VitaminB12ug_fg_36 ~ "Salad and other raw vegetables",
        Avg_Prop_VitaminB12ug_fg_37 ~ "Vegetables (not raw)",
        Avg_Prop_VitaminB12ug_fg_38 ~ "Chips, fried and roast potatoes and potato products",
        Avg_Prop_VitaminB12ug_fg_39 ~ "Other potatoes, potato salads and dishes",
        Avg_Prop_VitaminB12ug_fg_40 ~ "Fruit",
        Avg_Prop_VitaminB12ug_fg_41 ~ "Sugars, preserves and sweet spreads",
        Avg_Prop_VitaminB12ug_fg_42 ~ "Crisps and savoury snacks",
        Avg_Prop_VitaminB12ug_fg_43 ~ "Sugar confectionery",
        Avg_Prop_VitaminB12ug_fg_44 ~ "Chocolate confectionery",
        Avg_Prop_VitaminB12ug_fg_45 ~ "Fruit juice",
        Avg_Prop_VitaminB12ug_fg_47 ~ "Spirits and liqueurs",
        Avg_Prop_VitaminB12ug_fg_48 ~ "Wine",
        Avg_Prop_VitaminB12ug_fg_49 ~ "Beer lager cider and perry",
        Avg_Prop_VitaminB12ug_fg_50 ~ "Miscellaneous",
        Avg_Prop_VitaminB12ug_fg_51 ~ "Tea, coffee and water",
        Avg_Prop_VitaminB12ug_fg_52 ~ "Commercial toddlers foods and drinks",
        Avg_Prop_VitaminB12ug_fg_53 ~ "Ice cream",
        Avg_Prop_VitaminB12ug_fg_54 ~ "Dietary supplements",
        Avg_Prop_VitaminB12ug_fg_55 ~ "Artificial sweeteners",
        Avg_Prop_VitaminB12ug_fg_56 ~ "Nuts and seeds",
        Avg_Prop_VitaminB12ug_fg_57 ~ "Soft drinks, not diet",
        Avg_Prop_VitaminB12ug_fg_58 ~ "Soft drinks, diet",
        Avg_Prop_VitaminB12ug_fg_59 ~ "Brown, granary and wheatgerm bread",
        Avg_Prop_VitaminB12ug_fg_60 ~ "1% Milk",
        Avg_Prop_VitaminB12ug_fg_62 ~ "Sandwiches",
        Avg_Prop_VitaminB12ug_fg_63 ~ "Other milk and cream DF",                         
        Avg_Prop_VitaminB12ug_fg_64 ~ "Cheese DF",
        Avg_Prop_VitaminB12ug_fg_65 ~ "Yogurt, fromage frais and other dairy desserts DF",
        Avg_Prop_VitaminB12ug_fg_66 ~ "Ice cream DF"),
  statistic = list(all_continuous() ~ 
                                       "{mean}"),
  missing = "no",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_Prop_VitaminB12ug_fg_1:Avg_Prop_VitaminB12ug_fg_66)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.VitB12.fg

```


##Vitamin C
```{r}
# Mean portions
table.VitC.fg <- tbl_svysummary(
  svy.df.intake24_part_ndns_fg,
  by = age_sex_cat,
  label = c(Avg_Prop_VitaminCmg_fg_1 ~ "Pasta, rice and other miscellaneous cereals",
        Avg_Prop_VitaminCmg_fg_2 ~ "White bread",
        Avg_Prop_VitaminCmg_fg_3 ~ "Wholemeal bread",
        Avg_Prop_VitaminCmg_fg_4 ~ "Other breads",
        Avg_Prop_VitaminCmg_fg_5 ~ "High fibre breakfast cereals",
        Avg_Prop_VitaminCmg_fg_6 ~ "Other breakfast cereals",
        Avg_Prop_VitaminCmg_fg_7 ~ "Biscuits",
        Avg_Prop_VitaminCmg_fg_8 ~ "Buns, cakes, pastries and fruit pies",
        Avg_Prop_VitaminCmg_fg_9 ~ "Puddings",
        Avg_Prop_VitaminCmg_fg_10 ~ "Whole milk",
        Avg_Prop_VitaminCmg_fg_11 ~ "Semi-skimmed milk",
        Avg_Prop_VitaminCmg_fg_12 ~ "Skimmed milk",
        Avg_Prop_VitaminCmg_fg_13 ~ "Other milk and cream",
        Avg_Prop_VitaminCmg_fg_14 ~ "Cheese",
        Avg_Prop_VitaminCmg_fg_15 ~ "Yogurt, fromage frais and other dairy desserts",
        Avg_Prop_VitaminCmg_fg_16 ~ "Eggs and egg dishes",
        Avg_Prop_VitaminCmg_fg_17 ~ "Butter",
        Avg_Prop_VitaminCmg_fg_18 ~ "Polyunsaturated margarine and oils",
        Avg_Prop_VitaminCmg_fg_19 ~ "Low fat spread",
        Avg_Prop_VitaminCmg_fg_20 ~ "Margarine and other cooking fats and oils NOT polyunsaturated",
        Avg_Prop_VitaminCmg_fg_21 ~ "Reduced fat spread",
        Avg_Prop_VitaminCmg_fg_22 ~ "Bacon and ham",
        Avg_Prop_VitaminCmg_fg_23 ~ "Beef, veal and dishes",
        Avg_Prop_VitaminCmg_fg_24 ~ "Lamb and dishes",
        Avg_Prop_VitaminCmg_fg_25 ~ "Pork and dishes",
        Avg_Prop_VitaminCmg_fg_26 ~ "Coated chicken and turkey manufactured",
        Avg_Prop_VitaminCmg_fg_27 ~ "Chicken and turkey dishes",
        Avg_Prop_VitaminCmg_fg_28 ~ "Liver, products and dishes",
        Avg_Prop_VitaminCmg_fg_29 ~ "Burgers and kebabs",
        Avg_Prop_VitaminCmg_fg_30 ~ "Sausages",
        Avg_Prop_VitaminCmg_fg_31 ~ "Meat pies and pastries",
        Avg_Prop_VitaminCmg_fg_32 ~ "Other meat and meat products",
        Avg_Prop_VitaminCmg_fg_33 ~ "White fish coated or fried",
        Avg_Prop_VitaminCmg_fg_34 ~ "Other white fish, shellfish and fish dishes",
        Avg_Prop_VitaminCmg_fg_35 ~ "Oily fish",
        Avg_Prop_VitaminCmg_fg_36 ~ "Salad and other raw vegetables",
        Avg_Prop_VitaminCmg_fg_37 ~ "Vegetables (not raw)",
        Avg_Prop_VitaminCmg_fg_38 ~ "Chips, fried and roast potatoes and potato products",
        Avg_Prop_VitaminCmg_fg_39 ~ "Other potatoes, potato salads and dishes",
        Avg_Prop_VitaminCmg_fg_40 ~ "Fruit",
        Avg_Prop_VitaminCmg_fg_41 ~ "Sugars, preserves and sweet spreads",
        Avg_Prop_VitaminCmg_fg_42 ~ "Crisps and savoury snacks",
        Avg_Prop_VitaminCmg_fg_43 ~ "Sugar confectionery",
        Avg_Prop_VitaminCmg_fg_44 ~ "Chocolate confectionery",
        Avg_Prop_VitaminCmg_fg_45 ~ "Fruit juice",
        Avg_Prop_VitaminCmg_fg_47 ~ "Spirits and liqueurs",
        Avg_Prop_VitaminCmg_fg_48 ~ "Wine",
        Avg_Prop_VitaminCmg_fg_49 ~ "Beer lager cider and perry",
        Avg_Prop_VitaminCmg_fg_50 ~ "Miscellaneous",
        Avg_Prop_VitaminCmg_fg_51 ~ "Tea, coffee and water",
        Avg_Prop_VitaminCmg_fg_52 ~ "Commercial toddlers foods and drinks",
        Avg_Prop_VitaminCmg_fg_53 ~ "Ice cream",
        Avg_Prop_VitaminCmg_fg_54 ~ "Dietary supplements",
        Avg_Prop_VitaminCmg_fg_55 ~ "Artificial sweeteners",
        Avg_Prop_VitaminCmg_fg_56 ~ "Nuts and seeds",
        Avg_Prop_VitaminCmg_fg_57 ~ "Soft drinks, not diet",
        Avg_Prop_VitaminCmg_fg_58 ~ "Soft drinks, diet",
        Avg_Prop_VitaminCmg_fg_59 ~ "Brown, granary and wheatgerm bread",
        Avg_Prop_VitaminCmg_fg_60 ~ "1% Milk",
        Avg_Prop_VitaminCmg_fg_62 ~ "Sandwiches",
        Avg_Prop_VitaminCmg_fg_63 ~ "Other milk and cream DF",                         
        Avg_Prop_VitaminCmg_fg_64 ~ "Cheese DF",
        Avg_Prop_VitaminCmg_fg_65 ~ "Yogurt, fromage frais and other dairy desserts DF",
        Avg_Prop_VitaminCmg_fg_66 ~ "Ice cream DF"),
  statistic = list(all_continuous() ~ 
                                       "{mean}"),
  missing = "no",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_Prop_VitaminCmg_fg_1:Avg_Prop_VitaminCmg_fg_66)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.VitC.fg

```



##Iron
```{r}
# Mean portions
table.iron.fg <- tbl_svysummary(
  svy.df.intake24_part_ndns_fg,
  by = age_sex_cat,
  label = c(Avg_Prop_Ironmg_fg_1 ~ "Pasta, rice and other miscellaneous cereals",
        Avg_Prop_Ironmg_fg_2 ~ "White bread",
        Avg_Prop_Ironmg_fg_3 ~ "Wholemeal bread",
        Avg_Prop_Ironmg_fg_4 ~ "Other breads",
        Avg_Prop_Ironmg_fg_5 ~ "High fibre breakfast cereals",
        Avg_Prop_Ironmg_fg_6 ~ "Other breakfast cereals",
        Avg_Prop_Ironmg_fg_7 ~ "Biscuits",
        Avg_Prop_Ironmg_fg_8 ~ "Buns, cakes, pastries and fruit pies",
        Avg_Prop_Ironmg_fg_9 ~ "Puddings",
        Avg_Prop_Ironmg_fg_10 ~ "Whole milk",
        Avg_Prop_Ironmg_fg_11 ~ "Semi-skimmed milk",
        Avg_Prop_Ironmg_fg_12 ~ "Skimmed milk",
        Avg_Prop_Ironmg_fg_13 ~ "Other milk and cream",
        Avg_Prop_Ironmg_fg_14 ~ "Cheese",
        Avg_Prop_Ironmg_fg_15 ~ "Yogurt, fromage frais and other dairy desserts",
        Avg_Prop_Ironmg_fg_16 ~ "Eggs and egg dishes",
        Avg_Prop_Ironmg_fg_17 ~ "Butter",
        Avg_Prop_Ironmg_fg_18 ~ "Polyunsaturated margarine and oils",
        Avg_Prop_Ironmg_fg_19 ~ "Low fat spread",
        Avg_Prop_Ironmg_fg_20 ~ "Margarine and other cooking fats and oils NOT polyunsaturated",
        Avg_Prop_Ironmg_fg_21 ~ "Reduced fat spread",
        Avg_Prop_Ironmg_fg_22 ~ "Bacon and ham",
        Avg_Prop_Ironmg_fg_23 ~ "Beef, veal and dishes",
        Avg_Prop_Ironmg_fg_24 ~ "Lamb and dishes",
        Avg_Prop_Ironmg_fg_25 ~ "Pork and dishes",
        Avg_Prop_Ironmg_fg_26 ~ "Coated chicken and turkey manufactured",
        Avg_Prop_Ironmg_fg_27 ~ "Chicken and turkey dishes",
        Avg_Prop_Ironmg_fg_28 ~ "Liver, products and dishes",
        Avg_Prop_Ironmg_fg_29 ~ "Burgers and kebabs",
        Avg_Prop_Ironmg_fg_30 ~ "Sausages",
        Avg_Prop_Ironmg_fg_31 ~ "Meat pies and pastries",
        Avg_Prop_Ironmg_fg_32 ~ "Other meat and meat products",
        Avg_Prop_Ironmg_fg_33 ~ "White fish coated or fried",
        Avg_Prop_Ironmg_fg_34 ~ "Other white fish, shellfish and fish dishes",
        Avg_Prop_Ironmg_fg_35 ~ "Oily fish",
        Avg_Prop_Ironmg_fg_36 ~ "Salad and other raw vegetables",
        Avg_Prop_Ironmg_fg_37 ~ "Vegetables (not raw)",
        Avg_Prop_Ironmg_fg_38 ~ "Chips, fried and roast potatoes and potato products",
        Avg_Prop_Ironmg_fg_39 ~ "Other potatoes, potato salads and dishes",
        Avg_Prop_Ironmg_fg_40 ~ "Fruit",
        Avg_Prop_Ironmg_fg_41 ~ "Sugars, preserves and sweet spreads",
        Avg_Prop_Ironmg_fg_42 ~ "Crisps and savoury snacks",
        Avg_Prop_Ironmg_fg_43 ~ "Sugar confectionery",
        Avg_Prop_Ironmg_fg_44 ~ "Chocolate confectionery",
        Avg_Prop_Ironmg_fg_45 ~ "Fruit juice",
        Avg_Prop_Ironmg_fg_47 ~ "Spirits and liqueurs",
        Avg_Prop_Ironmg_fg_48 ~ "Wine",
        Avg_Prop_Ironmg_fg_49 ~ "Beer lager cider and perry",
        Avg_Prop_Ironmg_fg_50 ~ "Miscellaneous",
        Avg_Prop_Ironmg_fg_51 ~ "Tea, coffee and water",
        Avg_Prop_Ironmg_fg_52 ~ "Commercial toddlers foods and drinks",
        Avg_Prop_Ironmg_fg_53 ~ "Ice cream",
        Avg_Prop_Ironmg_fg_54 ~ "Dietary supplements",
        Avg_Prop_Ironmg_fg_55 ~ "Artificial sweeteners",
        Avg_Prop_Ironmg_fg_56 ~ "Nuts and seeds",
        Avg_Prop_Ironmg_fg_57 ~ "Soft drinks, not diet",
        Avg_Prop_Ironmg_fg_58 ~ "Soft drinks, diet",
        Avg_Prop_Ironmg_fg_59 ~ "Brown, granary and wheatgerm bread",
        Avg_Prop_Ironmg_fg_60 ~ "1% Milk",
        Avg_Prop_Ironmg_fg_62 ~ "Sandwiches",
        Avg_Prop_Ironmg_fg_63 ~ "Other milk and cream DF",                         
        Avg_Prop_Ironmg_fg_64 ~ "Cheese DF",
        Avg_Prop_Ironmg_fg_65 ~ "Yogurt, fromage frais and other dairy desserts DF",
        Avg_Prop_Ironmg_fg_66 ~ "Ice cream DF"),
  statistic = list(all_continuous() ~ 
                                       "{mean}"),
  missing = "no",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_Prop_Ironmg_fg_1:Avg_Prop_Ironmg_fg_66)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.iron.fg

```

##Calcium
```{r}
# Mean portions
table.calcium.fg <- tbl_svysummary(
  svy.df.intake24_part_ndns_fg,
  by = age_sex_cat,
  label = c(Avg_Prop_Calciummg_fg_1 ~ "Pasta, rice and other miscellaneous cereals",
        Avg_Prop_Calciummg_fg_2 ~ "White bread",
        Avg_Prop_Calciummg_fg_3 ~ "Wholemeal bread",
        Avg_Prop_Calciummg_fg_4 ~ "Other breads",
        Avg_Prop_Calciummg_fg_5 ~ "High fibre breakfast cereals",
        Avg_Prop_Calciummg_fg_6 ~ "Other breakfast cereals",
        Avg_Prop_Calciummg_fg_7 ~ "Biscuits",
        Avg_Prop_Calciummg_fg_8 ~ "Buns, cakes, pastries and fruit pies",
        Avg_Prop_Calciummg_fg_9 ~ "Puddings",
        Avg_Prop_Calciummg_fg_10 ~ "Whole milk",
        Avg_Prop_Calciummg_fg_11 ~ "Semi-skimmed milk",
        Avg_Prop_Calciummg_fg_12 ~ "Skimmed milk",
        Avg_Prop_Calciummg_fg_13 ~ "Other milk and cream",
        Avg_Prop_Calciummg_fg_14 ~ "Cheese",
        Avg_Prop_Calciummg_fg_15 ~ "Yogurt, fromage frais and other dairy desserts",
        Avg_Prop_Calciummg_fg_16 ~ "Eggs and egg dishes",
        Avg_Prop_Calciummg_fg_17 ~ "Butter",
        Avg_Prop_Calciummg_fg_18 ~ "Polyunsaturated margarine and oils",
        Avg_Prop_Calciummg_fg_19 ~ "Low fat spread",
        Avg_Prop_Calciummg_fg_20 ~ "Margarine and other cooking fats and oils NOT polyunsaturated",
        Avg_Prop_Calciummg_fg_21 ~ "Reduced fat spread",
        Avg_Prop_Calciummg_fg_22 ~ "Bacon and ham",
        Avg_Prop_Calciummg_fg_23 ~ "Beef, veal and dishes",
        Avg_Prop_Calciummg_fg_24 ~ "Lamb and dishes",
        Avg_Prop_Calciummg_fg_25 ~ "Pork and dishes",
        Avg_Prop_Calciummg_fg_26 ~ "Coated chicken and turkey manufactured",
        Avg_Prop_Calciummg_fg_27 ~ "Chicken and turkey dishes",
        Avg_Prop_Calciummg_fg_28 ~ "Liver, products and dishes",
        Avg_Prop_Calciummg_fg_29 ~ "Burgers and kebabs",
        Avg_Prop_Calciummg_fg_30 ~ "Sausages",
        Avg_Prop_Calciummg_fg_31 ~ "Meat pies and pastries",
        Avg_Prop_Calciummg_fg_32 ~ "Other meat and meat products",
        Avg_Prop_Calciummg_fg_33 ~ "White fish coated or fried",
        Avg_Prop_Calciummg_fg_34 ~ "Other white fish, shellfish and fish dishes",
        Avg_Prop_Calciummg_fg_35 ~ "Oily fish",
        Avg_Prop_Calciummg_fg_36 ~ "Salad and other raw vegetables",
        Avg_Prop_Calciummg_fg_37 ~ "Vegetables (not raw)",
        Avg_Prop_Calciummg_fg_38 ~ "Chips, fried and roast potatoes and potato products",
        Avg_Prop_Calciummg_fg_39 ~ "Other potatoes, potato salads and dishes",
        Avg_Prop_Calciummg_fg_40 ~ "Fruit",
        Avg_Prop_Calciummg_fg_41 ~ "Sugars, preserves and sweet spreads",
        Avg_Prop_Calciummg_fg_42 ~ "Crisps and savoury snacks",
        Avg_Prop_Calciummg_fg_43 ~ "Sugar confectionery",
        Avg_Prop_Calciummg_fg_44 ~ "Chocolate confectionery",
        Avg_Prop_Calciummg_fg_45 ~ "Fruit juice",
        Avg_Prop_Calciummg_fg_47 ~ "Spirits and liqueurs",
        Avg_Prop_Calciummg_fg_48 ~ "Wine",
        Avg_Prop_Calciummg_fg_49 ~ "Beer lager cider and perry",
        Avg_Prop_Calciummg_fg_50 ~ "Miscellaneous",
        Avg_Prop_Calciummg_fg_51 ~ "Tea, coffee and water",
        Avg_Prop_Calciummg_fg_52 ~ "Commercial toddlers foods and drinks",
        Avg_Prop_Calciummg_fg_53 ~ "Ice cream",
        Avg_Prop_Calciummg_fg_54 ~ "Dietary supplements",
        Avg_Prop_Calciummg_fg_55 ~ "Artificial sweeteners",
        Avg_Prop_Calciummg_fg_56 ~ "Nuts and seeds",
        Avg_Prop_Calciummg_fg_57 ~ "Soft drinks, not diet",
        Avg_Prop_Calciummg_fg_58 ~ "Soft drinks, diet",
        Avg_Prop_Calciummg_fg_59 ~ "Brown, granary and wheatgerm bread",
        Avg_Prop_Calciummg_fg_60 ~ "1% Milk",
        Avg_Prop_Calciummg_fg_62 ~ "Sandwiches",
        Avg_Prop_Calciummg_fg_63 ~ "Other milk and cream DF",                         
        Avg_Prop_Calciummg_fg_64 ~ "Cheese DF",
        Avg_Prop_Calciummg_fg_65 ~ "Yogurt, fromage frais and other dairy desserts DF",
        Avg_Prop_Calciummg_fg_66 ~ "Ice cream DF"),
  statistic = list(all_continuous() ~ 
                                       "{mean}"),
  missing = "no",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_Prop_Calciummg_fg_1:Avg_Prop_Calciummg_fg_66)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.calcium.fg

```


##Sodium
```{r}
# Mean portions
table.sodium.fg <- tbl_svysummary(
  svy.df.intake24_part_ndns_fg,
  by = age_sex_cat,
  label = c(Avg_Prop_Sodiummg_fg_1 ~ "Pasta, rice and other miscellaneous cereals",
        Avg_Prop_Sodiummg_fg_2 ~ "White bread",
        Avg_Prop_Sodiummg_fg_3 ~ "Wholemeal bread",
        Avg_Prop_Sodiummg_fg_4 ~ "Other breads",
        Avg_Prop_Sodiummg_fg_5 ~ "High fibre breakfast cereals",
        Avg_Prop_Sodiummg_fg_6 ~ "Other breakfast cereals",
        Avg_Prop_Sodiummg_fg_7 ~ "Biscuits",
        Avg_Prop_Sodiummg_fg_8 ~ "Buns, cakes, pastries and fruit pies",
        Avg_Prop_Sodiummg_fg_9 ~ "Puddings",
        Avg_Prop_Sodiummg_fg_10 ~ "Whole milk",
        Avg_Prop_Sodiummg_fg_11 ~ "Semi-skimmed milk",
        Avg_Prop_Sodiummg_fg_12 ~ "Skimmed milk",
        Avg_Prop_Sodiummg_fg_13 ~ "Other milk and cream",
        Avg_Prop_Sodiummg_fg_14 ~ "Cheese",
        Avg_Prop_Sodiummg_fg_15 ~ "Yogurt, fromage frais and other dairy desserts",
        Avg_Prop_Sodiummg_fg_16 ~ "Eggs and egg dishes",
        Avg_Prop_Sodiummg_fg_17 ~ "Butter",
        Avg_Prop_Sodiummg_fg_18 ~ "Polyunsaturated margarine and oils",
        Avg_Prop_Sodiummg_fg_19 ~ "Low fat spread",
        Avg_Prop_Sodiummg_fg_20 ~ "Margarine and other cooking fats and oils NOT polyunsaturated",
        Avg_Prop_Sodiummg_fg_21 ~ "Reduced fat spread",
        Avg_Prop_Sodiummg_fg_22 ~ "Bacon and ham",
        Avg_Prop_Sodiummg_fg_23 ~ "Beef, veal and dishes",
        Avg_Prop_Sodiummg_fg_24 ~ "Lamb and dishes",
        Avg_Prop_Sodiummg_fg_25 ~ "Pork and dishes",
        Avg_Prop_Sodiummg_fg_26 ~ "Coated chicken and turkey manufactured",
        Avg_Prop_Sodiummg_fg_27 ~ "Chicken and turkey dishes",
        Avg_Prop_Sodiummg_fg_28 ~ "Liver, products and dishes",
        Avg_Prop_Sodiummg_fg_29 ~ "Burgers and kebabs",
        Avg_Prop_Sodiummg_fg_30 ~ "Sausages",
        Avg_Prop_Sodiummg_fg_31 ~ "Meat pies and pastries",
        Avg_Prop_Sodiummg_fg_32 ~ "Other meat and meat products",
        Avg_Prop_Sodiummg_fg_33 ~ "White fish coated or fried",
        Avg_Prop_Sodiummg_fg_34 ~ "Other white fish, shellfish and fish dishes",
        Avg_Prop_Sodiummg_fg_35 ~ "Oily fish",
        Avg_Prop_Sodiummg_fg_36 ~ "Salad and other raw vegetables",
        Avg_Prop_Sodiummg_fg_37 ~ "Vegetables (not raw)",
        Avg_Prop_Sodiummg_fg_38 ~ "Chips, fried and roast potatoes and potato products",
        Avg_Prop_Sodiummg_fg_39 ~ "Other potatoes, potato salads and dishes",
        Avg_Prop_Sodiummg_fg_40 ~ "Fruit",
        Avg_Prop_Sodiummg_fg_41 ~ "Sugars, preserves and sweet spreads",
        Avg_Prop_Sodiummg_fg_42 ~ "Crisps and savoury snacks",
        Avg_Prop_Sodiummg_fg_43 ~ "Sugar confectionery",
        Avg_Prop_Sodiummg_fg_44 ~ "Chocolate confectionery",
        Avg_Prop_Sodiummg_fg_45 ~ "Fruit juice",
        Avg_Prop_Sodiummg_fg_47 ~ "Spirits and liqueurs",
        Avg_Prop_Sodiummg_fg_48 ~ "Wine",
        Avg_Prop_Sodiummg_fg_49 ~ "Beer lager cider and perry",
        Avg_Prop_Sodiummg_fg_50 ~ "Miscellaneous",
        Avg_Prop_Sodiummg_fg_51 ~ "Tea, coffee and water",
        Avg_Prop_Sodiummg_fg_52 ~ "Commercial toddlers foods and drinks",
        Avg_Prop_Sodiummg_fg_53 ~ "Ice cream",
        Avg_Prop_Sodiummg_fg_54 ~ "Dietary supplements",
        Avg_Prop_Sodiummg_fg_55 ~ "Artificial sweeteners",
        Avg_Prop_Sodiummg_fg_56 ~ "Nuts and seeds",
        Avg_Prop_Sodiummg_fg_57 ~ "Soft drinks, not diet",
        Avg_Prop_Sodiummg_fg_58 ~ "Soft drinks, diet",
        Avg_Prop_Sodiummg_fg_59 ~ "Brown, granary and wheatgerm bread",
        Avg_Prop_Sodiummg_fg_60 ~ "1% Milk",
        Avg_Prop_Sodiummg_fg_62 ~ "Sandwiches",
        Avg_Prop_Sodiummg_fg_63 ~ "Other milk and cream DF",                         
        Avg_Prop_Sodiummg_fg_64 ~ "Cheese DF",
        Avg_Prop_Sodiummg_fg_65 ~ "Yogurt, fromage frais and other dairy desserts DF",
        Avg_Prop_Sodiummg_fg_66 ~ "Ice cream DF"),
  statistic = list(all_continuous() ~ 
                                       "{mean}"),
  missing = "no",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_Prop_Sodiummg_fg_1:Avg_Prop_Sodiummg_fg_66)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.sodium.fg

```


##Magnesium
```{r}
# Mean portions
table.magnesium.fg <- tbl_svysummary(
  svy.df.intake24_part_ndns_fg,
  by = age_sex_cat,
  label = c(Avg_Prop_Magnesiummg_fg_1 ~ "Pasta, rice and other miscellaneous cereals",
        Avg_Prop_Magnesiummg_fg_2 ~ "White bread",
        Avg_Prop_Magnesiummg_fg_3 ~ "Wholemeal bread",
        Avg_Prop_Magnesiummg_fg_4 ~ "Other breads",
        Avg_Prop_Magnesiummg_fg_5 ~ "High fibre breakfast cereals",
        Avg_Prop_Magnesiummg_fg_6 ~ "Other breakfast cereals",
        Avg_Prop_Magnesiummg_fg_7 ~ "Biscuits",
        Avg_Prop_Magnesiummg_fg_8 ~ "Buns, cakes, pastries and fruit pies",
        Avg_Prop_Magnesiummg_fg_9 ~ "Puddings",
        Avg_Prop_Magnesiummg_fg_10 ~ "Whole milk",
        Avg_Prop_Magnesiummg_fg_11 ~ "Semi-skimmed milk",
        Avg_Prop_Magnesiummg_fg_12 ~ "Skimmed milk",
        Avg_Prop_Magnesiummg_fg_13 ~ "Other milk and cream",
        Avg_Prop_Magnesiummg_fg_14 ~ "Cheese",
        Avg_Prop_Magnesiummg_fg_15 ~ "Yogurt, fromage frais and other dairy desserts",
        Avg_Prop_Magnesiummg_fg_16 ~ "Eggs and egg dishes",
        Avg_Prop_Magnesiummg_fg_17 ~ "Butter",
        Avg_Prop_Magnesiummg_fg_18 ~ "Polyunsaturated margarine and oils",
        Avg_Prop_Magnesiummg_fg_19 ~ "Low fat spread",
        Avg_Prop_Magnesiummg_fg_20 ~ "Margarine and other cooking fats and oils NOT polyunsaturated",
        Avg_Prop_Magnesiummg_fg_21 ~ "Reduced fat spread",
        Avg_Prop_Magnesiummg_fg_22 ~ "Bacon and ham",
        Avg_Prop_Magnesiummg_fg_23 ~ "Beef, veal and dishes",
        Avg_Prop_Magnesiummg_fg_24 ~ "Lamb and dishes",
        Avg_Prop_Magnesiummg_fg_25 ~ "Pork and dishes",
        Avg_Prop_Magnesiummg_fg_26 ~ "Coated chicken and turkey manufactured",
        Avg_Prop_Magnesiummg_fg_27 ~ "Chicken and turkey dishes",
        Avg_Prop_Magnesiummg_fg_28 ~ "Liver, products and dishes",
        Avg_Prop_Magnesiummg_fg_29 ~ "Burgers and kebabs",
        Avg_Prop_Magnesiummg_fg_30 ~ "Sausages",
        Avg_Prop_Magnesiummg_fg_31 ~ "Meat pies and pastries",
        Avg_Prop_Magnesiummg_fg_32 ~ "Other meat and meat products",
        Avg_Prop_Magnesiummg_fg_33 ~ "White fish coated or fried",
        Avg_Prop_Magnesiummg_fg_34 ~ "Other white fish, shellfish and fish dishes",
        Avg_Prop_Magnesiummg_fg_35 ~ "Oily fish",
        Avg_Prop_Magnesiummg_fg_36 ~ "Salad and other raw vegetables",
        Avg_Prop_Magnesiummg_fg_37 ~ "Vegetables (not raw)",
        Avg_Prop_Magnesiummg_fg_38 ~ "Chips, fried and roast potatoes and potato products",
        Avg_Prop_Magnesiummg_fg_39 ~ "Other potatoes, potato salads and dishes",
        Avg_Prop_Magnesiummg_fg_40 ~ "Fruit",
        Avg_Prop_Magnesiummg_fg_41 ~ "Sugars, preserves and sweet spreads",
        Avg_Prop_Magnesiummg_fg_42 ~ "Crisps and savoury snacks",
        Avg_Prop_Magnesiummg_fg_43 ~ "Sugar confectionery",
        Avg_Prop_Magnesiummg_fg_44 ~ "Chocolate confectionery",
        Avg_Prop_Magnesiummg_fg_45 ~ "Fruit juice",
        Avg_Prop_Magnesiummg_fg_47 ~ "Spirits and liqueurs",
        Avg_Prop_Magnesiummg_fg_48 ~ "Wine",
        Avg_Prop_Magnesiummg_fg_49 ~ "Beer lager cider and perry",
        Avg_Prop_Magnesiummg_fg_50 ~ "Miscellaneous",
        Avg_Prop_Magnesiummg_fg_51 ~ "Tea, coffee and water",
        Avg_Prop_Magnesiummg_fg_52 ~ "Commercial toddlers foods and drinks",
        Avg_Prop_Magnesiummg_fg_53 ~ "Ice cream",
        Avg_Prop_Magnesiummg_fg_54 ~ "Dietary supplements",
        Avg_Prop_Magnesiummg_fg_55 ~ "Artificial sweeteners",
        Avg_Prop_Magnesiummg_fg_56 ~ "Nuts and seeds",
        Avg_Prop_Magnesiummg_fg_57 ~ "Soft drinks, not diet",
        Avg_Prop_Magnesiummg_fg_58 ~ "Soft drinks, diet",
        Avg_Prop_Magnesiummg_fg_59 ~ "Brown, granary and wheatgerm bread",
        Avg_Prop_Magnesiummg_fg_60 ~ "1% Milk",
        Avg_Prop_Magnesiummg_fg_62 ~ "Sandwiches",
        Avg_Prop_Magnesiummg_fg_63 ~ "Other milk and cream DF",                         
        Avg_Prop_Magnesiummg_fg_64 ~ "Cheese DF",
        Avg_Prop_Magnesiummg_fg_65 ~ "Yogurt, fromage frais and other dairy desserts DF",
        Avg_Prop_Magnesiummg_fg_66 ~ "Ice cream DF"),
  statistic = list(all_continuous() ~ 
                                       "{mean}"),
  missing = "no",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_Prop_Magnesiummg_fg_1:Avg_Prop_Magnesiummg_fg_66)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.magnesium.fg

```


##Potassium
```{r}
# Mean portions
table.potassium.fg <- tbl_svysummary(
  svy.df.intake24_part_ndns_fg,
  by = age_sex_cat,
  label = c(Avg_Prop_Potassiummg_fg_1 ~ "Pasta, rice and other miscellaneous cereals",
        Avg_Prop_Potassiummg_fg_2 ~ "White bread",
        Avg_Prop_Potassiummg_fg_3 ~ "Wholemeal bread",
        Avg_Prop_Potassiummg_fg_4 ~ "Other breads",
        Avg_Prop_Potassiummg_fg_5 ~ "High fibre breakfast cereals",
        Avg_Prop_Potassiummg_fg_6 ~ "Other breakfast cereals",
        Avg_Prop_Potassiummg_fg_7 ~ "Biscuits",
        Avg_Prop_Potassiummg_fg_8 ~ "Buns, cakes, pastries and fruit pies",
        Avg_Prop_Potassiummg_fg_9 ~ "Puddings",
        Avg_Prop_Potassiummg_fg_10 ~ "Whole milk",
        Avg_Prop_Potassiummg_fg_11 ~ "Semi-skimmed milk",
        Avg_Prop_Potassiummg_fg_12 ~ "Skimmed milk",
        Avg_Prop_Potassiummg_fg_13 ~ "Other milk and cream",
        Avg_Prop_Potassiummg_fg_14 ~ "Cheese",
        Avg_Prop_Potassiummg_fg_15 ~ "Yogurt, fromage frais and other dairy desserts",
        Avg_Prop_Potassiummg_fg_16 ~ "Eggs and egg dishes",
        Avg_Prop_Potassiummg_fg_17 ~ "Butter",
        Avg_Prop_Potassiummg_fg_18 ~ "Polyunsaturated margarine and oils",
        Avg_Prop_Potassiummg_fg_19 ~ "Low fat spread",
        Avg_Prop_Potassiummg_fg_20 ~ "Margarine and other cooking fats and oils NOT polyunsaturated",
        Avg_Prop_Potassiummg_fg_21 ~ "Reduced fat spread",
        Avg_Prop_Potassiummg_fg_22 ~ "Bacon and ham",
        Avg_Prop_Potassiummg_fg_23 ~ "Beef, veal and dishes",
        Avg_Prop_Potassiummg_fg_24 ~ "Lamb and dishes",
        Avg_Prop_Potassiummg_fg_25 ~ "Pork and dishes",
        Avg_Prop_Potassiummg_fg_26 ~ "Coated chicken and turkey manufactured",
        Avg_Prop_Potassiummg_fg_27 ~ "Chicken and turkey dishes",
        Avg_Prop_Potassiummg_fg_28 ~ "Liver, products and dishes",
        Avg_Prop_Potassiummg_fg_29 ~ "Burgers and kebabs",
        Avg_Prop_Potassiummg_fg_30 ~ "Sausages",
        Avg_Prop_Potassiummg_fg_31 ~ "Meat pies and pastries",
        Avg_Prop_Potassiummg_fg_32 ~ "Other meat and meat products",
        Avg_Prop_Potassiummg_fg_33 ~ "White fish coated or fried",
        Avg_Prop_Potassiummg_fg_34 ~ "Other white fish, shellfish and fish dishes",
        Avg_Prop_Potassiummg_fg_35 ~ "Oily fish",
        Avg_Prop_Potassiummg_fg_36 ~ "Salad and other raw vegetables",
        Avg_Prop_Potassiummg_fg_37 ~ "Vegetables (not raw)",
        Avg_Prop_Potassiummg_fg_38 ~ "Chips, fried and roast potatoes and potato products",
        Avg_Prop_Potassiummg_fg_39 ~ "Other potatoes, potato salads and dishes",
        Avg_Prop_Potassiummg_fg_40 ~ "Fruit",
        Avg_Prop_Potassiummg_fg_41 ~ "Sugars, preserves and sweet spreads",
        Avg_Prop_Potassiummg_fg_42 ~ "Crisps and savoury snacks",
        Avg_Prop_Potassiummg_fg_43 ~ "Sugar confectionery",
        Avg_Prop_Potassiummg_fg_44 ~ "Chocolate confectionery",
        Avg_Prop_Potassiummg_fg_45 ~ "Fruit juice",
        Avg_Prop_Potassiummg_fg_47 ~ "Spirits and liqueurs",
        Avg_Prop_Potassiummg_fg_48 ~ "Wine",
        Avg_Prop_Potassiummg_fg_49 ~ "Beer lager cider and perry",
        Avg_Prop_Potassiummg_fg_50 ~ "Miscellaneous",
        Avg_Prop_Potassiummg_fg_51 ~ "Tea, coffee and water",
        Avg_Prop_Potassiummg_fg_52 ~ "Commercial toddlers foods and drinks",
        Avg_Prop_Potassiummg_fg_53 ~ "Ice cream",
        Avg_Prop_Potassiummg_fg_54 ~ "Dietary supplements",
        Avg_Prop_Potassiummg_fg_55 ~ "Artificial sweeteners",
        Avg_Prop_Potassiummg_fg_56 ~ "Nuts and seeds",
        Avg_Prop_Potassiummg_fg_57 ~ "Soft drinks, not diet",
        Avg_Prop_Potassiummg_fg_58 ~ "Soft drinks, diet",
        Avg_Prop_Potassiummg_fg_59 ~ "Brown, granary and wheatgerm bread",
        Avg_Prop_Potassiummg_fg_60 ~ "1% Milk",
        Avg_Prop_Potassiummg_fg_62 ~ "Sandwiches",
        Avg_Prop_Potassiummg_fg_63 ~ "Other milk and cream DF",                         
        Avg_Prop_Potassiummg_fg_64 ~ "Cheese DF",
        Avg_Prop_Potassiummg_fg_65 ~ "Yogurt, fromage frais and other dairy desserts DF",
        Avg_Prop_Potassiummg_fg_66 ~ "Ice cream DF"),
  statistic = list(all_continuous() ~ 
                                       "{mean}"),
  missing = "no",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_Prop_Potassiummg_fg_1:Avg_Prop_Potassiummg_fg_66)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.potassium.fg

```


##Iodine
```{r}
# Mean portions
table.iodine.fg <- tbl_svysummary(
  svy.df.intake24_part_ndns_fg,
  by = age_sex_cat,
  label = c(Avg_Prop_Iodineug_fg_1 ~ "Pasta, rice and other miscellaneous cereals",
        Avg_Prop_Iodineug_fg_2 ~ "White bread",
        Avg_Prop_Iodineug_fg_3 ~ "Wholemeal bread",
        Avg_Prop_Iodineug_fg_4 ~ "Other breads",
        Avg_Prop_Iodineug_fg_5 ~ "High fibre breakfast cereals",
        Avg_Prop_Iodineug_fg_6 ~ "Other breakfast cereals",
        Avg_Prop_Iodineug_fg_7 ~ "Biscuits",
        Avg_Prop_Iodineug_fg_8 ~ "Buns, cakes, pastries and fruit pies",
        Avg_Prop_Iodineug_fg_9 ~ "Puddings",
        Avg_Prop_Iodineug_fg_10 ~ "Whole milk",
        Avg_Prop_Iodineug_fg_11 ~ "Semi-skimmed milk",
        Avg_Prop_Iodineug_fg_12 ~ "Skimmed milk",
        Avg_Prop_Iodineug_fg_13 ~ "Other milk and cream",
        Avg_Prop_Iodineug_fg_14 ~ "Cheese",
        Avg_Prop_Iodineug_fg_15 ~ "Yogurt, fromage frais and other dairy desserts",
        Avg_Prop_Iodineug_fg_16 ~ "Eggs and egg dishes",
        Avg_Prop_Iodineug_fg_17 ~ "Butter",
        Avg_Prop_Iodineug_fg_18 ~ "Polyunsaturated margarine and oils",
        Avg_Prop_Iodineug_fg_19 ~ "Low fat spread",
        Avg_Prop_Iodineug_fg_20 ~ "Margarine and other cooking fats and oils NOT polyunsaturated",
        Avg_Prop_Iodineug_fg_21 ~ "Reduced fat spread",
        Avg_Prop_Iodineug_fg_22 ~ "Bacon and ham",
        Avg_Prop_Iodineug_fg_23 ~ "Beef, veal and dishes",
        Avg_Prop_Iodineug_fg_24 ~ "Lamb and dishes",
        Avg_Prop_Iodineug_fg_25 ~ "Pork and dishes",
        Avg_Prop_Iodineug_fg_26 ~ "Coated chicken and turkey manufactured",
        Avg_Prop_Iodineug_fg_27 ~ "Chicken and turkey dishes",
        Avg_Prop_Iodineug_fg_28 ~ "Liver, products and dishes",
        Avg_Prop_Iodineug_fg_29 ~ "Burgers and kebabs",
        Avg_Prop_Iodineug_fg_30 ~ "Sausages",
        Avg_Prop_Iodineug_fg_31 ~ "Meat pies and pastries",
        Avg_Prop_Iodineug_fg_32 ~ "Other meat and meat products",
        Avg_Prop_Iodineug_fg_33 ~ "White fish coated or fried",
        Avg_Prop_Iodineug_fg_34 ~ "Other white fish, shellfish and fish dishes",
        Avg_Prop_Iodineug_fg_35 ~ "Oily fish",
        Avg_Prop_Iodineug_fg_36 ~ "Salad and other raw vegetables",
        Avg_Prop_Iodineug_fg_37 ~ "Vegetables (not raw)",
        Avg_Prop_Iodineug_fg_38 ~ "Chips, fried and roast potatoes and potato products",
        Avg_Prop_Iodineug_fg_39 ~ "Other potatoes, potato salads and dishes",
        Avg_Prop_Iodineug_fg_40 ~ "Fruit",
        Avg_Prop_Iodineug_fg_41 ~ "Sugars, preserves and sweet spreads",
        Avg_Prop_Iodineug_fg_42 ~ "Crisps and savoury snacks",
        Avg_Prop_Iodineug_fg_43 ~ "Sugar confectionery",
        Avg_Prop_Iodineug_fg_44 ~ "Chocolate confectionery",
        Avg_Prop_Iodineug_fg_45 ~ "Fruit juice",
        Avg_Prop_Iodineug_fg_47 ~ "Spirits and liqueurs",
        Avg_Prop_Iodineug_fg_48 ~ "Wine",
        Avg_Prop_Iodineug_fg_49 ~ "Beer lager cider and perry",
        Avg_Prop_Iodineug_fg_50 ~ "Miscellaneous",
        Avg_Prop_Iodineug_fg_51 ~ "Tea, coffee and water",
        Avg_Prop_Iodineug_fg_52 ~ "Commercial toddlers foods and drinks",
        Avg_Prop_Iodineug_fg_53 ~ "Ice cream",
        Avg_Prop_Iodineug_fg_54 ~ "Dietary supplements",
        Avg_Prop_Iodineug_fg_55 ~ "Artificial sweeteners",
        Avg_Prop_Iodineug_fg_56 ~ "Nuts and seeds",
        Avg_Prop_Iodineug_fg_57 ~ "Soft drinks, not diet",
        Avg_Prop_Iodineug_fg_58 ~ "Soft drinks, diet",
        Avg_Prop_Iodineug_fg_59 ~ "Brown, granary and wheatgerm bread",
        Avg_Prop_Iodineug_fg_60 ~ "1% Milk",
        Avg_Prop_Iodineug_fg_62 ~ "Sandwiches",
        Avg_Prop_Iodineug_fg_63 ~ "Other milk and cream DF",                         
        Avg_Prop_Iodineug_fg_64 ~ "Cheese DF",
        Avg_Prop_Iodineug_fg_65 ~ "Yogurt, fromage frais and other dairy desserts DF",
        Avg_Prop_Iodineug_fg_66 ~ "Ice cream DF"),
  statistic = list(all_continuous() ~ 
                                       "{mean}"),
  missing = "no",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_Prop_Iodineug_fg_1:Avg_Prop_Iodineug_fg_66)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.iodine.fg

```


##Selenium
```{r}
# Mean portions
table.selenium.fg <- tbl_svysummary(
  svy.df.intake24_part_ndns_fg,
  by = age_sex_cat,
  label = c(Avg_Prop_Seleniumug_fg_1 ~ "Pasta, rice and other miscellaneous cereals",
        Avg_Prop_Seleniumug_fg_2 ~ "White bread",
        Avg_Prop_Seleniumug_fg_3 ~ "Wholemeal bread",
        Avg_Prop_Seleniumug_fg_4 ~ "Other breads",
        Avg_Prop_Seleniumug_fg_5 ~ "High fibre breakfast cereals",
        Avg_Prop_Seleniumug_fg_6 ~ "Other breakfast cereals",
        Avg_Prop_Seleniumug_fg_7 ~ "Biscuits",
        Avg_Prop_Seleniumug_fg_8 ~ "Buns, cakes, pastries and fruit pies",
        Avg_Prop_Seleniumug_fg_9 ~ "Puddings",
        Avg_Prop_Seleniumug_fg_10 ~ "Whole milk",
        Avg_Prop_Seleniumug_fg_11 ~ "Semi-skimmed milk",
        Avg_Prop_Seleniumug_fg_12 ~ "Skimmed milk",
        Avg_Prop_Seleniumug_fg_13 ~ "Other milk and cream",
        Avg_Prop_Seleniumug_fg_14 ~ "Cheese",
        Avg_Prop_Seleniumug_fg_15 ~ "Yogurt, fromage frais and other dairy desserts",
        Avg_Prop_Seleniumug_fg_16 ~ "Eggs and egg dishes",
        Avg_Prop_Seleniumug_fg_17 ~ "Butter",
        Avg_Prop_Seleniumug_fg_18 ~ "Polyunsaturated margarine and oils",
        Avg_Prop_Seleniumug_fg_19 ~ "Low fat spread",
        Avg_Prop_Seleniumug_fg_20 ~ "Margarine and other cooking fats and oils NOT polyunsaturated",
        Avg_Prop_Seleniumug_fg_21 ~ "Reduced fat spread",
        Avg_Prop_Seleniumug_fg_22 ~ "Bacon and ham",
        Avg_Prop_Seleniumug_fg_23 ~ "Beef, veal and dishes",
        Avg_Prop_Seleniumug_fg_24 ~ "Lamb and dishes",
        Avg_Prop_Seleniumug_fg_25 ~ "Pork and dishes",
        Avg_Prop_Seleniumug_fg_26 ~ "Coated chicken and turkey manufactured",
        Avg_Prop_Seleniumug_fg_27 ~ "Chicken and turkey dishes",
        Avg_Prop_Seleniumug_fg_28 ~ "Liver, products and dishes",
        Avg_Prop_Seleniumug_fg_29 ~ "Burgers and kebabs",
        Avg_Prop_Seleniumug_fg_30 ~ "Sausages",
        Avg_Prop_Seleniumug_fg_31 ~ "Meat pies and pastries",
        Avg_Prop_Seleniumug_fg_32 ~ "Other meat and meat products",
        Avg_Prop_Seleniumug_fg_33 ~ "White fish coated or fried",
        Avg_Prop_Seleniumug_fg_34 ~ "Other white fish, shellfish and fish dishes",
        Avg_Prop_Seleniumug_fg_35 ~ "Oily fish",
        Avg_Prop_Seleniumug_fg_36 ~ "Salad and other raw vegetables",
        Avg_Prop_Seleniumug_fg_37 ~ "Vegetables (not raw)",
        Avg_Prop_Seleniumug_fg_38 ~ "Chips, fried and roast potatoes and potato products",
        Avg_Prop_Seleniumug_fg_39 ~ "Other potatoes, potato salads and dishes",
        Avg_Prop_Seleniumug_fg_40 ~ "Fruit",
        Avg_Prop_Seleniumug_fg_41 ~ "Sugars, preserves and sweet spreads",
        Avg_Prop_Seleniumug_fg_42 ~ "Crisps and savoury snacks",
        Avg_Prop_Seleniumug_fg_43 ~ "Sugar confectionery",
        Avg_Prop_Seleniumug_fg_44 ~ "Chocolate confectionery",
        Avg_Prop_Seleniumug_fg_45 ~ "Fruit juice",
        Avg_Prop_Seleniumug_fg_47 ~ "Spirits and liqueurs",
        Avg_Prop_Seleniumug_fg_48 ~ "Wine",
        Avg_Prop_Seleniumug_fg_49 ~ "Beer lager cider and perry",
        Avg_Prop_Seleniumug_fg_50 ~ "Miscellaneous",
        Avg_Prop_Seleniumug_fg_51 ~ "Tea, coffee and water",
        Avg_Prop_Seleniumug_fg_52 ~ "Commercial toddlers foods and drinks",
        Avg_Prop_Seleniumug_fg_53 ~ "Ice cream",
        Avg_Prop_Seleniumug_fg_54 ~ "Dietary supplements",
        Avg_Prop_Seleniumug_fg_55 ~ "Artificial sweeteners",
        Avg_Prop_Seleniumug_fg_56 ~ "Nuts and seeds",
        Avg_Prop_Seleniumug_fg_57 ~ "Soft drinks, not diet",
        Avg_Prop_Seleniumug_fg_58 ~ "Soft drinks, diet",
        Avg_Prop_Seleniumug_fg_59 ~ "Brown, granary and wheatgerm bread",
        Avg_Prop_Seleniumug_fg_60 ~ "1% Milk",
        Avg_Prop_Seleniumug_fg_62 ~ "Sandwiches",
        Avg_Prop_Seleniumug_fg_63 ~ "Other milk and cream DF",                         
        Avg_Prop_Seleniumug_fg_64 ~ "Cheese DF",
        Avg_Prop_Seleniumug_fg_65 ~ "Yogurt, fromage frais and other dairy desserts DF",
        Avg_Prop_Seleniumug_fg_66 ~ "Ice cream DF"),
  statistic = list(all_continuous() ~ 
                                       "{mean}"),
  missing = "no",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_Prop_Seleniumug_fg_1:Avg_Prop_Seleniumug_fg_66)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.selenium.fg

```


##Zinc
```{r}
# Mean portions
table.zinc.fg <- tbl_svysummary(
  svy.df.intake24_part_ndns_fg,
  by = age_sex_cat,
  label = c(Avg_Prop_Zincmg_fg_1 ~ "Pasta, rice and other miscellaneous cereals",
        Avg_Prop_Zincmg_fg_2 ~ "White bread",
        Avg_Prop_Zincmg_fg_3 ~ "Wholemeal bread",
        Avg_Prop_Zincmg_fg_4 ~ "Other breads",
        Avg_Prop_Zincmg_fg_5 ~ "High fibre breakfast cereals",
        Avg_Prop_Zincmg_fg_6 ~ "Other breakfast cereals",
        Avg_Prop_Zincmg_fg_7 ~ "Biscuits",
        Avg_Prop_Zincmg_fg_8 ~ "Buns, cakes, pastries and fruit pies",
        Avg_Prop_Zincmg_fg_9 ~ "Puddings",
        Avg_Prop_Zincmg_fg_10 ~ "Whole milk",
        Avg_Prop_Zincmg_fg_11 ~ "Semi-skimmed milk",
        Avg_Prop_Zincmg_fg_12 ~ "Skimmed milk",
        Avg_Prop_Zincmg_fg_13 ~ "Other milk and cream",
        Avg_Prop_Zincmg_fg_14 ~ "Cheese",
        Avg_Prop_Zincmg_fg_15 ~ "Yogurt, fromage frais and other dairy desserts",
        Avg_Prop_Zincmg_fg_16 ~ "Eggs and egg dishes",
        Avg_Prop_Zincmg_fg_17 ~ "Butter",
        Avg_Prop_Zincmg_fg_18 ~ "Polyunsaturated margarine and oils",
        Avg_Prop_Zincmg_fg_19 ~ "Low fat spread",
        Avg_Prop_Zincmg_fg_20 ~ "Margarine and other cooking fats and oils NOT polyunsaturated",
        Avg_Prop_Zincmg_fg_21 ~ "Reduced fat spread",
        Avg_Prop_Zincmg_fg_22 ~ "Bacon and ham",
        Avg_Prop_Zincmg_fg_23 ~ "Beef, veal and dishes",
        Avg_Prop_Zincmg_fg_24 ~ "Lamb and dishes",
        Avg_Prop_Zincmg_fg_25 ~ "Pork and dishes",
        Avg_Prop_Zincmg_fg_26 ~ "Coated chicken and turkey manufactured",
        Avg_Prop_Zincmg_fg_27 ~ "Chicken and turkey dishes",
        Avg_Prop_Zincmg_fg_28 ~ "Liver, products and dishes",
        Avg_Prop_Zincmg_fg_29 ~ "Burgers and kebabs",
        Avg_Prop_Zincmg_fg_30 ~ "Sausages",
        Avg_Prop_Zincmg_fg_31 ~ "Meat pies and pastries",
        Avg_Prop_Zincmg_fg_32 ~ "Other meat and meat products",
        Avg_Prop_Zincmg_fg_33 ~ "White fish coated or fried",
        Avg_Prop_Zincmg_fg_34 ~ "Other white fish, shellfish and fish dishes",
        Avg_Prop_Zincmg_fg_35 ~ "Oily fish",
        Avg_Prop_Zincmg_fg_36 ~ "Salad and other raw vegetables",
        Avg_Prop_Zincmg_fg_37 ~ "Vegetables (not raw)",
        Avg_Prop_Zincmg_fg_38 ~ "Chips, fried and roast potatoes and potato products",
        Avg_Prop_Zincmg_fg_39 ~ "Other potatoes, potato salads and dishes",
        Avg_Prop_Zincmg_fg_40 ~ "Fruit",
        Avg_Prop_Zincmg_fg_41 ~ "Sugars, preserves and sweet spreads",
        Avg_Prop_Zincmg_fg_42 ~ "Crisps and savoury snacks",
        Avg_Prop_Zincmg_fg_43 ~ "Sugar confectionery",
        Avg_Prop_Zincmg_fg_44 ~ "Chocolate confectionery",
        Avg_Prop_Zincmg_fg_45 ~ "Fruit juice",
        Avg_Prop_Zincmg_fg_47 ~ "Spirits and liqueurs",
        Avg_Prop_Zincmg_fg_48 ~ "Wine",
        Avg_Prop_Zincmg_fg_49 ~ "Beer lager cider and perry",
        Avg_Prop_Zincmg_fg_50 ~ "Miscellaneous",
        Avg_Prop_Zincmg_fg_51 ~ "Tea, coffee and water",
        Avg_Prop_Zincmg_fg_52 ~ "Commercial toddlers foods and drinks",
        Avg_Prop_Zincmg_fg_53 ~ "Ice cream",
        Avg_Prop_Zincmg_fg_54 ~ "Dietary supplements",
        Avg_Prop_Zincmg_fg_55 ~ "Artificial sweeteners",
        Avg_Prop_Zincmg_fg_56 ~ "Nuts and seeds",
        Avg_Prop_Zincmg_fg_57 ~ "Soft drinks, not diet",
        Avg_Prop_Zincmg_fg_58 ~ "Soft drinks, diet",
        Avg_Prop_Zincmg_fg_59 ~ "Brown, granary and wheatgerm bread",
        Avg_Prop_Zincmg_fg_60 ~ "1% Milk",
        Avg_Prop_Zincmg_fg_62 ~ "Sandwiches",
        Avg_Prop_Zincmg_fg_63 ~ "Other milk and cream DF",                         
        Avg_Prop_Zincmg_fg_64 ~ "Cheese DF",
        Avg_Prop_Zincmg_fg_65 ~ "Yogurt, fromage frais and other dairy desserts DF",
        Avg_Prop_Zincmg_fg_66 ~ "Ice cream DF"),
  statistic = list(all_continuous() ~ 
                                       "{mean}"),
  missing = "no",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_Prop_Zincmg_fg_1:Avg_Prop_Zincmg_fg_66)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.zinc.fg

```

##Output to excel
```{r eval=FALSE, include=FALSE}
# Convert flextables to data frames
df.table.energy <- table.energy.fg$body$dataset %>%
  rename(Energy_Density = label,
         Overall = stat_0,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)

df.table.carbs <- table.carbs.fg$body$dataset %>%
  rename(Carbohydrates = label,
         Overall = stat_0,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)


df.table.FreeSugars <- table.FreeSugars.fg$body$dataset %>%
  rename(Free_Sugars = label,
         Overall = stat_0,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)

df.table.fat <- table.fat.fg$body$dataset %>%
  rename(Fat = label,
        Overall = stat_0,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)

df.table.SatFat <- table.SatFat.fg$body$dataset %>%
  rename(Sat_Fat = label,
         Overall = stat_0,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)

df.table.TransFat <- table.TransFat.fg$body$dataset %>%
  rename(Trans_Fat = label,
         Overall = stat_0,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)

df.table.protein <- table.protein.fg$body$dataset %>%
  rename(Protein = label,
         Overall = stat_0,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)


df.table.fibre <- table.fibre.fg$body$dataset %>%
  rename(Fibre = label,
         Overall = stat_0,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)

df.table.VitA <- table.VitA.fg$body$dataset %>%
  rename(Vitamin_A = label,
         Overall = stat_0,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)

df.table.riboflavin <- table.riboflavin.fg$body$dataset %>%
  rename(Riboflavin = label,
         Overall = stat_0,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)

df.table.folate <- table.folate.fg$body$dataset %>%
  rename(Folate = label,
         Overall = stat_0,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)

df.table.VitD <- table.VitD.fg$body$dataset %>%
  rename(Vitamin_D = label,
         Overall = stat_0,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)

df.table.VitB12 <- table.VitB12.fg$body$dataset %>%
  rename(Vitamin_B12 = label,
         Overall = stat_0,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)

df.table.VitC <- table.VitC.fg$body$dataset %>%
  rename(Vitamin_C = label,
         Overall = stat_0,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)

df.table.iron <- table.iron.fg$body$dataset %>%
  rename(Iron = label,
         Overall = stat_0,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)

df.table.calcium <- table.calcium.fg$body$dataset %>%
  rename(Calcium = label,
         Overall = stat_0,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)

df.table.sodium <- table.sodium.fg$body$dataset %>%
  rename(Sodium = label,
         Overall = stat_0,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)

df.table.magnesium <- table.magnesium.fg$body$dataset %>%
  rename(Magnesium = label,
         Overall = stat_0,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)

df.table.potassium <- table.potassium.fg$body$dataset %>%
  rename(Potassium = label,
         Overall = stat_0,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)

df.table.iodine <- table.iodine.fg$body$dataset %>%
  rename(Iodine = label,
         Overall = stat_0,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)

df.table.selenium <- table.selenium.fg$body$dataset %>%
  rename(Selenium = label,
         Overall = stat_0,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)

df.table.zinc <- table.zinc.fg$body$dataset %>%
  rename(Zinc = label,
         Overall = stat_0,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)



write_xlsx(
  list(
    "Energy" = df.table.energy,
    "Carbs" = df.table.carbs,
    "Free_Sugars" = df.table.FreeSugars,
    "Fat" = df.table.fat,
    "Sat_Fat" = df.table.SatFat,
    "Trans_Fat" = df.table.TransFat,
    "Protein" = df.table.protein,
    "Fibre" = df.table.fibre,
    "Vit_A" = df.table.VitA,
    "Riboflavin" = df.table.riboflavin,
    "Folate" = df.table.folate,
    "Vit_D" = df.table.VitD,
    "Vit_B12" = df.table.VitB12,
    "Vit_C" = df.table.VitC,
    "Iron" = df.table.iron,
    "Calcium" = df.table.calcium,
    "Sodium" = df.table.sodium,
    "Magnesium" = df.table.magnesium,
    "Potassium" = df.table.potassium,
    "Iodine" = df.table.iodine,
    "Selenium" = df.table.selenium,
    "Zinc" = df.table.zinc
  ),
  path = paste0("/Users/ricki/Desktop/DISH_data_cleaning/Output_data_analysis/Table_NDNS_fg_", format(Sys.time(), "%d%m%Y"), ".xlsx")
)
```

#Food Groups - Discretionary

## Energy
```{r}
# Mean portions
table.energy.disc.fg <- tbl_svysummary(
  svy.df.intake24_part_disc_fg,
  by = age_sex_cat,
  label = c(
    Avg_Prop_Energykcal_discr_1 ~ "Sweet biscuits",
    Avg_Prop_Energykcal_discr_2 ~ "Cakes, sweet pastries & puddings",
    Avg_Prop_Energykcal_discr_3 ~ "Crisps and savoury snacks",
    Avg_Prop_Energykcal_discr_4 ~ "Confectionery",
    Avg_Prop_Energykcal_discr_5 ~ "Ice creams & ice lollies",
    Avg_Prop_Energykcal_discr_6 ~ "Sugar-containing soft drinks",
    Avg_Prop_Energykcal_discr_7 ~ "Breakfast cereals",
    Avg_Prop_Energykcal_discr_8 ~ "Roast potatoes, chips and similar roasted potato products",
    Avg_Prop_Energykcal_discr_9 ~ "Pizza",
    Avg_Prop_Energykcal_discr_10 ~ "Yoghurts, fromage frais and dairy desserts",
    Avg_Prop_Energykcal_discr_11 ~ "Ready meals"),
  statistic = list(all_continuous() ~ 
                                       "{mean}"),
  missing = "no",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_Prop_Energykcal_discr_1:Avg_Prop_Energykcal_discr_11)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.energy.disc.fg
```


## Free Sugars
```{r}
# Mean portions
table.FreeSugars.disc.fg <- tbl_svysummary(
  svy.df.intake24_part_disc_fg,
  by = age_sex_cat,
  label = c(
    Avg_Prop_FreeSugarsg_discr_1 ~ "Sweet biscuits",
    Avg_Prop_FreeSugarsg_discr_2 ~ "Cakes, sweet pastries & puddings",
    Avg_Prop_FreeSugarsg_discr_3 ~ "Crisps and savoury snacks",
    Avg_Prop_FreeSugarsg_discr_4 ~ "Confectionery",
    Avg_Prop_FreeSugarsg_discr_5 ~ "Ice creams & ice lollies",
    Avg_Prop_FreeSugarsg_discr_6 ~ "Sugar-containing soft drinks",
    Avg_Prop_FreeSugarsg_discr_7 ~ "Breakfast cereals",
    Avg_Prop_FreeSugarsg_discr_8 ~ "Roast potatoes, chips and similar roasted potato products",
    Avg_Prop_FreeSugarsg_discr_9 ~ "Pizza",
    Avg_Prop_FreeSugarsg_discr_10 ~ "Yoghurts, fromage frais and dairy desserts",
    Avg_Prop_FreeSugarsg_discr_11 ~ "Ready meals"),
  statistic = list(all_continuous() ~ 
                                       "{mean}"),
  missing = "no",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_Prop_FreeSugarsg_discr_1:Avg_Prop_FreeSugarsg_discr_11)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.FreeSugars.disc.fg
```


## Fat
```{r}
#doesn't fix issue in tables
svy.df.intake24_part_disc_fg <- update(
  svy.df.intake24_part_disc_fg,
  as.numeric(Avg_Prop_Fatg_discr_6)
)

# Mean portions
table.fat.disc.fg <- tbl_svysummary(
  svy.df.intake24_part_disc_fg,
  by = age_sex_cat,
  label = c(
    Avg_Prop_Fatg_discr_1 ~ "Sweet biscuits",
    Avg_Prop_Fatg_discr_2 ~ "Cakes, sweet pastries & puddings",
    Avg_Prop_Fatg_discr_3 ~ "Crisps and savoury snacks",
    Avg_Prop_Fatg_discr_4 ~ "Confectionery",
    Avg_Prop_Fatg_discr_5 ~ "Ice creams & ice lollies",
    Avg_Prop_Fatg_discr_6 ~ "Sugar-containing soft drinks",
    Avg_Prop_Fatg_discr_7 ~ "Breakfast cereals",
    Avg_Prop_Fatg_discr_8 ~ "Roast potatoes, chips and similar roasted potato products",
    Avg_Prop_Fatg_discr_9 ~ "Pizza",
    Avg_Prop_Fatg_discr_10 ~ "Yoghurts, fromage frais and dairy desserts",
    Avg_Prop_Fatg_discr_11 ~ "Ready meals"),
  statistic = list(all_continuous() ~ 
                                       "{mean}"),
  missing = "no",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_Prop_Fatg_discr_1:Avg_Prop_Fatg_discr_11)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.fat.disc.fg
```


## Sat Fat
```{r}
# Mean portions
table.SatFat.disc.fg <- tbl_svysummary(
  svy.df.intake24_part_disc_fg,
  by = age_sex_cat,
  label = c(
    Avg_Prop_SatFatg_discr_1 ~ "Sweet biscuits",
    Avg_Prop_SatFatg_discr_2 ~ "Cakes, sweet pastries & puddings",
    Avg_Prop_SatFatg_discr_3 ~ "Crisps and savoury snacks",
    Avg_Prop_SatFatg_discr_4 ~ "Confectionery",
    Avg_Prop_SatFatg_discr_5 ~ "Ice creams & ice lollies",
    Avg_Prop_SatFatg_discr_6 ~ "Sugar-containing soft drinks",
    Avg_Prop_SatFatg_discr_7 ~ "Breakfast cereals",
    Avg_Prop_SatFatg_discr_8 ~ "Roast potatoes, chips and similar roasted potato products",
    Avg_Prop_SatFatg_discr_9 ~ "Pizza",
    Avg_Prop_SatFatg_discr_10 ~ "Yoghurts, fromage frais and dairy desserts",
    Avg_Prop_SatFatg_discr_11 ~ "Ready meals"),
  statistic = list(all_continuous() ~ 
                                       "{mean}"),
  missing = "no",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_Prop_SatFatg_discr_1:Avg_Prop_SatFatg_discr_11)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.SatFat.disc.fg
```


## Output to Excel
```{r eval=FALSE, include=FALSE}
# Convert flextables to data frames
df.table.energy.disc <- table.energy.disc.fg$body$dataset %>%
  rename(Energy_Density = label,
         Overall = stat_0,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)


df.table.FreeSugars.disc <- table.FreeSugars.disc.fg$body$dataset %>%
  rename(Free_Sugars = label,
         Overall = stat_0,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)

df.table.fat.disc <- table.fat.disc.fg$body$dataset %>%
  rename(Fat = label,
        Overall = stat_0,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)

df.table.SatFat.disc <- table.SatFat.disc.fg$body$dataset %>%
  rename(Sat_Fat = label,
         Overall = stat_0,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)



write_xlsx(
  list(
    "Energy" = df.table.energy.disc,
    "Free_Sugars" = df.table.FreeSugars.disc,
    "Fat" = df.table.fat.disc,
    "Sat_Fat" = df.table.SatFat.disc),
  path = paste0("/Users/ricki/Desktop/DISH_data_cleaning/Output_data_analysis/Table_Disc_fg_", format(Sys.time(), "%d%m%Y"), ".xlsx")
)
```


# Scottish Dietary Goals (%)
## Overall 
```{r echo=FALSE, warning=FALSE}
# Set categories
df.intake24_participant$age_cat <- factor(df.intake24_participant$age_cat, levels = c("2-4y", "5-10y", "11-15y"))

# Table
table.sdgs <- tbl_svysummary(
  svy.df.intake24_participant,
  label = c(SDG_Energy ~ "Energy density",
            SDG_Fat ~ "Fat",
            SDG_SatFat ~ "Saturated fat",
            SDG_TransFat ~ "Trans fat",
            SDG_FreeSugar ~ "Free sugars",
            SDG_Carbs ~ "Carbohydrates",
            SDG_Fibre ~ "Fibre",
            SDG_Salt ~ "Salt",
            SDG_FV ~ "Vegetables and fruit",
            SDG_FV_NoJuiceSmoothie ~ "Vegetables and fruit - no juice / smoothie",
            SDG_RRPM ~ "Red and red processed meat",
            SDG_oilyfish ~ "Oily fish"),
  statistic = list(all_categorical() ~ "{p}% ({n_unweighted})"),
  missing = "ifany",
  digits = list(all_categorical() ~ c(1,0)),
  include = c(SDG_Energy, SDG_Fat, SDG_SatFat, SDG_TransFat, SDG_FreeSugar, SDG_Carbs, SDG_Fibre, SDG_Salt, SDG_FV, SDG_FV_NoJuiceSmoothie, SDG_RRPM, SDG_oilyfish)) %>%
  bold_labels() %>% 
  as_flex_table()

# Figure
## Read in the data frame
figure.df.sdgs <- data.frame(
                        SDG=as.factor(c("Energy density","Fat","Saturated fat",
                                          "Trans fat","Free sugars","Carbohydrates",
                                          "Fibre","Salt","V&F",
                                          "RRPM","Oily fish")),
                        Value=c(15,	62.2,	20.5,	98.8,	13.5,	60.6,	18.6,	60.3,	40.3,	64.8,	16.2)) 
## Plot 
figure.sdgs <- ggplot(figure.df.sdgs, aes(x=reorder(SDG,desc(Value)), y=Value)) +  
       geom_bar(position=position_dodge(), stat="identity", fill="#440154FF") +
       labs(x="",
            y="Overall Percentage Adhering to Goal") +
       theme_minimal() +
       theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=0.5))

figure.sdgs

#ggsave(figure.sdgs, filename = "C:/Users/ljaacks/OneDrive - University of Edinburgh/Scottish Diets/_National Monitoring of Diet Scotland/3_DISH/Analysis/Output/SDGs_overall.jpeg",width = 6.5, height = 5)
```

## by Age 
```{r echo=FALSE, warning=FALSE}
# Set categories
df.intake24_participant$age_cat <- factor(df.intake24_participant$age_cat, levels = c("2-4y", "5-10y", "11-15y"))

# Table
table.sdgs.age <- tbl_svysummary(
  svy.df.intake24_participant,
  by = age_cat,
  label = c(SDG_Energy ~ "Energy density",
            SDG_Fat ~ "Fat",
            SDG_SatFat ~ "Saturated fat",
            SDG_TransFat ~ "Trans fat",
            SDG_FreeSugar ~ "Free sugars",
            SDG_Carbs ~ "Carbohydrates",
            SDG_Fibre ~ "Fibre",
            SDG_Salt ~ "Salt",
            SDG_FV ~ "Vegetables and fruit",
            SDG_FV_NoJuiceSmoothie ~ "Vegetables and fruit - no juice / smoothie",
            SDG_RRPM ~ "Red and red processed meat",
            SDG_oilyfish ~ "Oily fish"),
  statistic = list(all_categorical() ~ "{p}% ({n_unweighted})"),
  missing = "ifany",
  digits = list(all_categorical() ~ c(1,0)),
  include = c(SDG_Energy, SDG_Fat, SDG_SatFat, SDG_TransFat, SDG_FreeSugar, SDG_Carbs, SDG_Fibre, SDG_Salt, SDG_FV, SDG_FV_NoJuiceSmoothie, SDG_RRPM, SDG_oilyfish)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

# Figure
## Read in the data frame
table.forfigure.sdgs.age <- tbl_svysummary(
  svy.df.intake24_participant,
  by = age_cat,
  statistic = list(all_categorical() ~ "{p}"),
  missing = "ifany",
  digits = list(all_categorical() ~ c(1,0)),
  include = c(SDG_Energy, SDG_Fat, SDG_SatFat, SDG_TransFat, SDG_FreeSugar, SDG_Carbs, SDG_Fibre, SDG_Salt, SDG_FV, SDG_RRPM, SDG_oilyfish)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()
#Lindsay updating means tables and inputting into github code - for figure

table.forfigure.sdgs.age

#save_as_docx("SDG by Age Table for Figure"=table.forfigure.sdgs.age,path = paste0("C:/Users/ljaacks/OneDrive - University of Edinburgh/Scottish Diets/_National Monitoring of Diet Scotland/3_DISH/Analysis/Output/","FigureTables_SDG_Age_",format(Sys.time(),"%d%m%Y"),".docx"))

fig.df.sdg.age <- data.frame(Age=as.factor(c("2-4y","2-4y","2-4y","2-4y","2-4y","2-4y","2-4y","2-4y","2-4y","2-4y","2-4y",
                                            "5-10y","5-10y","5-10y","5-10y","5-10y","5-10y","5-10y","5-10y","5-10y","5-10y","5-10y",
                                            "11-15y", "11-15y", "11-15y", "11-15y", "11-15y", "11-15y", "11-15y", "11-15y", "11-15y", "11-15y", "11-15y")),
                        SDG=as.factor(c("Energy density","Fat","Saturated fat","Trans fat","Free sugars","Carbohydrates","Fibre","Salt","V&F","RRPM","Oily fish",
                                        "Energy density","Fat","Saturated fat","Trans fat","Free sugars","Carbohydrates","Fibre","Salt","V&F","RRPM","Oily fish",
                                        "Energy density","Fat","Saturated fat","Trans fat","Free sugars","Carbohydrates","Fibre","Salt","V&F","RRPM","Oily fish")),
                        Value=c(26.9, 67.4,	17.8,	98.9,	19.2,	59.9,	33.3,	24.5,	63.5,	74.9,	16.8,
                               16.0, 61.2,	21.6,	98.7,	13.8,	59.9,	18.6,	59.8,	55.3,	65.0,	16.9,
                               7.5,	 60.7,	20.6,	98.8,	10.2,	61.8,	10.9,	79.8,	10.6,	59.1,	15.2)) 
## Plot 
fig.sdg.age <- ggplot(fig.df.sdg.age, aes(x=reorder(SDG,desc(Value)), y=Value, fill=factor(Age, levels = c("2-4y","5-10y","11-15y")))) +  
       geom_bar(position=position_dodge(width=0.6), stat="identity", width=0.6) +
       labs(x="",
            y="Overall Percentage Adhering to Goal",
            fill="Age Group") +
       theme_minimal() +
       theme(legend.position = "top", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=0.5)) +
       scale_fill_manual(values=c("#440154FF", "#1F968BFF","#FDE725FF")) 

fig.sdg.age

#ggsave(fig.sdg.age, filename = "C:/Users/ljaacks/OneDrive - University of Edinburgh/Scottish Diets/_National Monitoring of Diet Scotland/3_DISH/Analysis/Output/SDGs_byAge.jpeg",width = 7.5, height = 5)
```

## by Sex 
```{r echo=FALSE, warning=FALSE}
# Table
table.sdgs.sex <- tbl_svysummary(
  svy.df.intake24_participant,
  by = Sex,
  label = c(SDG_Energy ~ "Energy density",
            SDG_Fat ~ "Fat",
            SDG_SatFat ~ "Saturated fat",
            SDG_TransFat ~ "Trans fat",
            SDG_FreeSugar ~ "Free sugars",
            SDG_Carbs ~ "Carbohydrates",
            SDG_Fibre ~ "Fibre",
            SDG_Salt ~ "Salt",
            SDG_FV ~ "Vegetables and fruit",
            SDG_FV_NoJuiceSmoothie ~ "Vegetables and fruit - no juice / smoothie",
            SDG_RRPM ~ "Red and red processed meat",
            SDG_oilyfish ~ "Oily fish"),
  statistic = list(all_categorical() ~ "{p}% ({n_unweighted})"),
  missing = "ifany",
  digits = list(all_categorical() ~ c(1,0)),
  include = c(SDG_Energy, SDG_Fat, SDG_SatFat, SDG_TransFat, SDG_FreeSugar, SDG_Carbs, SDG_Fibre, SDG_Salt, SDG_FV, SDG_FV_NoJuiceSmoothie, SDG_RRPM, SDG_oilyfish)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

# Figure
## Read in the data frame
table.forfigure.sdgs.sex <- tbl_svysummary(
  svy.df.intake24_participant,
  by = Sex,
  statistic = list(all_categorical() ~ "{p}"),
  missing = "ifany",
  digits = list(all_categorical() ~ c(1,0)),
  include = c(SDG_Energy, SDG_Fat, SDG_SatFat, SDG_TransFat, SDG_FreeSugar, SDG_Carbs, SDG_Fibre, SDG_Salt, SDG_FV, SDG_RRPM, SDG_oilyfish)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.forfigure.sdgs.sex

#save_as_docx("SDG by Sex Table for Figure"=table.forfigure.sdgs.sex,path = paste0("C:/Users/ljaacks/OneDrive - University of Edinburgh/Scottish Diets/_National Monitoring of Diet Scotland/3_DISH/Analysis/Output/","FigureTables_SDG_Sex_",format(Sys.time(),"%d%m%Y"),".docx"))

fig.df.sdg.sex <- data.frame(Sex=as.factor(c("Female","Female","Female","Female","Female","Female","Female","Female","Female","Female","Female",
                                             "Male","Male","Male","Male","Male","Male","Male","Male","Male","Male","Male")),
                        SDG=as.factor(c("Energy density","Fat","Saturated fat","Trans fat","Free sugars","Carbohydrates","Fibre","Salt","V&F","RRPM","Oily fish",
                                        "Energy density","Fat","Saturated fat","Trans fat","Free sugars","Carbohydrates","Fibre","Salt","V&F","RRPM","Oily fish")),
                        Value=c(14.5,	61.1,	20.1,	98.4,	12.4,	60,	14.1,	65.5,	36.2,	67.3,	16.4,
                               15.3,	63.2,	20.8,	99.1,	14.6,	61,	22.9,	55.2,	44.5,	62.5,	15.9)) 
## Plot 
fig.sdg.sex <- ggplot(fig.df.sdg.sex, aes(x=reorder(SDG,desc(Value)), y=Value, fill=factor(Sex, levels = c("Female","Male")))) +  
       geom_bar(position=position_dodge(width=0.6), stat="identity", width=0.6) +
       labs(x="",
            y="Overall Percentage Adhering to Goal",
            fill="Sex") +
       theme_minimal() +
       theme(legend.position = "top", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=0.5)) +
       scale_fill_manual(values=c("#440154FF", "#1F968BFF")) 

fig.sdg.sex

#ggsave(fig.sdg.sex, filename = "C:/Users/ljaacks/OneDrive - University of Edinburgh/Scottish Diets/_National Monitoring of Diet Scotland/3_DISH/Analysis/Output/SDGs_bySex.jpeg",width = 7.5, height = 5)
```

## by SIMD 
```{r echo=FALSE, warning=FALSE}
# Table
table.sdgs.simd <- tbl_svysummary(
  svy.df.intake24_participant,
  by = simd_quintile,
  label = c(SDG_Energy ~ "Energy density",
            SDG_Fat ~ "Fat",
            SDG_SatFat ~ "Saturated fat",
            SDG_TransFat ~ "Trans fat",
            SDG_FreeSugar ~ "Free sugars",
            SDG_Carbs ~ "Carbohydrates",
            SDG_Fibre ~ "Fibre",
            SDG_Salt ~ "Salt",
            SDG_FV ~ "Vegetables and fruit",
            SDG_FV_NoJuiceSmoothie ~ "Vegetables and fruit - no juice / smoothie",
            SDG_RRPM ~ "Red and red processed meat",
            SDG_oilyfish ~ "Oily fish"),
  statistic = list(all_categorical() ~ "{p}% ({n_unweighted})"),
  missing = "ifany",
  digits = list(all_categorical() ~ c(1,0)),
  include = c(SDG_Energy, SDG_Fat, SDG_SatFat, SDG_TransFat, SDG_FreeSugar, SDG_Carbs, SDG_Fibre, SDG_Salt, SDG_FV, SDG_FV_NoJuiceSmoothie, SDG_RRPM, SDG_oilyfish)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

# Figure
## Read in the data frame
table.forfigure.sdgs.simd <- tbl_svysummary(
  svy.df.intake24_participant,
  by = simd_quintile,
  statistic = list(all_categorical() ~ "{p}"),
  missing = "ifany",
  digits = list(all_categorical() ~ c(1,0)),
  include = c(SDG_Energy, SDG_Fat, SDG_SatFat, SDG_TransFat, SDG_FreeSugar, SDG_Carbs, SDG_Fibre, SDG_Salt, SDG_FV, SDG_RRPM, SDG_oilyfish)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()


#save_as_docx("SDG by SIMD Table for Figure"=table.forfigure.sdgs.simd,path = paste0("C:/Users/ljaacks/OneDrive - University of Edinburgh/Scottish Diets/_National Monitoring of Diet Scotland/3_DISH/Analysis/Output/","FigureTables_SDG_SIMD_",format(Sys.time(),"%d%m%Y"),".docx"))

fig.df.sdg.simd <- data.frame(SIMD=as.factor(c("1st (Most Deprived)","1st (Most Deprived)","1st (Most Deprived)","1st (Most Deprived)","1st (Most Deprived)","1st (Most Deprived)","1st (Most Deprived)","1st (Most Deprived)","1st (Most Deprived)","1st (Most Deprived)","1st (Most Deprived)",
                                             "2nd","2nd","2nd","2nd","2nd","2nd","2nd","2nd","2nd","2nd","2nd",
                                             "3rd","3rd","3rd","3rd","3rd","3rd","3rd","3rd","3rd","3rd","3rd",
                                             "4th","4th","4th","4th","4th","4th","4th","4th","4th","4th","4th",
                                             "5th (Least Deprived)","5th (Least Deprived)","5th (Least Deprived)","5th (Least Deprived)","5th (Least Deprived)","5th (Least Deprived)","5th (Least Deprived)","5th (Least Deprived)","5th (Least Deprived)","5th (Least Deprived)","5th (Least Deprived)")),
                        SDG=as.factor(c("Energy density","Fat","Saturated fat","Trans fat","Free sugars","Carbohydrates","Fibre","Salt","V&F","RRPM","Oily fish",
                                        "Energy density","Fat","Saturated fat","Trans fat","Free sugars","Carbohydrates","Fibre","Salt","V&F","RRPM","Oily fish",
                                        "Energy density","Fat","Saturated fat","Trans fat","Free sugars","Carbohydrates","Fibre","Salt","V&F","RRPM","Oily fish",
                                        "Energy density","Fat","Saturated fat","Trans fat","Free sugars","Carbohydrates","Fibre","Salt","V&F","RRPM","Oily fish",
                                        "Energy density","Fat","Saturated fat","Trans fat","Free sugars","Carbohydrates","Fibre","Salt","V&F","RRPM","Oily fish")),
                        Value=c(12.6,	62.8,	24.7,	99.3,	15.2,	55.8,	13.5,	54.6,	30.2,	61.9,	13.1,
                               15.1,	64.0,	24.8,	98.4,	14.1,	58.3,	15.1,	62.9,	38.7,	63.8,	10.0,
                               15.2,	63.7,	19.7,	98.8,	10.5,	61.7,	18.3,	60.2,	41.2,	66.3,	18.6,
                               16.1,	56.0,	14.3,	98.0,	11.5,	60.3,	18.6,	63.2,	44.1,	64.4,	20.3,
                               16.1,	65.0,	18.7,	99.4,	15.9,	67.3,	27.6,	61.2,	47.9,	67.7,	19.4)) 
## Plot 
fig.sdg.simd <- ggplot(fig.df.sdg.simd, aes(x=reorder(SDG,desc(Value)), y=Value, fill=factor(SIMD, levels = c("1st (Most Deprived)","2nd","3rd","4th","5th (Least Deprived)")))) +  
       geom_bar(position=position_dodge(width=0.6), stat="identity", width=0.6) +
       labs(x="",
            y="Overall Percentage Adhering to Goal",
            fill="SIMD") +
       theme_minimal() +
       theme(legend.position = "top", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=0.5)) +
       scale_fill_viridis_d(option = "viridis", direction = -1)

fig.sdg.simd

#ggsave(fig.sdg.simd, filename = "C:/Users/ljaacks/OneDrive - University of Edinburgh/Scottish Diets/_National Monitoring of Diet Scotland/3_DISH/Analysis/Output/SDGs_bySIMD.jpeg",width = 7.5, height = 5)
```

## Output tables for appendix 
```{r echo=FALSE, warning=FALSE}
#save_as_docx("Overall"=table.sdgs, "by Age"=table.sdgs.age, "by Sex"=table.sdgs.sex, "by SIMD"=table.sdgs.simd,path = paste0("C:/Users/ljaacks/OneDrive - University of Edinburgh/Scottish Diets/_National Monitoring of Diet Scotland/3_DISH/Analysis/Output/","Table_SDGs_",format(Sys.time(),"%d%m%Y"),".docx"))
```

### Output Excel Sheet
```{r echo=FALSE, warning=FALSE}
# Convert flextables to data frames
df.table.sdgs <- table.sdgs$body$dataset %>%
  rename(SDG = label,
         Overall = stat_0)
df.table.sdgs.age <- table.sdgs.age$body$dataset %>%
  rename(SDG = label,
    Overall = stat_0,
         "2-4y" = stat_1,
         "5-10y" = stat_2,
         "11-15y" = stat_3)
df.table.sdgs.sex <- table.sdgs.sex$body$dataset %>%
  rename(SDG = label,
         Overall = stat_0,
         Female = stat_1,
         Male = stat_2)
df.table.sdgs.simd <- table.sdgs.simd$body$dataset %>%
  rename(SDG = label,
         Overall = stat_0,
         "1" = stat_1,
         "2" = stat_2,
         "3" = stat_3,
         "4" = stat_4,
         "5" = stat_5)


write_xlsx(
  list(
    "Overall" = df.table.sdgs,
    "by Age" = df.table.sdgs.age,
    "by Sex" = df.table.sdgs.sex,
    "by SIMD" = df.table.sdgs.simd
  ),
  path = paste0("/Users/ricki/Desktop/DISH_data_cleaning/Output_data_analysis/Table_SDGs_", format(Sys.time(), "%d%m%Y"), ".xlsx")
)

```

## Explore Vegetables and Fruit Goal
```{r include=FALSE, warning=FALSE}
# Mean portions
table.sdgs.vegfruit <- tbl_svysummary(
  svy.df.intake24_participant,
  by = age_cat,
  label = c(Avg_FV_Portions_Beans ~ "Beans (portions/day)",
            Avg_FV_Portions_JuiceSmoothie ~ "Fruit Juice / Smoothie (portions/day)",
            Avg_FV_Portions_DriedFruit ~ "Dried fruit (portions/day)",
            Avg_FV_Portions_FreshFruit ~ "Fresh fruit (portions/day)",
            Avg_FV_Portions_Veg ~ "Vegetables (portions/day)",
            Avg_FV_Portions_Total ~ "Total vegetables & fruit (portions/day)"),
  statistic = list(all_continuous() ~ "{median} ({p25}, {p75})
                                       {mean} ({mean.std.error})
                                       {min} - {max}"),
  missing = "ifany",
  digits = list(all_continuous() ~ c(1,0)),
  include = c(Avg_FV_Portions_Beans, Avg_FV_Portions_JuiceSmoothie, Avg_FV_Portions_DriedFruit, Avg_FV_Portions_FreshFruit, Avg_FV_Portions_Veg, Avg_FV_Portions_Total)) %>%
  add_overall() %>%
  bold_labels() %>% 
  as_flex_table()

table.sdgs.vegfruit
```




### Output Excel Sheet
```{r eval=FALSE, warning=FALSE, include=FALSE}
df.table.sdgs.vegfruit <- table.sdgs.vegfruit$body$dataset %>%
  rename(SDG = label,
    Overall = stat_0,
         "2-4y" = stat_1,
         "5-10y" = stat_2,
         "11-15y" = stat_3)

write_xlsx(
  list(
    "Overall" = df.table.sdgs,
    "by Age" = df.table.sdgs.age,
    "by Sex" = df.table.sdgs.sex,
    "by SIMD" = df.table.sdgs.simd,
    "Fruit and Veg" = df.table.sdgs.vegfruit
  ),
  path = paste0("/Users/ricki/Desktop/DISH_data_cleaning/Output_data_analysis/Table_SDGs_FV_", format(Sys.time(), "%d%m%Y"), ".xlsx")
)

```

Remove? No longer needed?
```{r include=FALSE, warning=FALSE}
# Most Commonly Reported Vegetables
Vegetables <- df.intake24_item %>%
  filter(MainFoodGroupCode %in% c(37, 36))

Veg_sub <- Vegetables %>%
  select(UserID, SearchTerm, Description_English, Description_Local, FoodGroupCode, FoodGroupEnglish, ReadyMeal, RecallNo, NumberOfRecalls, NumberOfItems, Sex, CalcAge, simd_quintile, age_cat, NewMealName, MainFoodGroupCode, MainFoodGroupDesc, ReportingFoodGroupCode, ReportingFoodGroupDesc)

Veg_sub$age_cat <- factor(Veg_sub$age_cat, levels = c("2-4y", "5-10y", "11-15y"))

Veg_sub %>%
  filter(ReportingFoodGroupCode == 5) %>%
  select(age_cat, Description_English) %>%
  tbl_summary(missing = "no",
              digits = list(all_categorical() ~ c(1,0)),
              type = list(all_continuous() ~ "continuous2"),
              statistic = list(all_continuous() ~ c("{mean} ({sd})",
                                                    "{min}, {max}")),
              by = age_cat,
              label = Description_English ~ ""
  ) %>%
  add_overall() %>%
  modify_header(label ~ "**Vegetables**") %>%
  bold_labels() %>%  
  as_flex_table() 

#save_as_docx("Mean portions"=table.sdgs.vegfruit,path = paste0("C:/Users/ljaacks/OneDrive - University of Edinburgh/Scottish Diets/_National Monitoring of Diet Scotland/3_DISH/Analysis/Output/","Table_F&V_",format(Sys.time(),"%d%m%Y"),".docx"))
```

# RNIs and LRNIs
## by Age 
```{r include=FALSE, warning=FALSE}

table.rnis.age <- tbl_svysummary(
  svy.df.intake24_participant,
  by = age_cat,
  label = c(Avg_VitaminAug ~ "Vitamin A (g/day)",
            RNI_VitaminA ~ "Vitamin A, % below RNI",
            LRNI_VitaminA ~ "Vitamin A, % below LRNI",
            RNI_prct_VitaminA ~ "Vitamin A, % RNI",
            Avg_Riboflavinmg ~ "Riboflavin (mg/day)",
            RNI_Riboflavin ~ "Riboflavin, % below RNI",
            LRNI_Riboflavin ~ "Riboflavin, % below LRNI",
            RNI_prct_Riboflavin ~ "Riboflavin, % RNI",
            Avg_Folateug ~ "Folate (g/day)",
            RNI_Folate ~ "Folate, % below RNI",
            LRNI_Folate ~ "Folate, % below LRNI",
            RNI_prct_Folate ~ "Folate, % RNI",
            Avg_VitaminDug ~ "Vitamin D (g/day)",
            RNI_VitaminD ~ "Vitamin D, % below RNI",
            RNI_prct_VitaminD ~ "Vitamin D, % RNI",
            Avg_Ironmg ~ "Iron (mg/day)",
            RNI_Iron ~ "Iron, % below RNI",
            LRNI_Iron ~ "Iron, % below LRNI",
            RNI_prct_Iron ~ "Iron, % RNI",
            Avg_Calciummg ~ "Calcium (mg/day)",
            RNI_Calcium ~ "Calcium, % below RNI",
            LRNI_Calcium ~ "Calcium, % below LRNI",
            RNI_prct_Calcium ~ "Calcium, % RNI",
            Avg_Magnesiummg ~ "Magnesium (mg/day)",
            RNI_Magnesium ~ "Magnesium, % below RNI",
            LRNI_Magnesium ~ "Magnesium, % below LRNI",
            RNI_prct_Magnesium ~ "Magnesium, % RNI",
            Avg_Potassiummg ~ "Potassium (mg/day)",
            RNI_Potassium ~ "Potassium, % below RNI",
            LRNI_Potassium ~ "Potassium, % below LRNI",
            RNI_prct_Potassium ~ "Potassium, % RNI",
            Avg_Iodineug ~ "Iodine (g/day)",
            RNI_Iodine ~ "Iodine, % below RNI",
            LRNI_Iodine ~ "Iodine, % below LRNI",
            RNI_prct_Iodine ~ "Iodine, % RNI",
            Avg_Seleniumug ~ "Selenium (g/day)",
            RNI_Selenium ~ "Selenium, % below RNI",
            LRNI_Selenium ~ "Selenium, % below LRNI",
            RNI_prct_Selenium ~ "Selenium, % RNI",
            Avg_Zincmg ~ "Zinc (mg/day)",
            RNI_Zinc ~ "Zinc, % below RNI",
            LRNI_Zinc ~ "Zinc, % below LRNI",
            RNI_prct_Zinc ~ "Zinc, % RNI"),
  statistic = list(all_continuous() ~ "{median} ({p25}, {p75}),
                                       {mean} ({mean.std.error})
                                       {min} - {max}", 
                   all_categorical() ~ "{p}% ({n_unweighted})"),
  missing = "ifany",
  digits = list(all_continuous() ~ c(1,0),
                all_categorical() ~ c(1,0)),
  include = c(Avg_VitaminAug, RNI_VitaminA, LRNI_VitaminA, RNI_prct_VitaminA, Avg_Riboflavinmg, RNI_Riboflavin, LRNI_Riboflavin, RNI_prct_Riboflavin,
              Avg_Folateug, RNI_Folate, LRNI_Folate, RNI_prct_Folate, Avg_VitaminDug, RNI_VitaminD, RNI_prct_VitaminD,
              Avg_Ironmg, RNI_Iron, LRNI_Iron, RNI_prct_Iron, Avg_Calciummg, RNI_Calcium, LRNI_Calcium, RNI_prct_Calcium,
              Avg_Magnesiummg, RNI_Magnesium, LRNI_Magnesium, RNI_prct_Magnesium, Avg_Potassiummg, RNI_Potassium, LRNI_Potassium, RNI_prct_Potassium,
              Avg_Iodineug, RNI_Iodine, LRNI_Iodine, RNI_prct_Iodine, Avg_Seleniumug, RNI_Selenium, LRNI_Selenium, RNI_prct_Selenium,
              Avg_Zincmg, RNI_Zinc, LRNI_Zinc, RNI_prct_Zinc)) %>%
  bold_labels() %>% 
  as_flex_table()

table.rnis.age
```

## by Sex
```{r echo=FALSE, warning=FALSE}
table.rnis.sex <- tbl_svysummary(
  svy.df.intake24_participant,
  by = Sex,
  label = c(Avg_VitaminAug ~ "Vitamin A (g/day)",
            RNI_VitaminA ~ "Vitamin A, % below RNI",
            LRNI_VitaminA ~ "Vitamin A, % below LRNI",
            RNI_prct_VitaminA ~ "Vitamin A, % RNI",
            Avg_Riboflavinmg ~ "Riboflavin (mg/day)",
            RNI_Riboflavin ~ "Riboflavin, % below RNI",
            LRNI_Riboflavin ~ "Riboflavin, % below LRNI",
            RNI_prct_Riboflavin ~ "Riboflavin, % RNI",
            Avg_Folateug ~ "Folate (g/day)",
            RNI_Folate ~ "Folate, % below RNI",
            LRNI_Folate ~ "Folate, % below LRNI",
            RNI_prct_Folate ~ "Folate, % RNI",
            Avg_VitaminDug ~ "Vitamin D (g/day)",
            RNI_VitaminD ~ "Vitamin D, % below RNI",
            RNI_prct_VitaminD ~ "Vitamin D, % RNI",
            Avg_Ironmg ~ "Iron (mg/day)",
            RNI_Iron ~ "Iron, % below RNI",
            LRNI_Iron ~ "Iron, % below LRNI",
            RNI_prct_Iron ~ "Iron, % RNI",
            Avg_Calciummg ~ "Calcium (mg/day)",
            RNI_Calcium ~ "Calcium, % below RNI",
            LRNI_Calcium ~ "Calcium, % below LRNI",
            RNI_prct_Calcium ~ "Calcium, % RNI",
            Avg_Magnesiummg ~ "Magnesium (mg/day)",
            RNI_Magnesium ~ "Magnesium, % below RNI",
            LRNI_Magnesium ~ "Magnesium, % below LRNI",
            RNI_prct_Magnesium ~ "Magnesium, % RNI",
            Avg_Potassiummg ~ "Potassium (mg/day)",
            RNI_Potassium ~ "Potassium, % below RNI",
            LRNI_Potassium ~ "Potassium, % below LRNI",
            RNI_prct_Potassium ~ "Potassium, % RNI",
            Avg_Iodineug ~ "Iodine (g/day)",
            RNI_Iodine ~ "Iodine, % below RNI",
            LRNI_Iodine ~ "Iodine, % below LRNI",
            RNI_prct_Iodine ~ "Iodine, % RNI",
            Avg_Seleniumug ~ "Selenium (g/day)",
            RNI_Selenium ~ "Selenium, % below RNI",
            LRNI_Selenium ~ "Selenium, % below LRNI",
            RNI_prct_Selenium ~ "Selenium, % RNI",
            Avg_Zincmg ~ "Zinc (mg/day)",
            RNI_Zinc ~ "Zinc, % below RNI",
            LRNI_Zinc ~ "Zinc, % below LRNI",
            RNI_prct_Zinc ~ "Zinc, % RNI"),
  statistic = list(all_continuous() ~ "{median} ({p25}, {p75}),
                                       {mean} ({mean.std.error})
                                       {min} - {max}", 
                   all_categorical() ~ "{p}% ({n_unweighted})"),
  missing = "ifany",
  digits = list(all_continuous() ~ c(1,0),
                all_categorical() ~ c(1,0)),
  include = c(Avg_VitaminAug, RNI_VitaminA, LRNI_VitaminA, RNI_prct_VitaminA, Avg_Riboflavinmg, RNI_Riboflavin, LRNI_Riboflavin, RNI_prct_Riboflavin,
              Avg_Folateug, RNI_Folate, LRNI_Folate, RNI_prct_Folate, Avg_VitaminDug, RNI_VitaminD, RNI_prct_VitaminD,
              Avg_Ironmg, RNI_Iron, LRNI_Iron, RNI_prct_Iron, Avg_Calciummg, RNI_Calcium, LRNI_Calcium, RNI_prct_Calcium,
              Avg_Magnesiummg, RNI_Magnesium, LRNI_Magnesium, RNI_prct_Magnesium, Avg_Potassiummg, RNI_Potassium, LRNI_Potassium, RNI_prct_Potassium,
              Avg_Iodineug, RNI_Iodine, LRNI_Iodine, RNI_prct_Iodine, Avg_Seleniumug, RNI_Selenium, LRNI_Selenium, RNI_prct_Selenium,
              Avg_Zincmg, RNI_Zinc, LRNI_Zinc, RNI_prct_Zinc)) %>%
  bold_labels() %>% 
  as_flex_table()

table.rnis.sex
```

## by Age and Sex
```{r echo=FALSE, warning=FALSE}

table.rnis.agesex <- tbl_svysummary(
  svy.df.intake24_participant,
  by = age_sex_cat,
  label = c(Avg_VitaminAug ~ "Vitamin A (g/day)",
            RNI_VitaminA ~ "Vitamin A, % below RNI",
            LRNI_VitaminA ~ "Vitamin A, % below LRNI",
            RNI_prct_VitaminA ~ "Vitamin A, % RNI",
            Avg_Riboflavinmg ~ "Riboflavin (mg/day)",
            RNI_Riboflavin ~ "Riboflavin, % below RNI",
            LRNI_Riboflavin ~ "Riboflavin, % below LRNI",
            RNI_prct_Riboflavin ~ "Riboflavin, % RNI",
            Avg_Folateug ~ "Folate (g/day)",
            RNI_Folate ~ "Folate, % below RNI",
            LRNI_Folate ~ "Folate, % below LRNI",
            RNI_prct_Folate ~ "Folate, % RNI",
            Avg_VitaminDug ~ "Vitamin D (g/day)",
            RNI_VitaminD ~ "Vitamin D, % below RNI",
            RNI_prct_VitaminD ~ "Vitamin D, % RNI",
            Avg_Ironmg ~ "Iron (mg/day)",
            RNI_Iron ~ "Iron, % below RNI",
            LRNI_Iron ~ "Iron, % below LRNI",
            RNI_prct_Iron ~ "Iron, % RNI",
            Avg_Calciummg ~ "Calcium (mg/day)",
            RNI_Calcium ~ "Calcium, % below RNI",
            LRNI_Calcium ~ "Calcium, % below LRNI",
            RNI_prct_Calcium ~ "Calcium, % RNI",
            Avg_Magnesiummg ~ "Magnesium (mg/day)",
            RNI_Magnesium ~ "Magnesium, % below RNI",
            LRNI_Magnesium ~ "Magnesium, % below LRNI",
            RNI_prct_Magnesium ~ "Magnesium, % RNI",
            Avg_Potassiummg ~ "Potassium (mg/day)",
            RNI_Potassium ~ "Potassium, % below RNI",
            LRNI_Potassium ~ "Potassium, % below LRNI",
            RNI_prct_Potassium ~ "Potassium, % RNI",
            Avg_Iodineug ~ "Iodine (g/day)",
            RNI_Iodine ~ "Iodine, % below RNI",
            LRNI_Iodine ~ "Iodine, % below LRNI",
            RNI_prct_Iodine ~ "Iodine, % RNI",
            Avg_Seleniumug ~ "Selenium (g/day)",
            RNI_Selenium ~ "Selenium, % below RNI",
            LRNI_Selenium ~ "Selenium, % below LRNI",
            RNI_prct_Selenium ~ "Selenium, % RNI",
            Avg_Zincmg ~ "Zinc (mg/day)",
            RNI_Zinc ~ "Zinc, % below RNI",
            LRNI_Zinc ~ "Zinc, % below LRNI",
            RNI_prct_Zinc ~ "Zinc, % RNI"),
  statistic = list(all_continuous() ~ "{median} ({p25}, {p75}),
                                       {mean} ({mean.std.error})
                                       {min} - {max}", 
                   all_categorical() ~ "{p}% ({n_unweighted})"),
  missing = "ifany",
  digits = list(all_continuous() ~ c(1,0),
                all_categorical() ~ c(1,0)),
  include = c(Avg_VitaminAug, RNI_VitaminA, LRNI_VitaminA, RNI_prct_VitaminA, Avg_Riboflavinmg, RNI_Riboflavin, LRNI_Riboflavin, RNI_prct_Riboflavin,
              Avg_Folateug, RNI_Folate, LRNI_Folate, RNI_prct_Folate, Avg_VitaminDug, RNI_VitaminD, RNI_prct_VitaminD,
              Avg_Ironmg, RNI_Iron, LRNI_Iron, RNI_prct_Iron, Avg_Calciummg, RNI_Calcium, LRNI_Calcium, RNI_prct_Calcium,
              Avg_Magnesiummg, RNI_Magnesium, LRNI_Magnesium, RNI_prct_Magnesium, Avg_Potassiummg, RNI_Potassium, LRNI_Potassium, RNI_prct_Potassium,
              Avg_Iodineug, RNI_Iodine, LRNI_Iodine, RNI_prct_Iodine, Avg_Seleniumug, RNI_Selenium, LRNI_Selenium, RNI_prct_Selenium,
              Avg_Zincmg, RNI_Zinc, LRNI_Zinc, RNI_prct_Zinc)) %>%
  bold_labels() %>% 
  as_flex_table()

table.rnis.agesex 
```

## by SIMD
```{r echo=FALSE, warning=FALSE}

table.rnis.simd <- tbl_svysummary(
  svy.df.intake24_participant,
  by = simd_quintile,
  label = c(Avg_VitaminAug ~ "Vitamin A (g/day)",
            RNI_VitaminA ~ "Vitamin A, % below RNI",
            LRNI_VitaminA ~ "Vitamin A, % below LRNI",
            RNI_prct_VitaminA ~ "Vitamin A, % RNI",
            Avg_Riboflavinmg ~ "Riboflavin (mg/day)",
            RNI_Riboflavin ~ "Riboflavin, % below RNI",
            LRNI_Riboflavin ~ "Riboflavin, % below LRNI",
            RNI_prct_Riboflavin ~ "Riboflavin, % RNI",
            Avg_Folateug ~ "Folate (g/day)",
            RNI_Folate ~ "Folate, % below RNI",
            LRNI_Folate ~ "Folate, % below LRNI",
            RNI_prct_Folate ~ "Folate, % RNI",
            Avg_VitaminDug ~ "Vitamin D (g/day)",
            RNI_VitaminD ~ "Vitamin D, % below RNI",
            RNI_prct_VitaminD ~ "Vitamin D, % RNI",
            Avg_Ironmg ~ "Iron (mg/day)",
            RNI_Iron ~ "Iron, % below RNI",
            LRNI_Iron ~ "Iron, % below LRNI",
            RNI_prct_Iron ~ "Iron, % RNI",
            Avg_Calciummg ~ "Calcium (mg/day)",
            RNI_Calcium ~ "Calcium, % below RNI",
            LRNI_Calcium ~ "Calcium, % below LRNI",
            RNI_prct_Calcium ~ "Calcium, % RNI",
            Avg_Magnesiummg ~ "Magnesium (mg/day)",
            RNI_Magnesium ~ "Magnesium, % below RNI",
            LRNI_Magnesium ~ "Magnesium, % below LRNI",
            RNI_prct_Magnesium ~ "Magnesium, % RNI",
            Avg_Potassiummg ~ "Potassium (mg/day)",
            RNI_Potassium ~ "Potassium, % below RNI",
            LRNI_Potassium ~ "Potassium, % below LRNI",
            RNI_prct_Potassium ~ "Potassium, % RNI",
            Avg_Iodineug ~ "Iodine (g/day)",
            RNI_Iodine ~ "Iodine, % below RNI",
            LRNI_Iodine ~ "Iodine, % below LRNI",
            RNI_prct_Iodine ~ "Iodine, % RNI",
            Avg_Seleniumug ~ "Selenium (g/day)",
            RNI_Selenium ~ "Selenium, % below RNI",
            LRNI_Selenium ~ "Selenium, % below LRNI",
            RNI_prct_Selenium ~ "Selenium, % RNI",
            Avg_Zincmg ~ "Zinc (mg/day)",
            RNI_Zinc ~ "Zinc, % below RNI",
            LRNI_Zinc ~ "Zinc, % below LRNI",
            RNI_prct_Zinc ~ "Zinc, % RNI"),
  statistic = list(all_continuous() ~ "{median} ({p25}, {p75}),
                                       {mean} ({mean.std.error})
                                       {min} - {max}", 
                   all_categorical() ~ "{p}% ({n_unweighted})"),
  missing = "ifany",
  digits = list(all_continuous() ~ c(1,0),
                all_categorical() ~ c(1,0)),
  include = c(Avg_VitaminAug, RNI_VitaminA, LRNI_VitaminA, RNI_prct_VitaminA, Avg_Riboflavinmg, RNI_Riboflavin, LRNI_Riboflavin, RNI_prct_Riboflavin,
              Avg_Folateug, RNI_Folate, LRNI_Folate, RNI_prct_Folate, Avg_VitaminDug, RNI_VitaminD, RNI_prct_VitaminD,
              Avg_Ironmg, RNI_Iron, LRNI_Iron, RNI_prct_Iron, Avg_Calciummg, RNI_Calcium, LRNI_Calcium, RNI_prct_Calcium,
              Avg_Magnesiummg, RNI_Magnesium, LRNI_Magnesium, RNI_prct_Magnesium, Avg_Potassiummg, RNI_Potassium, LRNI_Potassium, RNI_prct_Potassium,
              Avg_Iodineug, RNI_Iodine, LRNI_Iodine, RNI_prct_Iodine, Avg_Seleniumug, RNI_Selenium, LRNI_Selenium, RNI_prct_Selenium,
              Avg_Zincmg, RNI_Zinc, LRNI_Zinc, RNI_prct_Zinc)) %>%
  bold_labels() %>% 
  as_flex_table()


table.rnis.simd
```

## Output tables for appendix 
```{r echo=FALSE, warning=FALSE}

save_as_docx("by Age"=table.rnis.age, "by Sex"=table.rnis.sex, "by Age and Sex"=table.rnis.agesex, "by SIMD"=table.rnis.simd,
             path = paste0("C:/Users/ljaacks/OneDrive - University of Edinburgh/Scottish Diets/_National Monitoring of Diet Scotland/3_DISH/Analysis/Output/","Table_RNIs&LRNIs_",format(Sys.time(),"%d%m%Y"),".docx"))
```


### Output Excel Sheet
```{r echo=FALSE, warning=FALSE}
# Convert flextables to data frames
df.table.rnis.age <- table.rnis.age$body$dataset %>%
  rename(RNI_LRNI = label,
         "2-4y" = stat_1,
         "5-10y" = stat_2,
         "11-15y" = stat_3)

df.table.rnis.sex <- table.rnis.sex$body$dataset %>%
  rename(RNI_LRNI = label,
    Female = stat_1,
         Male = stat_2)

df.table.rnis.agesex <- table.rnis.agesex$body$dataset %>%
  rename(RNI_LRNI = label,
         "Female, 2-4y" = stat_1,
         "Female, 5-10y" = stat_2,
         "Female, 11-15y" = stat_3,
         "Male, 2-4y" = stat_4,
         "Male, 5-10y" = stat_5,
         "Male, 11-15y" = stat_6)

df.table.rnis.simd <- table.rnis.simd$body$dataset %>%
  rename(RNI_LRNI = label,
         "1" = stat_1,
         "2" = stat_2,
         "3" = stat_3,
         "4" = stat_4,
         "5" = stat_5)


write_xlsx(
  list(
    "by Age" = df.table.rnis.age,
    "by Sex" = df.table.rnis.sex,
    "by Age_Sex" = df.table.rnis.agesex,
    "by SIMD" = df.table.rnis.simd),
  path = paste0("/Users/ricki/Desktop/DISH_data_cleaning/Output_data_analysis/Table_RNI_LRNI_", format(Sys.time(), "%d%m%Y"), ".xlsx")
)


```


# Advisory group slides
```{r echo=FALSE, warning=FALSE}
table.rnis.slide1 <- tbl_svysummary(
  svy.df.intake24_participant,
  by = age_sex_cat,
  label = c(Avg_VitaminAug ~ "Vitamin A (g/day)",
            Avg_Riboflavinmg ~ "Riboflavin (mg/day)",
            Avg_Folateug ~ "Folate (g/day)",
            Avg_VitaminB12ug ~ "Vitamin B12 (g/day)",
            Avg_VitaminCmg ~ "Vitamin C (mg/day)",
            Avg_Ironmg ~ "Iron (mg/day)",
            Avg_Calciummg ~ "Calcium (mg/day)",
            Avg_Magnesiummg ~ "Magnesium (mg/day)",
            Avg_Potassiummg ~ "Potassium (mg/day)",
            Avg_Iodineug ~ "Iodine (g/day)",
            Avg_Seleniumug ~ "Selenium (g/day)",
            Avg_Zincmg ~ "Zinc (mg/day)"),
  statistic = list(all_continuous() ~ "{mean}"),
  missing = "ifany",
  include = c(Avg_VitaminAug, Avg_Riboflavinmg, Avg_Folateug, Avg_VitaminB12ug, Avg_VitaminCmg, Avg_Ironmg, Avg_Calciummg, 
              Avg_Magnesiummg, Avg_Potassiummg, Avg_Iodineug, Avg_Seleniumug, Avg_Zincmg)) %>%
  bold_labels() %>% 
  as_flex_table()

table.rnis.slide2 <- tbl_svysummary(
  svy.df.intake24_participant,
  by = age_sex_cat,
  label = c(RNI_prct_VitaminA ~ "Vitamin A, % RNI",
            RNI_prct_Riboflavin ~ "Riboflavin, % RNI",
            RNI_prct_Folate ~ "Folate, % RNI",
            RNI_prct_VitaminB12 ~ "Vitamin B12, % RNI",
            RNI_prct_VitaminC ~ "Vitamin C, % RNI",
            RNI_prct_Iron ~ "Iron, % RNI",
            RNI_prct_Calcium ~ "Calcium, % RNI",
            RNI_prct_Magnesium ~ "Magnesium, % RNI",
            RNI_prct_Potassium ~ "Potassium, % RNI",
            RNI_prct_Iodine ~ "Iodine, % RNI",
            RNI_prct_Selenium ~ "Selenium, % RNI",
            RNI_prct_Zinc ~ "Zinc, % RNI"),
  statistic = list(all_continuous() ~ "{mean}"),
  missing = "ifany",
  include = c(RNI_prct_VitaminA, RNI_prct_Riboflavin, RNI_prct_Folate, RNI_prct_VitaminB12, RNI_prct_VitaminC, RNI_prct_Iron, RNI_prct_Calcium,
              RNI_prct_Magnesium, RNI_prct_Potassium, RNI_prct_Iodine, RNI_prct_Selenium, RNI_prct_Zinc)) %>%
  bold_labels() %>% 
  as_flex_table()

table.rnis.slide3 <- tbl_svysummary(
  svy.df.intake24_participant,
  by = age_sex_cat,
  label = c(RNI_Protein ~ "Protein, % below RNI",
            LRNI_VitaminA ~ "Vitamin A, % below LRNI",
            LRNI_Riboflavin ~ "Riboflavin, % below LRNI",
            LRNI_Folate ~ "Folate, % below LRNI",
            LRNI_VitaminB12 ~ "Vitamin B12, % below LRNI",
            LRNI_VitaminC ~ "Vitamin C, % below LRNI",
            LRNI_Iron ~ "Iron, % below LRNI",
            LRNI_Calcium ~ "Calcium, % below LRNI",
            LRNI_Magnesium ~ "Magnesium, % below LRNI",
            LRNI_Potassium ~ "Potassium, % below LRNI",
            LRNI_Iodine ~ "Iodine, % below LRNI",
            LRNI_Selenium ~ "Selenium, % below LRNI",
            LRNI_Zinc ~ "Zinc, % below LRNI"),
  statistic = list(all_categorical() ~ "{p}"),
  missing = "ifany",
  digits = list(all_continuous() ~ c(1,0),
                all_categorical() ~ c(1,0)),
  include = c(RNI_Protein, LRNI_VitaminA, LRNI_Riboflavin, LRNI_Folate, LRNI_VitaminB12, LRNI_VitaminC, LRNI_Iron, LRNI_Calcium, LRNI_Magnesium, LRNI_Potassium, LRNI_Iodine, LRNI_Selenium, LRNI_Zinc)) %>%
  bold_labels() %>% 
  as_flex_table()

table.rnis.slide4 <- tbl_svysummary(
  svy.df.intake24_participant,
  by = age_sex_cat,
  label = c(Avg_FoodEnergy ~ "Total energy excluding alcohol",
            Avg_Proteing ~ "Protein (g)",
            RNI_prct_Protein ~ "Protein, % RNI"),
  statistic = list(all_continuous() ~ "{mean}"),
  missing = "ifany",
  include = c(Avg_FoodEnergy, Avg_Proteing, RNI_prct_Protein)) %>%
  bold_labels() %>% 
  as_flex_table()

table.rnis.slide5 <- tbl_svysummary(
  svy.df.intake24_participant,
  by = age_sex_cat_drv,
  label = c(Avg_FoodEnergy ~ "Total energy excluding alcohol"),
  statistic = list(all_continuous() ~ "{mean}"),
  missing = "ifany",
  include = c(Avg_FoodEnergy)) %>%
  bold_labels() %>% 
  as_flex_table()

#save_as_docx("Mean"=table.rnis.slide1,"Mean % RNI"=table.rnis.slide2,"% LRNI"=table.rnis.slide3, "Energy protein report age group"=table.rnis.slide4, "Energy protein DRV age group"=table.rnis.slide5, path = paste0("C:/Users/ljaacks/OneDrive - University of Edinburgh/Scottish Diets/_National Monitoring of Diet Scotland/3_DISH/Analysis/Output/","Table_RNIs&LRNIs_Slides_",format(Sys.time(),"%d%m%Y"),".docx"))
```


```{r echo=FALSE, warning=FALSE}
table.rnis.slide1

table.rnis.slide2

table.rnis.slide3

table.rnis.slide4

table.rnis.slide5
```
